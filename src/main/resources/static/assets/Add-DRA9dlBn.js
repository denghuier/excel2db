import{d as Se,a as Qt,r as se,b as At,e as Gt,c as te,w as yt,f as ut,i as Le,j as Fe,k as Ut,g as Yt,l as ae,m as Ee,F as le,h as de,v as pe,t as xe,p as Ne,n as we,_ as De,q as Ot,o as Re,s as Ge}from"./index-DUUratVh.js";import{s as ke}from"./request-B8tej4z5.js";import{g as Ue,a as He,b as Ve}from"./datasource-Dd-vCrLU.js";import Be from"./Submit-BHDsDQNR.js";import{c as Ye}from"./task-DEoRwVrV.js";function Xe(Rt){return ke({url:"/excel/getTotalRowNum",method:"post",params:Rt})}function We(Rt){return ke({url:"/excel/getHeaderMap",method:"post",params:Rt})}function ze(){return ke({url:"/excel/transform/type",method:"get"})}const qe={class:"none"},$e={style:{position:"fixed",right:"40px",bottom:"30px","z-index":"2"}},Ke=Se({__name:"Excel",emits:["sendData"],setup(Rt,{emit:q}){const u=Qt({file:"",fileName:"",colList:[],sheetName:"",readAfterAction:"保留",storePath:"",headerNum:"",totalRowNum:"",removeEndNum:0,startRowNum:""}),V=se([]),J=(E,D)=>{V.value=E.data.sheetNames,u.fileName=E.data.originalFilename,u.storePath=E.data.storePath},$=()=>{const E={pathName:u.storePath,sheetName:u.sheetName};Xe(E).then(D=>{u.totalRowNum=D.data+1})},Q=se([]);ze().then(E=>{Q.value=E.data});const h=()=>{const E={pathName:u.storePath,sheetName:u.sheetName,headRowNumber:u.headerNum};We(E).then(D=>{u.colList=D.data})},M=(E,D,C,d)=>{D.property=="colName"&&(C.children[0].children[0].classList.remove("none"),C.children[0].children[1].classList.add("none"))},o=()=>{u.colList.push({colNum:u.colList.length,colName:"",transformType:Q.value[0].name,iseditor:!0})},n=q,m=()=>{n("sendData",u)};return(E,D)=>{const C=At("el-col"),d=At("el-icon"),e=At("el-upload"),T=At("el-form-item"),I=At("el-option"),R=At("el-select"),L=At("el-input-number"),_=At("el-row"),S=At("el-input"),s=At("el-radio"),f=At("el-radio-group"),a=At("el-table-column"),P=At("el-button"),k=At("el-table"),c=At("el-form"),j=At("el-container");return Gt(),te(j,{direction:"vertical",class:"container"},{default:yt(()=>[ut(_,null,{default:yt(()=>[ut(C,{span:2}),ut(C,{span:20},{default:yt(()=>[ut(c,{model:u,"label-width":"120px"},{default:yt(()=>[ut(T,{label:"上传文件",prop:"file"},{default:yt(()=>[ut(e,{class:"el-upload",drag:"",action:"/dev-api/excel/upExcel","on-success":J,multiple:""},{default:yt(()=>[ut(d,{class:"el-icon--upload"},{default:yt(()=>[ut(Le(Fe))]),_:1}),D[9]||(D[9]=Ut("div",{class:"el-upload__text"},[Yt(" 拖拽 或者 "),Ut("em",null,"点击上传")],-1))]),_:1})]),_:1}),ut(_,null,{default:yt(()=>[ut(C,{span:8},{default:yt(()=>[ut(T,{label:"工作表",prop:"sheetName"},{default:yt(()=>[ut(R,{modelValue:u.sheetName,"onUpdate:modelValue":D[0]||(D[0]=v=>u.sheetName=v),placeholder:"请选择",onChange:D[1]||(D[1]=v=>$())},{default:yt(()=>[(Gt(!0),ae(le,null,Ee(V.value,v=>(Gt(),te(I,{key:v,label:v,value:v},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),ut(C,{span:6},{default:yt(()=>[ut(T,{label:"总行数",prop:"totalRowNum"},{default:yt(()=>[ut(L,{modelValue:u.totalRowNum,"onUpdate:modelValue":D[2]||(D[2]=v=>u.totalRowNum=v)},null,8,["modelValue"])]),_:1})]),_:1}),ut(C,{span:6},{default:yt(()=>[ut(T,{label:"列序号",prop:"headerNum"},{default:yt(()=>[ut(L,{modelValue:u.headerNum,"onUpdate:modelValue":D[3]||(D[3]=v=>u.headerNum=v),onChange:h},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),ut(_,null,{default:yt(()=>[ut(C,{span:8},{default:yt(()=>[ut(T,{label:"起始行",prop:"startRowNum"},{default:yt(()=>[ut(L,{modelValue:u.startRowNum,"onUpdate:modelValue":D[4]||(D[4]=v=>u.startRowNum=v)},null,8,["modelValue"])]),_:1})]),_:1}),ut(C,{span:12},{default:yt(()=>[ut(T,{label:"结束行",prop:"removeEndNum"},{default:yt(()=>[ut(C,{span:6},{default:yt(()=>[ut(S,{modelValue:u.totalRowNum,"onUpdate:modelValue":D[5]||(D[5]=v=>u.totalRowNum=v),disabled:""},null,8,["modelValue"])]),_:1}),D[10]||(D[10]=Yt(" - ")),ut(C,{span:6},{default:yt(()=>[ut(S,{modelValue:u.removeEndNum,"onUpdate:modelValue":D[6]||(D[6]=v=>u.removeEndNum=v)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),ut(T,{label:"读取后操作",prop:"readAfterAction"},{default:yt(()=>[ut(f,{modelValue:u.readAfterAction,"onUpdate:modelValue":D[7]||(D[7]=v=>u.readAfterAction=v)},{default:yt(()=>[ut(s,{label:"保留"},{default:yt(()=>D[11]||(D[11]=[Yt("保留")])),_:1}),ut(s,{label:"删除文件"},{default:yt(()=>D[12]||(D[12]=[Yt("删除文件")])),_:1})]),_:1},8,["modelValue"])]),_:1}),ut(T,{label:"字段",prop:"readAfterAction"},{default:yt(()=>[ut(k,{data:u.colList,style:{width:"100%"},onCellClick:M},{default:yt(()=>[ut(a,{type:"selection",width:"55"}),ut(a,{prop:"colNum",label:"字段序号"}),ut(a,{prop:"colName",label:"中文说明"},{default:yt(v=>[Ut("div",qe,[ut(S,{type:"text",modelValue:v.row.colName,"onUpdate:modelValue":w=>v.row.colName=w},null,8,["modelValue","onUpdate:modelValue"])]),de(Ut("span",null,xe(v.row.colName),513),[[pe,!v.row.iseditor]])]),_:1}),ut(a,{prop:"transformType",label:"绑定数据转换规则"},{default:yt(v=>[ut(R,{modelValue:v.row.transformType,"onUpdate:modelValue":w=>v.row.transformType=w},{default:yt(()=>[(Gt(!0),ae(le,null,Ee(Q.value,w=>(Gt(),te(I,{key:w,label:w.name,value:w.code},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),ut(a,{prop:"configValue",label:"缺省值"},{default:yt(v=>[ut(S,{modelValue:v.row.configValue,"onUpdate:modelValue":w=>v.row.configValue=w},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),ut(a,{width:"60px",label:""},{default:yt(v=>[v.$index==u.colList.length-1?(Gt(),te(P,{key:0,type:"success",icon:Le(Ne),circle:"",onClick:o},null,8,["icon"])):we("",!0)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"])]),_:1}),ut(C,{span:2}),Ut("div",$e,[ut(P,{type:"primary",onClick:D[8]||(D[8]=v=>m())},{default:yt(()=>D[13]||(D[13]=[Yt("下一步")])),_:1})])]),_:1})]),_:1})}}}),Ze=De(Ke,[["__scopeId","data-v-d44b3f83"]]),Je={style:{position:"fixed",right:"40px",bottom:"30px","z-index":"2"}},Qe=Se({__name:"DataSource",emits:["sendData"],setup(Rt,{emit:q}){const u=Qt({name:"",dsId:"",dsName:"",dataSourceList:[],tableName:"",type:[],colList:[]}),V=se([]),J=se([]);Ue().then(o=>{V.value=o.data});const $=()=>{u.colList="",J.value=se([]),u.tableName="",He(u.dsId).then(o=>{J.value=o.data})},Q=()=>{const o={dsId:u.dsId,tableName:u.tableName};Ve(o).then(n=>{u.colList=n.data})},h=q,M=()=>{h("sendData",u)};return(o,n)=>{const m=At("el-col"),E=At("el-row"),D=At("el-option"),C=At("el-select"),d=At("el-form-item"),e=At("el-table-column"),T=At("el-table"),I=At("el-form"),R=At("el-button");return Gt(),ae(le,null,[ut(E,null,{default:yt(()=>[ut(m,{span:2})]),_:1}),ut(E,null,{default:yt(()=>[ut(m,{span:2}),ut(m,{span:20},{default:yt(()=>[ut(I,{model:u,"label-width":"120px"},{default:yt(()=>[ut(E,null,{default:yt(()=>[ut(m,{span:12},{default:yt(()=>[ut(d,{label:"数据源",prop:"dsId"},{default:yt(()=>[ut(C,{modelValue:u.dsId,"onUpdate:modelValue":n[0]||(n[0]=L=>u.dsId=L),placeholder:"请选择",onChange:n[1]||(n[1]=L=>$())},{default:yt(()=>[(Gt(!0),ae(le,null,Ee(V.value,L=>(Gt(),te(D,{key:L.id,label:L.dsName,value:L.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),ut(m,{span:12},{default:yt(()=>[ut(d,{label:"表",prop:"tableName"},{default:yt(()=>[ut(C,{modelValue:u.tableName,"onUpdate:modelValue":n[2]||(n[2]=L=>u.tableName=L),placeholder:"请选择",onChange:n[3]||(n[3]=L=>Q())},{default:yt(()=>[(Gt(!0),ae(le,null,Ee(J.value,L=>(Gt(),te(D,{key:L,label:L,value:L},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),ut(d,{label:"字段",prop:"tableName"},{default:yt(()=>[ut(T,{data:u.colList,border:"","show-header":"",style:{width:"100%"}},{default:yt(()=>[ut(e,{prop:"columnName",label:"名称"}),ut(e,{prop:"columnType",label:"类型"}),ut(e,{prop:"columnRemarks",label:"备注"})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"])]),_:1}),ut(m,{span:2})]),_:1}),Ut("div",Je,[ut(R,{type:"primary",onClick:n[4]||(n[4]=L=>M())},{default:yt(()=>n[5]||(n[5]=[Yt("下一步")])),_:1})])],64)}}}),tn=De(Qe,[["__scopeId","data-v-006d3d71"]]);var Ae={};(function(Rt){(function(){typeof Math.sgn>"u"&&(Math.sgn=function(p){return p==0?0:p>0?1:-1});var q={subtract:function(p,x){return{x:p.x-x.x,y:p.y-x.y}},dotProduct:function(p,x){return p.x*x.x+p.y*x.y},square:function(p){return Math.sqrt(p.x*p.x+p.y*p.y)},scale:function(p,x){return{x:p.x*x,y:p.y*x}}},u=64,V=Math.pow(2,-u-1),J=function(p,x){for(var U=[],B=Q(p,x),Y=x.length-1,i=2*Y-1,l=h(B,i,U,0),t=q.subtract(p,x[0]),g=q.square(t),y=0,N=0;N<l;N++){t=q.subtract(p,m(x,Y,U[N],null,null));var F=q.square(t);F<g&&(g=F,y=U[N])}return t=q.subtract(p,x[Y]),F=q.square(t),F<g&&(g=F,y=1),{location:y,distance:g}},$=function(p,x){var U=J(p,x);return{point:m(x,x.length-1,U.location,null,null),location:U.location}},Q=function(p,x){for(var U=x.length-1,B=2*U-1,Y=[],i=[],l=[],t=[],g=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],y=0;y<=U;y++)Y[y]=q.subtract(x[y],p);for(var y=0;y<=U-1;y++)i[y]=q.subtract(x[y+1],x[y]),i[y]=q.scale(i[y],3);for(var N=0;N<=U-1;N++)for(var F=0;F<=U;F++)l[N]||(l[N]=[]),l[N][F]=q.dotProduct(i[N],Y[F]);for(y=0;y<=B;y++)t[y]||(t[y]=[]),t[y].y=0,t[y].x=parseFloat(y)/B;for(var X=U,G=U-1,W=0;W<=X+G;W++){var at=Math.max(0,W-G),st=Math.min(W,X);for(y=at;y<=st;y++){var it=W-y;t[y+it].y+=l[it][y]*g[it][y]}}return t},h=function(p,x,U,B){var Y=[],i=[],l,t,g=[],y=[];switch(M(p,x)){case 0:return 0;case 1:{if(B>=u)return U[0]=(p[0].x+p[x].x)/2,1;if(o(p,x))return U[0]=n(p,x),1;break}}m(p,x,.5,Y,i),l=h(Y,x,g,B+1),t=h(i,x,y,B+1);for(var N=0;N<l;N++)U[N]=g[N];for(var N=0;N<t;N++)U[N+l]=y[N];return l+t},M=function(p,x){var U=0,B,Y;B=Y=Math.sgn(p[0].y);for(var i=1;i<=x;i++)B=Math.sgn(p[i].y),B!=Y&&U++,Y=B;return U},o=function(p,x){var U,B,Y,i,l,t,g,y,N,F,X,G,W,at,st,it;t=p[0].y-p[x].y,g=p[x].x-p[0].x,y=p[0].x*p[x].y-p[x].x*p[0].y;var rt,gt;rt=gt=0;for(var pt=1;pt<x;pt++){var lt=t*p[pt].x+g*p[pt].y+y;lt>rt?rt=lt:lt<gt&&(gt=lt)}return X=0,G=1,W=0,at=t,st=g,it=y-rt,N=X*st-at*G,F=1/N,B=(G*it-st*W)*F,at=t,st=g,it=y-gt,N=X*st-at*G,F=1/N,Y=(G*it-st*W)*F,i=Math.min(B,Y),l=Math.max(B,Y),U=l-i,U<V?1:0},n=function(p,x){var U=1,B=0,Y=p[x].x-p[0].x,i=p[x].y-p[0].y,l=p[0].x-0,t=p[0].y-0,g=Y*B-i*U,y=1/g,N=(Y*t-i*l)*y;return 0+U*N},m=function(p,x,U,B,Y){for(var i=[[]],l=0;l<=x;l++)i[0][l]=p[l];for(var t=1;t<=x;t++)for(var l=0;l<=x-t;l++)i[t]||(i[t]=[]),i[t][l]||(i[t][l]={}),i[t][l].x=(1-U)*i[t-1][l].x+U*i[t-1][l+1].x,i[t][l].y=(1-U)*i[t-1][l].y+U*i[t-1][l+1].y;if(B!=null)for(l=0;l<=x;l++)B[l]=i[l][0];if(Y!=null)for(l=0;l<=x;l++)Y[l]=i[x-l][l];return i[x][0]},E={},D=function(p){var x=E[p];if(!x){x=[];var U=function(){return function(F){return Math.pow(F,p)}},B=function(){return function(F){return Math.pow(1-F,p)}},Y=function(F){return function(X){return F}},i=function(){return function(F){return F}},l=function(){return function(F){return 1-F}},t=function(F){return function(X){for(var G=1,W=0;W<F.length;W++)G=G*F[W](X);return G}};x.push(new U);for(var g=1;g<p;g++){for(var y=[new Y(p)],N=0;N<p-g;N++)y.push(new i);for(var N=0;N<g;N++)y.push(new l);x.push(new t(y))}x.push(new B),E[p]=x}return x},C=function(p,x){for(var U=D(p.length-1),B=0,Y=0,i=0;i<p.length;i++)B=B+p[i].x*U[i](x),Y=Y+p[i].y*U[i](x);return{x:B,y:Y}},d=function(p,x){return Math.sqrt(Math.pow(p.x-x.x,2)+Math.pow(p.y-x.y,2))},e=function(p){return p[0].x===p[1].x&&p[0].y===p[1].y},T=function(p,x,U){if(e(p))return{point:p[0],location:x};for(var B=C(p,x),Y=0,i=x,l=U>0?1:-1,t=null;Y<Math.abs(U);)i+=.005*l,t=C(p,i),Y+=d(t,B),B=t;return{point:t,location:i}},I=function(p){var x=new Date().getTime();if(e(p))return 0;for(var U=C(p,0),B=0,Y=0,i=1,l=null;Y<1;)Y+=.005*i,l=C(p,Y),B+=d(l,U),U=l;return console.log("length",new Date().getTime()-x),B},R=function(p,x,U){return T(p,x,U).point},L=function(p,x,U){return T(p,x,U).location},_=function(p,x){var U=C(p,x),B=C(p.slice(0,p.length-1),x),Y=B.y-U.y,i=B.x-U.x;return Y===0?1/0:Math.atan(Y/i)},S=function(p,x,U){var B=T(p,x,U);return B.location>1&&(B.location=1),B.location<0&&(B.location=0),_(p,B.location)},s=function(p,x,U,B){B=B??0;var Y=T(p,x,B),i=_(p,Y.location),l=Math.atan(-1/i),t=U/2*Math.sin(l),g=U/2*Math.cos(l);return[{x:Y.point.x+g,y:Y.point.y+t},{x:Y.point.x-g,y:Y.point.y-t}]},f=function(p,x,U,B,Y){var i=B-x,l=p-U,t=p*(x-B)+x*(U-p),g=c(Y),y=[i*g[0][0]+l*g[1][0],i*g[0][1]+l*g[1][1],i*g[0][2]+l*g[1][2],i*g[0][3]+l*g[1][3]+t],N=v.apply(null,y),F=[];if(N!=null)for(var X=0;X<3;X++){var G=N[X],W=Math.pow(G,2),at=Math.pow(G,3),st=[g[0][0]*at+g[0][1]*W+g[0][2]*G+g[0][3],g[1][0]*at+g[1][1]*W+g[1][2]*G+g[1][3]],it;U-p!==0?it=(st[0]-p)/(U-p):it=(st[1]-x)/(B-x),G>=0&&G<=1&&it>=0&&it<=1&&F.push(st)}return F},a=function(p,x,U,B,Y){var i=[];return i.push.apply(i,f(p,x,p+U,x,Y)),i.push.apply(i,f(p+U,x,p+U,x+B,Y)),i.push.apply(i,f(p+U,x+B,p,x+B,Y)),i.push.apply(i,f(p,x+B,p,x,Y)),i},P=function(p,x){var U=[];return U.push.apply(U,f(p.x,p.y,p.x+p.w,p.y,x)),U.push.apply(U,f(p.x+p.w,p.y,p.x+p.w,p.y+p.h,x)),U.push.apply(U,f(p.x+p.w,p.y+p.h,p.x,p.y+p.h,x)),U.push.apply(U,f(p.x,p.y+p.h,p.x,p.y,x)),U};function k(p,x){return[-p[0][x]+3*p[1][x]+-3*p[2][x]+p[3][x],3*p[0][x]-6*p[1][x]+3*p[2][x],-3*p[0][x]+3*p[1][x],p[0][x]]}function c(p){return[k(p,"x"),k(p,"y")]}function j(p){return p<0?-1:p>0?1:0}function v(p,x,U,B){var Y=x/p,i=U/p,l=B/p,t=(3*i-Math.pow(Y,2))/9,g=(9*Y*i-27*l-2*Math.pow(Y,3))/54,y=Math.pow(t,3)+Math.pow(g,2),N,F,X=[];if(y>=0)N=j(g+Math.sqrt(y))*Math.pow(Math.abs(g+Math.sqrt(y)),1/3),F=j(g-Math.sqrt(y))*Math.pow(Math.abs(g-Math.sqrt(y)),1/3),X[0]=-Y/3+(N+F),X[1]=-Y/3-(N+F)/2,X[2]=-Y/3-(N+F)/2,Math.abs(Math.sqrt(3)*(N-F)/2)!==0&&(X[1]=-1,X[2]=-1);else{var G=Math.acos(g/Math.sqrt(-Math.pow(t,3)));X[0]=2*Math.sqrt(-t)*Math.cos(G/3)-Y/3,X[1]=2*Math.sqrt(-t)*Math.cos((G+2*Math.PI)/3)-Y/3,X[2]=2*Math.sqrt(-t)*Math.cos((G+4*Math.PI)/3)-Y/3}for(var W=0;W<3;W++)(X[W]<0||X[W]>1)&&(X[W]=-1);return X}var w=this.jsBezier={distanceFromCurve:J,gradientAtPoint:_,gradientAtPointAlongCurveFrom:S,nearestPointOnCurve:$,pointOnCurve:C,pointAlongCurveFrom:R,perpendicularToCurveAt:s,locationAlongCurveFrom:L,getLength:I,lineIntersection:f,boxIntersection:a,boundingBoxIntersection:P,version:"0.9.0"};Rt.jsBezier=w}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.Biltong={version:"0.4.0"};Rt.Biltong=u;var V=function(o){return Object.prototype.toString.call(o)==="[object Array]"},J=function(o,n,m){return o=V(o)?o:[o.x,o.y],n=V(n)?n:[n.x,n.y],m(o,n)},$=u.gradient=function(o,n){return J(o,n,function(m,E){return E[0]==m[0]?E[1]>m[1]?1/0:-1/0:E[1]==m[1]?E[0]>m[0]?0:-0:(E[1]-m[1])/(E[0]-m[0])})};u.normal=function(o,n){return-1/$(o,n)},u.lineLength=function(o,n){return J(o,n,function(m,E){return Math.sqrt(Math.pow(E[1]-m[1],2)+Math.pow(E[0]-m[0],2))})};var Q=u.quadrant=function(o,n){return J(o,n,function(m,E){return E[0]>m[0]||E[0]==m[0]?E[1]>m[1]?2:1:E[1]>m[1]?3:4})};u.theta=function(o,n){return J(o,n,function(m,E){var D=$(m,E),C=Math.atan(D),d=Q(m,E);return(d==4||d==3)&&(C+=Math.PI),C<0&&(C+=2*Math.PI),C})},u.intersects=function(o,n){var m=o.x,E=o.x+o.w,D=o.y,C=o.y+o.h,d=n.x,e=n.x+n.w,T=n.y,I=n.y+n.h;return m<=d&&d<=E&&D<=T&&T<=C||m<=e&&e<=E&&D<=T&&T<=C||m<=d&&d<=E&&D<=I&&I<=C||m<=e&&d<=E&&D<=I&&I<=C||d<=m&&m<=e&&T<=D&&D<=I||d<=E&&E<=e&&T<=D&&D<=I||d<=m&&m<=e&&T<=C&&C<=I||d<=E&&m<=e&&T<=C&&C<=I},u.encloses=function(o,n,m){var E=o.x,D=o.x+o.w,C=o.y,d=o.y+o.h,e=n.x,T=n.x+n.w,I=n.y,R=n.y+n.h,L=function(_,S,s,f){return m?_<=S&&s>=f:_<S&&s>f};return L(E,e,D,T)&&L(C,I,d,R)};var h=[null,[1,-1],[1,1],[-1,1],[-1,-1]],M=[null,[-1,-1],[-1,1],[1,1],[1,-1]];u.pointOnLine=function(o,n,m){var E=$(o,n),D=Q(o,n),C=m>0?h[D]:M[D],d=Math.atan(E),e=Math.abs(m*Math.sin(d))*C[1],T=Math.abs(m*Math.cos(d))*C[0];return{x:o.x+T,y:o.y+e}},u.perpendicularLineTo=function(o,n,m){var E=$(o,n),D=Math.atan(-1/E),C=m/2*Math.sin(D),d=m/2*Math.cos(D);return[{x:n.x+d,y:n.y+C},{x:n.x-d,y:n.y-C}]}}).call(typeof window<"u"?window:Ot),(function(){function q(i,l,t,g,y,N,F,X){return new Touch({target:l,identifier:Y(),pageX:t,pageY:g,screenX:y,screenY:N,clientX:F||y,clientY:X||N})}function u(){var i=[];return Array.prototype.push.apply(i,arguments),i.item=function(l){return this[l]},i}function V(i,l,t,g,y,N,F,X){return u(q.apply(null,arguments))}var J=this,$=function(i,l,t){t=t||i.parentNode;for(var g=t.querySelectorAll(l),y=0;y<g.length;y++)if(g[y]===i)return!0;return!1},Q=function(i){return typeof i=="string"||i.constructor===String?document.getElementById(i):i},h=function(i){return i.srcElement||i.target},M=function(i,l,t,g){if(g){if(typeof i.path<"u"&&i.path.indexOf)return{path:i.path,end:i.path.indexOf(t)};var y={path:[],end:-1},N=function(F){y.path.push(F),F===t?y.end=y.path.length-1:F.parentNode!=null&&N(F.parentNode)};return N(l),y}else return{path:[l],end:1}},o=function(i,l){for(var t=0,g=i.length;t<g&&i[t]!=l;t++);t<i.length&&i.splice(t,1)},n=1,m=function(i,l,t){var g=n++;return i.__ta=i.__ta||{},i.__ta[l]=i.__ta[l]||{},i.__ta[l][g]=t,t.__tauid=g,g},E=function(i,l,t){if(i.__ta&&i.__ta[l]&&delete i.__ta[l][t.__tauid],t.__taExtra){for(var g=0;g<t.__taExtra.length;g++)U(i,t.__taExtra[g][0],t.__taExtra[g][1]);t.__taExtra.length=0}t.__taUnstore&&t.__taUnstore()},D=function(i,l,t,g){if(i==null)return t;var y=i.split(","),N=function(F){N.__tauid=t.__tauid;var X=h(F),G=X,W=M(F,X,l,i!=null);if(W.end!=-1)for(var at=0;at<W.end;at++){G=W.path[at];for(var st=0;st<y.length;st++)$(G,y[st],l)&&t.apply(G,arguments)}};return C(t,g,N),N},C=function(i,l,t){i.__taExtra=i.__taExtra||[],i.__taExtra.push([l,t])},d=function(i,l,t,g){if(_&&s[l]){var y=D(g,i,t,s[l]);x(i,s[l],y,t)}l==="focus"&&i.getAttribute("tabindex")==null&&i.setAttribute("tabindex","1"),x(i,l,D(g,i,t,l),t)},e=function(i,l,t,g){if(i.__taSmartClicks==null){var y=function(X){i.__tad=k(X)},N=function(X){i.__tau=k(X)},F=function(X){if(i.__tad&&i.__tau&&i.__tad[0]===i.__tau[0]&&i.__tad[1]===i.__tau[1])for(var G=0;G<i.__taSmartClicks.length;G++)i.__taSmartClicks[G].apply(h(X),[X])};d(i,"mousedown",y,g),d(i,"mouseup",N,g),d(i,"click",F,g),i.__taSmartClicks=[]}i.__taSmartClicks.push(t),t.__taUnstore=function(){o(i.__taSmartClicks,t)}},T={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},I=function(i,l){return function(t,g,y,N){if(g=="contextmenu"&&S)d(t,g,y,N);else{if(t.__taTapHandler==null){var F=t.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},X=function(st){for(var it=h(st),rt=M(st,it,t,N!=null),gt=!1,pt=0;pt<rt.end;pt++){if(gt)return;it=rt.path[pt];for(var lt=0;lt<F.downSelectors.length;lt++)if(F.downSelectors[lt]==null||$(it,F.downSelectors[lt],t)){F.down=!0,setTimeout(W,i),setTimeout(at,l),gt=!0;break}}},G=function(st){if(F.down){var it=h(st),rt,gt;F.taps++;var pt=p(st);for(var lt in T)if(T.hasOwnProperty(lt)){var _t=T[lt];if(_t.touches===pt&&(_t.taps===1||_t.taps===F.taps))for(var vt=0;vt<F[lt].length;vt++){gt=M(st,it,t,F[lt][vt][1]!=null);for(var Z=0;Z<gt.end;Z++)if(rt=gt.path[Z],F[lt][vt][1]==null||$(rt,F[lt][vt][1],t)){F[lt][vt][0].apply(rt,[st]);break}}}}},W=function(){F.down=!1},at=function(){F.taps=0};d(t,"mousedown",X),d(t,"mouseup",G)}t.__taTapHandler.downSelectors.push(N),t.__taTapHandler[g].push([y,N]),y.__taUnstore=function(){o(t.__taTapHandler[g],y)}}}},R=function(i,l,t,g){for(var y in t.__tamee[i])t.__tamee[i].hasOwnProperty(y)&&t.__tamee[i][y].apply(g,[l])},L=function(){var i=[];return function(l,t,g,y){if(!l.__tamee){l.__tamee={over:!1,mouseenter:[],mouseexit:[]};var N=function(X){var G=h(X);(y==null&&G==l&&!l.__tamee.over||$(G,y,l)&&(G.__tamee==null||!G.__tamee.over))&&(R("mouseenter",X,l,G),G.__tamee=G.__tamee||{},G.__tamee.over=!0,i.push(G))},F=function(X){for(var G=h(X),W=0;W<i.length;W++)G==i[W]&&!$(X.relatedTarget||X.toElement,"*",G)&&(G.__tamee.over=!1,i.splice(W,1),R("mouseexit",X,l,G))};x(l,"mouseover",D(y,l,N,"mouseover"),N),x(l,"mouseout",D(y,l,F,"mouseout"),F)}g.__taUnstore=function(){delete l.__tamee[t][g.__tauid]},m(l,t,g),l.__tamee[t][g.__tauid]=g}},_="ontouchstart"in document.documentElement||navigator.maxTouchPoints,S="onmousedown"in document.documentElement,s={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},f=function(){var i=-1;if(navigator.appName=="Microsoft Internet Explorer"){var l=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");t.exec(l)!=null&&(i=parseFloat(RegExp.$1))}return i}(),a=f>-1&&f<9,P=function(i,l){if(i==null)return[0,0];var t=w(i),g=v(t,0);return[g[l+"X"],g[l+"Y"]]},k=function(i){return i==null?[0,0]:a?[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop]:P(i,"page")},c=function(i){return P(i,"screen")},j=function(i){return P(i,"client")},v=function(i,l){return i.item?i.item(l):i[l]},w=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},p=function(i){return w(i).length},x=function(i,l,t,g){if(m(i,l,t),g.__tauid=t.__tauid,i.addEventListener)i.addEventListener(l,t,!1);else if(i.attachEvent){var y=l+t.__tauid;i["e"+y]=t,i[y]=function(){i["e"+y]&&i["e"+y](window.event)},i.attachEvent("on"+l,i[y])}},U=function(i,l,t){t!=null&&B(i,function(){var g=Q(this);if(E(g,l,t),t.__tauid!=null){if(g.removeEventListener)g.removeEventListener(l,t,!1),_&&s[l]&&g.removeEventListener(s[l],t,!1);else if(this.detachEvent){var y=l+t.__tauid;g[y]&&g.detachEvent("on"+l,g[y]),g[y]=null,g["e"+y]=null}}t.__taTouchProxy&&U(i,t.__taTouchProxy[1],t.__taTouchProxy[0])})},B=function(i,l){if(i!=null){i=typeof Window<"u"&&typeof i.top!="unknown"&&i==i.top?[i]:typeof i!="string"&&i.tagName==null&&i.length!=null?i:typeof i=="string"?document.querySelectorAll(i):[i];for(var t=0;t<i.length;t++)l.apply(i[t])}},Y=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var l=Math.random()*16|0,t=i=="x"?l:l&3|8;return t.toString(16)})};J.Mottle=function(i){i=i||{};var l=i.clickThreshold||250,t=i.dblClickThreshold||450,g=new L,y=new I(l,t),N=i.smartClicks,F=function(X,G,W,at){W!=null&&B(X,function(){var st=Q(this);N&&G==="click"?e(st,G,W,at):G==="tap"||G==="dbltap"||G==="contextmenu"?y(st,G,W,at):G==="mouseenter"||G=="mouseexit"?g(st,G,W,at):d(st,G,W,at)})};this.remove=function(X){return B(X,function(){var G=Q(this);if(G.__ta){for(var W in G.__ta)if(G.__ta.hasOwnProperty(W))for(var at in G.__ta[W])G.__ta[W].hasOwnProperty(at)&&U(G,W,G.__ta[W][at])}G.parentNode&&G.parentNode.removeChild(G)}),this},this.on=function(X,G,W,at){var st=arguments[0],it=arguments.length==4?arguments[2]:null,rt=arguments[1],gt=arguments[arguments.length-1];return F(st,rt,gt,it),this},this.off=function(X,G,W){return U(X,G,W),this},this.trigger=function(X,G,W,at){var st=S&&(typeof MouseEvent>"u"||W==null||W.constructor===MouseEvent),it=_&&!S&&s[G]?s[G]:G,rt=!(_&&!S&&s[G]),gt=k(W),pt=c(W),lt=j(W);return B(X,function(){var _t=Q(this),vt;W=W||{screenX:pt[0],screenY:pt[1],clientX:lt[0],clientY:lt[1]};var Z=function(mt){at&&(mt.payload=at)},K={TouchEvent:function(mt){var wt=V(window,_t,0,gt[0],gt[1],pt[0],pt[1],lt[0],lt[1]),Mt=mt.initTouchEvent||mt.initEvent;Mt(it,!0,!0,window,null,pt[0],pt[1],lt[0],lt[1],!1,!1,!1,!1,wt,wt,wt,1,0)},MouseEvents:function(mt){mt.initMouseEvent(it,!0,!0,window,0,pt[0],pt[1],lt[0],lt[1],!1,!1,!1,!1,1,_t)}};if(document.createEvent){var tt=!rt&&!st&&_&&s[G],ht=tt?"TouchEvent":"MouseEvents";vt=document.createEvent(ht),K[ht](vt),Z(vt),_t.dispatchEvent(vt)}else document.createEventObject&&(vt=document.createEventObject(),vt.eventType=vt.eventName=it,vt.screenX=pt[0],vt.screenY=pt[1],vt.clientX=lt[0],vt.clientY=lt[1],Z(vt),_t.fireEvent("on"+it,vt))}),this}},J.Mottle.consume=function(i,l){i.stopPropagation?i.stopPropagation():i.returnValue=!1,!l&&i.preventDefault&&i.preventDefault()},J.Mottle.pageLocation=k,J.Mottle.setForceTouchEvents=function(i){_=i},J.Mottle.setForceMouseEvents=function(i){S=i},J.Mottle.version="0.8.0",Rt.Mottle=J.Mottle}).call(typeof window>"u"?Ot:window),(function(){var q=this,u=function(i,l,t){return i.indexOf(l)===-1?(i.push(l),!0):!1},V=function(i,l){var t=i.indexOf(l);t!==-1&&i.splice(t,1)},J=function(i,l){for(var t=[],g=0;g<i.length;g++)l.indexOf(i[g])===-1&&t.push(i[g]);return t},$=function(i){return i==null?!1:typeof i=="string"||i.constructor===String},Q=function(i){var l=i.getBoundingClientRect(),t=document.body,g=document.documentElement,y=window.pageYOffset||g.scrollTop||t.scrollTop,N=window.pageXOffset||g.scrollLeft||t.scrollLeft,F=g.clientTop||t.clientTop||0,X=g.clientLeft||t.clientLeft||0,G=l.top+y-F,W=l.left+N-X;return{top:Math.round(G),left:Math.round(W)}},h=function(i,l,t){t=t||i.parentNode;for(var g=t.querySelectorAll(l),y=0;y<g.length;y++)if(g[y]===i)return!0;return!1},M=function(i,l,t){if(h(l,t,i))return l;for(var g=l.parentNode;g!=null&&g!==i;){if(h(g,t,i))return g;g=g.parentNode}},o=function(i,l,t){for(var g=null,y=l.getAttribute("katavorio-draggable"),N=y!=null?"[katavorio-draggable='"+y+"'] ":"",F=0;F<i.length;F++)if(g=M(l,t,N+i[F].selector),g!=null){if(i[F].filter){var X=h(t,i[F].filter,g),G=i[F].filterExclude===!0;if(G&&!X||X)return null}return[i[F],g]}return null},n=function(){var i=-1;if(navigator.appName==="Microsoft Internet Explorer"){var l=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");t.exec(l)!=null&&(i=parseFloat(RegExp.$1))}return i}(),m=10,E=10,D=n>-1&&n<9,C=n===9,d=function(i){if(D)return[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop];var l=T(i),t=e(l,0);return C?[t.pageX||t.clientX,t.pageY||t.clientY]:[t.pageX,t.pageY]},e=function(i,l){return i.item?i.item(l):i[l]},T=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},I={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},R="katavorio-drag-scope",L=["stop","start","drag","drop","over","out","beforeStart"],_=function(){},S=function(){return!0},s=function(i,l,t){for(var g=0;g<i.length;g++)i[g]!=t&&l(i[g])},f=function(i,l,t,g){s(i,function(y){y.setActive(l),l&&y.updatePosition(),t&&y.setHover(g,l)})},a=function(i,l){if(i!=null){i=!$(i)&&i.tagName==null&&i.length!=null?i:[i];for(var t=0;t<i.length;t++)l.apply(i[t],[i[t]])}},P=function(i){i.stopPropagation?(i.stopPropagation(),i.preventDefault()):i.returnValue=!1},k="input,textarea,select,button,option",c=function(i,l,t){var g=i.srcElement||i.target;return!h(g,t.getInputFilterSelector(),l)},j=function(i,l,t,g){this.params=l||{},this.el=i,this.params.addClass(this.el,this._class),this.uuid=U();var y=!0;return this.setEnabled=function(N){y=N},this.isEnabled=function(){return y},this.toggleEnabled=function(){y=!y},this.setScope=function(N){this.scopes=N?N.split(/\s+/):[g]},this.addScope=function(N){var F={};a(this.scopes,function(G){F[G]=!0}),a(N?N.split(/\s+/):[],function(G){F[G]=!0}),this.scopes=[];for(var X in F)this.scopes.push(X)},this.removeScope=function(N){var F={};a(this.scopes,function(G){F[G]=!0}),a(N?N.split(/\s+/):[],function(G){delete F[G]}),this.scopes=[];for(var X in F)this.scopes.push(X)},this.toggleScope=function(N){var F={};a(this.scopes,function(G){F[G]=!0}),a(N?N.split(/\s+/):[],function(G){F[G]?delete F[G]:F[G]=!0}),this.scopes=[];for(var X in F)this.scopes.push(X)},this.setScope(l.scope),this.k=l.katavorio,l.katavorio},v=function(){return!0},w=function(){return!1},p=function(i,l,t,g){this._class=t.draggable;var y=j.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var N=[0,0],F=null,X=null,G=[0,0],W=!1,at=[0,0],st=this.params.consumeStartEvent!==!1,it=this.el,rt=this.params.clone;this.params.scroll;var gt=l.multipleDrop!==!1,pt=!1,lt,_t,vt=null,Z=[],K=null,tt=l.ghostProxyParent,ht,mt,wt,Mt;if(l.ghostProxy===!0?lt=v:l.ghostProxy&&typeof l.ghostProxy=="function"?lt=l.ghostProxy:lt=function(et,Ct){return K&&K.useGhostProxy?K.useGhostProxy(et,Ct):!1},l.makeGhostProxy?_t=l.makeGhostProxy:_t=function(et){return K&&K.makeGhostProxy?K.makeGhostProxy(et):et.cloneNode(!0)},l.selector){var Ht=i.getAttribute("katavorio-draggable");Ht==null&&(Ht=""+new Date().getTime(),i.setAttribute("katavorio-draggable",Ht)),Z.push(l)}var Bt=l.snapThreshold,Xt=function(et,Ct,Et,Pt,Dt){var kt=Math.floor(et[0]/Ct),r=Ct*kt,A=r+Ct,b=Math.abs(et[0]-r)<=Pt?r:Math.abs(A-et[0])<=Pt?A:et[0],O=Math.floor(et[1]/Et),H=Et*O,z=H+Et,nt=Math.abs(et[1]-H)<=Dt?H:Math.abs(z-et[1])<=Dt?z:et[1];return[b,nt]};this.posses=[],this.posseRoles={},this.toGrid=function(et){if(this.params.grid==null)return et;var Ct=this.params.grid?this.params.grid[0]/2:Bt||m/2,Et=this.params.grid?this.params.grid[1]/2:Bt||E/2;return Xt(et,this.params.grid[0],this.params.grid[1],Ct,Et)},this.snap=function(et,Ct){if(it!=null){et=et||(this.params.grid?this.params.grid[0]:m),Ct=Ct||(this.params.grid?this.params.grid[1]:E);var Et=this.params.getPosition(it),Pt=this.params.grid?this.params.grid[0]/2:Bt,Dt=this.params.grid?this.params.grid[1]/2:Bt,kt=Xt(Et,et,Ct,Pt,Dt);return this.params.setPosition(it,kt),kt}},this.setUseGhostProxy=function(et){lt=et?v:w};var Wt,ge=function(et){return l.allowNegative===!1?[Math.max(0,et[0]),Math.max(0,et[1])]:et},ve=(function(et){Wt=typeof et=="function"?et:et?(function(Ct,Et,Pt,Dt){return ge([Math.max(0,Math.min(Pt.w-Dt[0],Ct[0])),Math.max(0,Math.min(Pt.h-Dt[1],Ct[1]))])}).bind(this):function(Ct){return ge(Ct)}}).bind(this);ve(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(et){ve(et)};var me=function(et,Ct,Et,Pt){return K!=null&&K.constrain&&typeof K.constrain=="function"?K.constrain(et,Ct,Et,Pt):Wt(et,Ct,Et,Pt)},zt;this.setRevert=function(et){zt=et},this.params.revert&&(zt=this.params.revert);var re=function(et){return typeof et=="function"?(et._katavorioId=U(),et._katavorioId):et},qt={},oe=function(et){for(var Ct in qt){var Et=qt[Ct],Pt=Et[0](et);if(Et[1]&&(Pt=!Pt),!Pt)return!1}return!0},ue=this.setFilter=function(et,Ct){if(et){var Et=re(et);qt[Et]=[function(Pt){var Dt=Pt.srcElement||Pt.target,kt;return $(et)?kt=h(Dt,et,i):typeof et=="function"&&(kt=et(Pt,i)),kt},Ct!==!1]}};this.addFilter=ue,this.removeFilter=function(et){var Ct=typeof et=="function"?et._katavorioId:et;delete qt[Ct]},this.clearAllFilters=function(){qt={}},this.canDrag=this.params.canDrag||S;var he,Tt=[],$t=[];this.addSelector=function(et){et.selector&&Z.push(et)},this.downListener=(function(et){if(!et.defaultPrevented){var Ct=this.rightButtonCanDrag||et.which!==3&&et.button!==2;if(Ct&&this.isEnabled()&&this.canDrag()){var Et=oe(et)&&c(et,this.el,this.k);if(Et){if(K=null,vt=null,Z.length>0){var Pt=o(Z,this.el,et.target||et.srcElement);if(Pt!=null&&(K=Pt[0],vt=Pt[1]),vt==null)return}else vt=this.el;if(rt)if(it=vt.cloneNode(!0),this.params.addClass(it,I.clonedDrag),it.setAttribute("id",null),it.style.position="absolute",this.params.parent!=null){var Dt=this.params.getPosition(this.el);it.style.left=Dt[0]+"px",it.style.top=Dt[1]+"px",this.params.parent.appendChild(it)}else{var kt=Q(vt);it.style.left=kt.left+"px",it.style.top=kt.top+"px",document.body.appendChild(it)}else it=vt;st&&P(et),N=d(et),it&&it.parentNode&&(at=[it.parentNode.scrollLeft,it.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),y.markSelection(this),y.markPosses(this),this.params.addClass(document.body,t.noSelect),Kt("beforeStart",{el:this.el,pos:F,e:et,drag:this})}else this.params.consumeFilteredEvents&&P(et)}}}).bind(this),this.moveListener=(function(et){if(N){if(!W){var Ct=Kt("start",{el:this.el,pos:F,e:et,drag:this});if(Ct!==!1){if(!N)return;this.mark(!0),W=!0}else this.abort()}if(N){$t.length=0;var Et=d(et),Pt=Et[0]-N[0],Dt=Et[1]-N[1],kt=this.params.ignoreZoom?1:y.getZoom();it&&it.parentNode&&(Pt+=it.parentNode.scrollLeft-at[0],Dt+=it.parentNode.scrollTop-at[1]),Pt/=kt,Dt/=kt,this.moveBy(Pt,Dt,et),y.updateSelection(Pt,Dt,this),y.updatePosses(Pt,Dt,this)}}}).bind(this),this.upListener=(function(et){N&&(N=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,t.noSelect),this.unmark(et),y.unmarkSelection(this,et),y.unmarkPosses(this,et),this.stop(et),y.notifyPosseDragStop(this,et),W=!1,$t.length=0,rt?(it&&it.parentNode&&it.parentNode.removeChild(it),it=null):zt&&zt(it,this.params.getPosition(it))===!0&&(this.params.setPosition(it,F),Kt("revert",it)))}).bind(this),this.getFilters=function(){return qt},this.abort=function(){N!=null&&this.upListener()},this.getDragElement=function(et){return et?vt||this.el:it||this.el};var It={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};l.events.start&&It.start.push(l.events.start),l.events.beforeStart&&It.beforeStart.push(l.events.beforeStart),l.events.stop&&It.stop.push(l.events.stop),l.events.drag&&It.drag.push(l.events.drag),l.events.revert&&It.revert.push(l.events.revert),this.on=function(et,Ct){It[et]&&It[et].push(Ct)},this.off=function(et,Ct){if(It[et]){for(var Et=[],Pt=0;Pt<It[et].length;Pt++)It[et][Pt]!==Ct&&Et.push(It[et][Pt]);It[et]=Et}};var Kt=function(et,Ct){var Et=null;if(K&&K[et])Et=K[et](Ct);else if(It[et])for(var Pt=0;Pt<It[et].length;Pt++)try{var Dt=It[et][Pt](Ct);Dt!=null&&(Et=Dt)}catch{}return Et};this.notifyStart=function(et){Kt("start",{el:this.el,pos:this.params.getPosition(it),e:et,drag:this})},this.stop=function(et,Ct){if(Ct||W){var Et=[],Pt=y.getSelection(),Dt=this.params.getPosition(it);if(Pt.length>0)for(var kt=0;kt<Pt.length;kt++){var r=this.params.getPosition(Pt[kt].el);Et.push([Pt[kt].el,{left:r[0],top:r[1]},Pt[kt]])}else Et.push([it,{left:Dt[0],top:Dt[1]},this]);Kt("stop",{el:it,pos:ee||Dt,finalPos:Dt,e:et,drag:this,selection:Et})}},this.mark=function(et){F=this.params.getPosition(it),X=this.params.getPosition(it,!0),G=[X[0]-F[0],X[1]-F[1]],this.size=this.params.getSize(it),Tt=y.getMatchingDroppables(this),f(Tt,!0,!1,this),this.params.addClass(it,this.params.dragClass||t.drag);var Ct;this.params.getConstrainingRectangle?Ct=this.params.getConstrainingRectangle(it):Ct=this.params.getSize(it.parentNode),he={w:Ct[0],h:Ct[1]},wt=0,Mt=0,et&&y.notifySelectionDragStart(this)};var ee;this.unmark=function(et,Ct){if(f(Tt,!1,!0,this),pt&&lt(vt,it)?(ee=[it.offsetLeft-wt,it.offsetTop-Mt],it.parentNode.removeChild(it),it=vt):ee=null,this.params.removeClass(it,this.params.dragClass||t.drag),Tt.length=0,pt=!1,!Ct){$t.length>0&&ee&&l.setPosition(vt,ee),$t.sort(B);for(var Et=0;Et<$t.length;Et++){var Pt=$t[Et].drop(this,et);if(Pt===!0)break}}},this.moveBy=function(et,Ct,Et){$t.length=0;var Pt=this.toGrid([F[0]+et,F[1]+Ct]),Dt=me(Pt,it,he,this.size);if(lt(this.el,it))if(Pt[0]!==Dt[0]||Pt[1]!==Dt[1]){if(!pt){var kt=_t(vt);l.addClass(kt,I.ghostProxy),tt?(tt.appendChild(kt),ht=l.getPosition(vt.parentNode,!0),mt=l.getPosition(l.ghostProxyParent,!0),wt=ht[0]-mt[0],Mt=ht[1]-mt[1]):vt.parentNode.appendChild(kt),it=kt,pt=!0}Dt=Pt}else pt&&(it.parentNode.removeChild(it),it=vt,pt=!1,ht=null,mt=null,wt=0,Mt=0);var r={x:Dt[0],y:Dt[1],w:this.size[0],h:this.size[1]},A={x:r.x+G[0],y:r.y+G[1],w:r.w,h:r.h},b=null;this.params.setPosition(it,[Dt[0]+wt,Dt[1]+Mt]);for(var O=0;O<Tt.length;O++){var H={x:Tt[O].pagePosition[0],y:Tt[O].pagePosition[1],w:Tt[O].size[0],h:Tt[O].size[1]};this.params.intersects(A,H)&&(gt||b==null||b===Tt[O].el)&&Tt[O].canDrop(this)?(b||(b=Tt[O].el),$t.push(Tt[O]),Tt[O].setHover(this,!0,Et)):Tt[O].isHover()&&Tt[O].setHover(this,!1,Et)}Kt("drag",{el:this.el,pos:Dt,e:Et,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?ue(this.params.handle,!1):ue(this.params.filter,this.params.filterExclude)},x=function(i,l,t,g){this._class=t.droppable,this.params=l||{},this.rank=l.rank||0,this._activeClass=this.params.activeClass||t.active,this._hoverClass=this.params.hoverClass||t.hover,j.apply(this,arguments);var y=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(N){this.params[N?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(N){return!0},this.isHover=function(){return y},this.setHover=function(N,F,X){(F||this.el._katavorioDragHover==null||this.el._katavorioDragHover===N.el._katavorio)&&(this.params[F?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=F?N.el._katavorio:null,y!==F&&this.params.events[F?"over":"out"]({el:this.el,e:X,drag:N,drop:this}),y=F)},this.drop=function(N,F){return this.params.events.drop({drag:N,e:F,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,y=null}},U=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var l=Math.random()*16|0,t=i==="x"?l:l&3|8;return t.toString(16)})},B=function(i,l){return i.rank<l.rank?1:i.rank>l.rank?-1:0},Y=function(i){return i==null||(i=typeof i=="string"||i.constructor===String?document.getElementById(i):i,i==null)?null:(i._katavorio=i._katavorio||U(),i)};q.Katavorio=function(i){var l=[],t={};this._dragsByScope={},this._dropsByScope={};var g=1,y=function(Z,K){a(Z,function(tt){for(var ht=0;ht<tt.scopes.length;ht++)K[tt.scopes[ht]]=K[tt.scopes[ht]]||[],K[tt.scopes[ht]].push(tt)})},N=function(Z,K){var tt=0;return a(Z,function(ht){for(var mt=0;mt<ht.scopes.length;mt++)if(K[ht.scopes[mt]]){var wt=i.indexOf(K[ht.scopes[mt]],ht);wt!==-1&&(K[ht.scopes[mt]].splice(wt,1),tt++)}}),tt>0};this.getMatchingDroppables=function(Z){for(var K=[],tt={},ht=0;ht<Z.scopes.length;ht++){var mt=this._dropsByScope[Z.scopes[ht]];if(mt)for(var wt=0;wt<mt.length;wt++)mt[wt].canDrop(Z)&&!tt[mt[wt].uuid]&&(mt[wt].allowLoopback||mt[wt].el!==Z.el)&&(tt[mt[wt].uuid]=!0,K.push(mt[wt]))}return K.sort(B),K};var F=(function(Z){Z=Z||{};var K={events:{}},tt;for(tt in i)K[tt]=i[tt];for(tt in Z)K[tt]=Z[tt];for(tt=0;tt<L.length;tt++)K.events[L[tt]]=Z[L[tt]]||_;return K.katavorio=this,K}).bind(this),X=(function(Z,K){for(var tt=0;tt<L.length;tt++)K[L[tt]]&&Z.on(L[tt],K[L[tt]])}).bind(this),G={},W=i.css||{},at=i.scope||R;for(var st in I)G[st]=I[st];for(var st in W)G[st]=W[st];var it=i.inputFilterSelector||k;this.getInputFilterSelector=function(){return it},this.setInputFilterSelector=function(Z){return it=Z,this},this.draggable=function(Z,K){var tt=[];return a(Z,(function(ht){if(ht=Y(ht),ht!=null)if(ht._katavorioDrag==null){var mt=F(K);ht._katavorioDrag=new p(ht,mt,G,at),y(ht._katavorioDrag,this._dragsByScope),tt.push(ht._katavorioDrag),i.addClass(ht,mt.selector?G.delegatedDraggable:G.draggable)}else X(ht._katavorioDrag,K)}).bind(this)),tt},this.droppable=function(Z,K){var tt=[];return a(Z,(function(ht){if(ht=Y(ht),ht!=null){var mt=new x(ht,F(K),G,at);ht._katavorioDrop=ht._katavorioDrop||[],ht._katavorioDrop.push(mt),y(mt,this._dropsByScope),tt.push(mt),i.addClass(ht,G.droppable)}}).bind(this)),tt},this.select=function(Z){return a(Z,function(){var K=Y(this);K&&K._katavorioDrag&&(t[K._katavorio]||(l.push(K._katavorioDrag),t[K._katavorio]=[K,l.length-1],i.addClass(K,G.selected)))}),this},this.deselect=function(Z){return a(Z,function(){var K=Y(this);if(K&&K._katavorio){var tt=t[K._katavorio];if(tt){for(var ht=[],mt=0;mt<l.length;mt++)l[mt].el!==K&&ht.push(l[mt]);l=ht,delete t[K._katavorio],i.removeClass(K,G.selected)}}}),this},this.deselectAll=function(){for(var Z in t){var K=t[Z];i.removeClass(K[0],G.selected)}l.length=0,t={}},this.markSelection=function(Z){s(l,function(K){K.mark()},Z)},this.markPosses=function(Z){Z.posses&&a(Z.posses,function(K){Z.posseRoles[K]&&_t[K]&&s(_t[K].members,function(tt){tt.mark()},Z)})},this.unmarkSelection=function(Z,K){s(l,function(tt){tt.unmark(K)},Z)},this.unmarkPosses=function(Z,K){Z.posses&&a(Z.posses,function(tt){Z.posseRoles[tt]&&_t[tt]&&s(_t[tt].members,function(ht){ht.unmark(K,!0)},Z)})},this.getSelection=function(){return l.slice(0)},this.updateSelection=function(Z,K,tt){s(l,function(ht){ht.moveBy(Z,K)},tt)};var rt=function(Z,K){K.posses&&a(K.posses,function(tt){K.posseRoles[tt]&&_t[tt]&&s(_t[tt].members,function(ht){Z(ht)},K)})};this.updatePosses=function(Z,K,tt){rt(function(ht){ht.moveBy(Z,K)},tt)},this.notifyPosseDragStop=function(Z,K){rt(function(tt){tt.stop(K,!0)},Z)},this.notifySelectionDragStop=function(Z,K){s(l,function(tt){tt.stop(K,!0)},Z)},this.notifySelectionDragStart=function(Z,K){s(l,function(tt){tt.notifyStart(K)},Z)},this.setZoom=function(Z){g=Z},this.getZoom=function(){return g};var gt=function(Z,K,tt,ht){a(Z,function(mt){N(mt,tt),mt[ht](K),y(mt,tt)})};a(["set","add","remove","toggle"],(function(Z){this[Z+"Scope"]=(function(K,tt){gt(K._katavorioDrag,tt,this._dragsByScope,Z+"Scope"),gt(K._katavorioDrop,tt,this._dropsByScope,Z+"Scope")}).bind(this),this[Z+"DragScope"]=(function(K,tt){gt(K.constructor===p?K:K._katavorioDrag,tt,this._dragsByScope,Z+"Scope")}).bind(this),this[Z+"DropScope"]=(function(K,tt){gt(K.constructor===x?K:K._katavorioDrop,tt,this._dropsByScope,Z+"Scope")}).bind(this)}).bind(this)),this.snapToGrid=function(Z,K){for(var tt in this._dragsByScope)s(this._dragsByScope[tt],function(ht){ht.snap(Z,K)})},this.getDragsForScope=function(Z){return this._dragsByScope[Z]},this.getDropsForScope=function(Z){return this._dropsByScope[Z]};var pt=function(Z,K,tt){if(Z=Y(Z),Z[K]){var ht=l.indexOf(Z[K]);ht>=0&&l.splice(ht,1),N(Z[K],tt)&&a(Z[K],function(mt){mt.destroy()}),delete Z[K]}},lt=function(Z,K,tt,ht){Z=Y(Z),Z[K]&&Z[K].off(tt,ht)};this.elementRemoved=function(Z){Z._katavorioDrag&&this.destroyDraggable(Z),Z._katavorioDrop&&this.destroyDroppable(Z)},this.destroyDraggable=function(Z,K,tt){arguments.length===1?pt(Z,"_katavorioDrag",this._dragsByScope):lt(Z,"_katavorioDrag",K,tt)},this.destroyDroppable=function(Z,K,tt){arguments.length===1?pt(Z,"_katavorioDrop",this._dropsByScope):lt(Z,"_katavorioDrop",K,tt)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},l=[],t={},_t={}};var _t={},vt=function(Z,K,tt){var ht=$(K)?K:K.id,mt=$(K)?!0:K.active!==!1,wt=_t[ht]||function(){var Mt={name:ht,members:[]};return _t[ht]=Mt,Mt}();return a(Z,function(Mt){if(Mt._katavorioDrag){if(tt&&Mt._katavorioDrag.posseRoles[wt.name]!=null)return;u(wt.members,Mt._katavorioDrag),u(Mt._katavorioDrag.posses,wt.name),Mt._katavorioDrag.posseRoles[wt.name]=mt}}),wt};this.addToPosse=function(Z,K){for(var tt=[],ht=1;ht<arguments.length;ht++)tt.push(vt(Z,arguments[ht]));return tt.length===1?tt[0]:tt},this.setPosse=function(Z,K){for(var tt=[],ht=1;ht<arguments.length;ht++)tt.push(vt(Z,arguments[ht],!0).name);return a(Z,(function(mt){if(mt._katavorioDrag){var wt=J(mt._katavorioDrag.posses,tt),Mt=[];Array.prototype.push.apply(Mt,mt._katavorioDrag.posses);for(var Ht=0;Ht<wt.length;Ht++)this.removeFromPosse(mt,wt[Ht])}}).bind(this)),tt.length===1?tt[0]:tt},this.removeFromPosse=function(Z,K){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var tt=1;tt<arguments.length;tt++)K=arguments[tt],a(Z,function(ht){if(ht._katavorioDrag&&ht._katavorioDrag.posses){var mt=ht._katavorioDrag;a(K,function(wt){V(_t[wt].members,mt),V(mt.posses,wt),delete mt.posseRoles[wt]})}})},this.removeFromAllPosses=function(Z){a(Z,function(K){if(K._katavorioDrag&&K._katavorioDrag.posses){var tt=K._katavorioDrag;a(tt.posses,function(ht){V(_t[ht].members,tt)}),tt.posses.length=0,tt.posseRoles={}}})},this.setPosseState=function(Z,K,tt){var ht=_t[K];ht&&a(Z,function(mt){mt._katavorioDrag&&mt._katavorioDrag.posses&&(mt._katavorioDrag.posseRoles[ht.name]=tt)})}},q.Katavorio.version="1.0.0",Rt.Katavorio=q.Katavorio}).call(typeof window<"u"?window:Ot),(function(){var q=this;q.jsPlumbUtil=q.jsPlumbUtil||{};var u=q.jsPlumbUtil;Rt.jsPlumbUtil=u;function V(i){return Object.prototype.toString.call(i)==="[object Array]"}u.isArray=V;function J(i){return Object.prototype.toString.call(i)==="[object Number]"}u.isNumber=J;function $(i){return typeof i=="string"}u.isString=$;function Q(i){return typeof i=="boolean"}u.isBoolean=Q;function h(i){return i==null}u.isNull=h;function M(i){return i==null?!1:Object.prototype.toString.call(i)==="[object Object]"}u.isObject=M;function o(i){return Object.prototype.toString.call(i)==="[object Date]"}u.isDate=o;function n(i){return Object.prototype.toString.call(i)==="[object Function]"}u.isFunction=n;function m(i){return n(i)&&i.name!=null&&i.name.length>0}u.isNamedFunction=m;function E(i){for(var l in i)if(i.hasOwnProperty(l))return!1;return!0}u.isEmpty=E;function D(i){if($(i))return""+i;if(Q(i))return!!i;if(o(i))return new Date(i.getTime());if(n(i))return i;if(V(i)){for(var l=[],t=0;t<i.length;t++)l.push(D(i[t]));return l}else if(M(i)){var g={};for(var y in i)g[y]=D(i[y]);return g}else return i}u.clone=D;function C(i,l,t,g){var y={},N,F,X={};for(t=t||[],g=g||[],F=0;F<t.length;F++)y[t[F]]=!0;for(F=0;F<g.length;F++)X[g[F]]=!0;var G=D(i);for(F in l)if(G[F]==null||X[F])G[F]=l[F];else if($(l[F])||Q(l[F]))y[F]?(N=[],N.push.apply(N,V(G[F])?G[F]:[G[F]]),N.push.apply(N,Q(l[F])?l[F]:[l[F]]),G[F]=N):G[F]=l[F];else if(V(l[F]))N=[],V(G[F])&&N.push.apply(N,G[F]),N.push.apply(N,l[F]),G[F]=N;else if(M(l[F])){M(G[F])||(G[F]={});for(var W in l[F])G[F][W]=l[F][W]}return G}u.merge=C;function d(i,l,t){if(i!=null){var g=i,y=g;return l.replace(/([^\.])+/g,function(N,F,X,G){var W=N.match(/([^\[0-9]+){1}(\[)([0-9+])/),at=X+N.length>=G.length,st=function(){return y[W[1]]||function(){return y[W[1]]=[],y[W[1]]}()};if(at)W?st()[W[3]]=t:y[N]=t;else if(W){var it=st();y=it[W[3]]||function(){return it[W[3]]={},it[W[3]]}()}else y=y[N]||function(){return y[N]={},y[N]}();return""}),i}}u.replace=d;function e(i,l,t){for(var g=0;g<t.length;g++){var y=t[g][0][t[g][1]].apply(t[g][0],t[g][2]);if(y===l)return y}return i}u.functionChain=e;function T(i,l,t,g){var y=function(F){var X=F.match(/(\${.*?})/g);if(X!=null)for(var G=0;G<X.length;G++){var W=l[X[G].substring(2,X[G].length-1)]||"";W!=null&&(F=F.replace(X[G],W))}return F},N=function(F){if(F!=null){if($(F))return y(F);if(n(F)&&!g&&(t==null||(F.name||"").indexOf(t)===0))return F(l);if(V(F)){for(var X=[],G=0;G<F.length;G++)X.push(N(F[G]));return X}else if(M(F)){var W={};for(var at in F)W[at]=N(F[at]);return W}else return F}};return N(i)}u.populate=T;function I(i,l){if(i){for(var t=0;t<i.length;t++)if(l(i[t]))return t}return-1}u.findWithFunction=I;function R(i,l){var t=I(i,l);return t>-1&&i.splice(t,1),t!==-1}u.removeWithFunction=R;function L(i,l){var t=i.indexOf(l);return t>-1&&i.splice(t,1),t!==-1}u.remove=L;function _(i,l,t){I(i,t)===-1&&i.push(l)}u.addWithFunction=_;function S(i,l,t,g){var y=i[l];return y==null&&(y=[],i[l]=y),y[g?"unshift":"push"](t),y}u.addToList=S;function s(i,l,t){return i.indexOf(l)===-1?(t?i.unshift(l):i.push(l),!0):!1}u.suggest=s;function f(i,l,t){var g;l=V(l)?l:[l];var y=function(G){for(var W=G.__proto__;W!=null;)if(W.prototype!=null){for(var at in W.prototype)W.prototype.hasOwnProperty(at)&&!i.prototype.hasOwnProperty(at)&&(i.prototype[at]=W.prototype[at]);W=W.prototype.__proto__}else W=null};for(g=0;g<l.length;g++){for(var N in l[g].prototype)l[g].prototype.hasOwnProperty(N)&&!i.prototype.hasOwnProperty(N)&&(i.prototype[N]=l[g].prototype[N]);y(l[g])}var F=function(G,W){return function(){for(g=0;g<l.length;g++)l[g].prototype[G]&&l[g].prototype[G].apply(this,arguments);return W.apply(this,arguments)}},X=function(G){for(var W in G)i.prototype[W]=F(W,G[W])};if(arguments.length>2)for(g=2;g<arguments.length;g++)X(arguments[g]);return i}u.extend=f;for(var a=[],P=0;P<256;P++)a[P]=(P<16?"0":"")+P.toString(16);function k(){var i=Math.random()*4294967295|0,l=Math.random()*4294967295|0,t=Math.random()*4294967295|0,g=Math.random()*4294967295|0;return a[i&255]+a[i>>8&255]+a[i>>16&255]+a[i>>24&255]+"-"+a[l&255]+a[l>>8&255]+"-"+a[l>>16&15|64]+a[l>>24&255]+"-"+a[t&63|128]+a[t>>8&255]+"-"+a[t>>16&255]+a[t>>24&255]+a[g&255]+a[g>>8&255]+a[g>>16&255]+a[g>>24&255]}u.uuid=k;function c(i){if(i==null)return null;for(var l=i.replace(/^\s\s*/,""),t=/\s/,g=l.length;t.test(l.charAt(--g)););return l.slice(0,g+1)}u.fastTrim=c;function j(i,l){i=i.length==null||typeof i=="string"?[i]:i;for(var t=0;t<i.length;t++)l(i[t])}u.each=j;function v(i,l){for(var t=[],g=0;g<i.length;g++)t.push(l(i[g]));return t}u.map=v;function w(i,l,t){t=t||"parent";var g=function(G){return G?l[G]:null},y=function(G){return G?g(G[t]):null},N=function(G,W){if(G==null)return W;var at=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];W.mergeStrategy==="override"&&Array.prototype.push.apply(at,["events","overlays"]);var st=C(G,W,[],at);return N(y(G),st)},F=function(G){if(G==null)return{};if(typeof G=="string")return g(G);if(G.length){for(var W=!1,at=0,st=void 0;!W&&at<G.length;)st=F(G[at]),st?W=!0:at++;return st}},X=F(i);return X?N(y(X),X):{}}u.mergeWithParents=w,u.logEnabled=!0;function p(){if(u.logEnabled&&typeof console<"u")try{var i=arguments[arguments.length-1];console.log(i)}catch{}}u.log=p;function x(i,l,t){return function(){var g=null;try{l!=null&&(g=l.apply(this,arguments))}catch(y){p("jsPlumb function failed : "+y)}if(i!=null&&(t==null||g!==t))try{g=i.apply(this,arguments)}catch(y){p("wrapped function failed : "+y)}return g}}u.wrap=x;var U=function(){function i(){var l=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(t,g,y){var N=function(X){S(l._listeners,X,g,y),g.__jsPlumb=g.__jsPlumb||{},g.__jsPlumb[k()]=X};if(typeof t=="string")N(t);else if(t.length!=null)for(var F=0;F<t.length;F++)N(t[F]);return l},this.fire=function(t,g,y){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[t]){var N=this._listeners[t].length,F=0,X=!1,G=null;if(!this.shouldFireEvent||this.shouldFireEvent(t,g,y))for(;!X&&F<N&&G!==!1;){if(this.eventsToDieOn[t])this._listeners[t][F].apply(this,[g,y]);else try{G=this._listeners[t][F].apply(this,[g,y])}catch(W){p("jsPlumb: fire failed for event "+t+" : "+W)}F++,(this._listeners==null||this._listeners[t]==null)&&(X=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var t=l.queue.pop();t&&l.fire.apply(l,t)},this.unbind=function(t,g){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof t=="string")delete this._listeners[t];else if(t.__jsPlumb){var y=void 0;for(var N in t.__jsPlumb)y=t.__jsPlumb[N],L(this._listeners[y]||[],t)}}else arguments.length===2&&L(this._listeners[t]||[],g);return this},this.getListener=function(t){return l._listeners[t]},this.setSuspendEvents=function(t){l.eventsSuspended=t},this.isSuspendEvents=function(){return l.eventsSuspended},this.silently=function(t){l.setSuspendEvents(!0);try{t()}catch(g){p("Cannot execute silent function "+g)}l.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var t in l._listeners)l._listeners[t]=null}}return i}();u.EventGenerator=U;function B(i,l,t){var g=[i[0]-l[0],i[1]-l[1]],y=Math.cos(t/360*Math.PI*2),N=Math.sin(t/360*Math.PI*2);return[g[0]*y-g[1]*N+l[0],g[1]*y+g[0]*N+l[1],y,N]}u.rotatePoint=B;function Y(i,l){var t=B(i,[0,0],l);return[Math.round(t[0]),Math.round(t[1])]}u.rotateAnchorOrientation=Y}).call(typeof window<"u"?window:Ot),(function(){var q=this;q.jsPlumbUtil.matchesSelector=function(u,V,J){J=J||u.parentNode;for(var $=J.querySelectorAll(V),Q=0;Q<$.length;Q++)if($[Q]===u)return!0;return!1},q.jsPlumbUtil.consume=function(u,V){u.stopPropagation?u.stopPropagation():u.returnValue=!1,!V&&u.preventDefault&&u.preventDefault()},q.jsPlumbUtil.sizeElement=function(u,V,J,$,Q){u&&(u.style.height=Q+"px",u.height=Q,u.style.width=$+"px",u.width=$,u.style.left=V+"px",u.style.top=J+"px")}}).call(typeof window<"u"?window:Ot),(function(){var q={deriveAnchor:function($,Q,h,M){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[$][Q]}},u=this,V=function($,Q){this.count=0,this.instance=$,this.lists={},this.options=Q||{},this.instance.addList=function(h,M){return this.listManager.addList(h,M)},this.instance.removeList=function(h){this.listManager.removeList(h)},this.instance.bind("manageElement",(function(h){for(var M=this.instance.getSelector(h.el,"[jtk-scrollable-list]"),o=0;o<M.length;o++)this.addList(M[o])}).bind(this)),this.instance.bind("unmanageElement",function(h){this.removeList(h.el)}),this.instance.bind("connection",(function(h,M){M==null&&(this._maybeUpdateParentList(h.source),this._maybeUpdateParentList(h.target))}).bind(this))};u.jsPlumbListManager=V,V.prototype={addList:function($,Q){var h=this.instance.extend({},q);this.instance.extend(h,this.options),Q=this.instance.extend(h,Q||{});var M=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[M]=new J(this.instance,$,Q,M)},removeList:function($){var Q=this.lists[$._jsPlumbList];Q&&(Q.destroy(),delete this.lists[$._jsPlumbList])},_maybeUpdateParentList:function($){for(var Q=$.parentNode,h=this.instance.getContainer();Q!=null&&Q!==h;){if(Q._jsPlumbList!=null&&this.lists[Q._jsPlumbList]!=null){Q._jsPlumbScrollHandler();return}Q=Q.parentNode}}};var J=function($,Q,h,M){Q._jsPlumbList=M;function o(D,C,d,e){return h.anchor?h.anchor:h.deriveAnchor(D,C,d,e)}function n(D,C,d,e){return h.deriveEndpoint?h.deriveEndpoint(D,C,d,e):h.endpoint?h.endpoint:d.type}function m(D){for(var C=D.parentNode,d=$.getContainer();C!=null&&C!==d;){if($.hasClass(C,"jtk-managed")){$.recalculateOffsets(C);return}C=C.parentNode}}var E=function(D){for(var C=$.getSelector(Q,".jtk-managed"),d=$.getId(Q),e=0;e<C.length;e++){if(C[e].offsetTop<Q.scrollTop)C[e]._jsPlumbProxies||(C[e]._jsPlumbProxies=C[e]._jsPlumbProxies||[],$.select({source:C[e]}).each(function(I){$.proxyConnection(I,0,Q,d,function(){return n("top",0,I.endpoints[0],I)},function(){return o("top",0,I.endpoints[0],I)}),C[e]._jsPlumbProxies.push([I,0])}),$.select({target:C[e]}).each(function(I){$.proxyConnection(I,1,Q,d,function(){return n("top",1,I.endpoints[1],I)},function(){return o("top",1,I.endpoints[1],I)}),C[e]._jsPlumbProxies.push([I,1])}));else if(C[e].offsetTop+C[e].offsetHeight>Q.scrollTop+Q.offsetHeight)C[e]._jsPlumbProxies||(C[e]._jsPlumbProxies=C[e]._jsPlumbProxies||[],$.select({source:C[e]}).each(function(I){$.proxyConnection(I,0,Q,d,function(){return n("bottom",0,I.endpoints[0],I)},function(){return o("bottom",0,I.endpoints[0],I)}),C[e]._jsPlumbProxies.push([I,0])}),$.select({target:C[e]}).each(function(I){$.proxyConnection(I,1,Q,d,function(){return n("bottom",1,I.endpoints[1],I)},function(){return o("bottom",1,I.endpoints[1],I)}),C[e]._jsPlumbProxies.push([I,1])}));else if(C[e]._jsPlumbProxies){for(var T=0;T<C[e]._jsPlumbProxies.length;T++)$.unproxyConnection(C[e]._jsPlumbProxies[T][0],C[e]._jsPlumbProxies[T][1],d);delete C[e]._jsPlumbProxies}$.revalidate(C[e])}m(Q)};$.setAttribute(Q,"jtk-scrollable-list","true"),Q._jsPlumbScrollHandler=E,$.on(Q,"scroll",E),E(),this.destroy=function(){$.off(Q,"scroll",E),delete Q._jsPlumbScrollHandler;for(var D=$.getSelector(Q,".jtk-managed"),C=$.getId(Q),d=0;d<D.length;d++)if(D[d]._jsPlumbProxies){for(var e=0;e<D[d]._jsPlumbProxies.length;e++)$.unproxyConnection(D[d]._jsPlumbProxies[e][0],D[d]._jsPlumbProxies[e][1],C);delete D[d]._jsPlumbProxies}}}}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumbUtil,V=function(d){if(d._jsPlumb.paintStyle&&d._jsPlumb.hoverPaintStyle){var e={};C.extend(e,d._jsPlumb.paintStyle),C.extend(e,d._jsPlumb.hoverPaintStyle),delete d._jsPlumb.hoverPaintStyle,e.gradient&&d._jsPlumb.paintStyle.fill&&delete e.gradient,d._jsPlumb.hoverPaintStyle=e}},J=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],$=function(d,e,T,I){var R=d.getAttachedElements();if(R)for(var L=0,_=R.length;L<_;L++)(!I||I!==R[L])&&R[L].setHover(e,!0,T)},Q=function(d){return d==null?null:d.split(" ")},h=function(d,e,T){for(var I in e)d[I]=T},M=function(d,e,T){if(d.getDefaultType){var I=d.getTypeDescriptor(),R={},L=d.getDefaultType(),_=u.merge({},L);h(R,L,"__default");for(var S=0,s=d._jsPlumb.types.length;S<s;S++){var f=d._jsPlumb.types[S];if(f!=="__default"){var a=d._jsPlumb.instance.getType(f,I);if(a!=null){var P=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],k=[];a.mergeStrategy==="override"?Array.prototype.push.apply(P,["events","overlays","cssClass"]):k.push("cssClass"),_=u.merge(_,a,k,P),h(R,a,f)}}}e&&(_=u.populate(_,e,"_")),d.applyType(_,T,R),T||d.repaint()}},o=q.jsPlumbUIComponent=function(d){u.EventGenerator.apply(this,arguments);var e=this,T=arguments,I=e.idPrefix,R=I+new Date().getTime();this._jsPlumb={instance:d._jsPlumb,parameters:d.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:d.beforeDetach,beforeDrop:d.beforeDrop,overlayPlacements:[],hoverClass:d.hoverClass||d._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(k,c,j){this._jsPlumb.typeCache[j]=this._jsPlumb.typeCache[j]||{},this._jsPlumb.typeCache[j][k]=c},this.getCachedTypeItem=function(k,c){return this._jsPlumb.typeCache[c]?this._jsPlumb.typeCache[c][k]:null},this.getId=function(){return R};var L=d.overlays||[],_={};if(this.defaultOverlayKeys){for(var S=0;S<this.defaultOverlayKeys.length;S++)Array.prototype.push.apply(L,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[S]]||[]);for(S=0;S<L.length;S++){var s=C.convertToFullOverlaySpec(L[S]);_[s[1].id]=s}}var f={overlays:_,parameters:d.parameters||{},scope:d.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return f},this.appendToDefaultType=function(k){for(var c in k)f[c]=k[c]},d.events)for(var a in d.events)e.bind(a,d.events[a]);this.clone=(function(){var k=Object.create(this.constructor.prototype);return this.constructor.apply(k,T),k}).bind(this),this.isDetachAllowed=function(k){var c=!0;if(this._jsPlumb.beforeDetach)try{c=this._jsPlumb.beforeDetach(k)}catch(j){u.log("jsPlumb: beforeDetach callback failed",j)}return c},this.isDropAllowed=function(k,c,j,v,w,p,x){var U=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:k,targetId:c,scope:j,connection:v,dropEndpoint:w,source:p,target:x});if(this._jsPlumb.beforeDrop)try{U=this._jsPlumb.beforeDrop({sourceId:k,targetId:c,scope:j,connection:v,dropEndpoint:w,source:p,target:x})}catch(B){u.log("jsPlumb: beforeDrop callback failed",B)}return U};var P=[];this.setListenerComponent=function(k){for(var c=0;c<P.length;c++)P[c][3]=k}},n=function(d,e){var T=d._jsPlumb.types[e],I=d._jsPlumb.instance.getType(T,d.getTypeDescriptor());I!=null&&I.cssClass&&d.canvas&&d._jsPlumb.instance.removeClass(d.canvas,I.cssClass)};u.extend(q.jsPlumbUIComponent,u.EventGenerator,{getParameter:function(d){return this._jsPlumb.parameters[d]},setParameter:function(d,e){this._jsPlumb.parameters[d]=e},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(d){this._jsPlumb.parameters=d},getClass:function(){return C.getClass(this.canvas)},hasClass:function(d){return C.hasClass(this.canvas,d)},addClass:function(d){C.addClass(this.canvas,d)},removeClass:function(d){C.removeClass(this.canvas,d)},updateClasses:function(d,e){C.updateClasses(this.canvas,d,e)},setType:function(d,e,T){this.clearTypes(),this._jsPlumb.types=Q(d)||[],M(this,e,T)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(d,e){M(this,d,e)},hasType:function(d){return this._jsPlumb.types.indexOf(d)!==-1},addType:function(d,e,T){var I=Q(d),R=!1;if(I!=null){for(var L=0,_=I.length;L<_;L++)this.hasType(I[L])||(this._jsPlumb.types.push(I[L]),R=!0);R&&M(this,e,T)}},removeType:function(d,e,T){var I=Q(d),R=!1,L=(function(s){var f=this._jsPlumb.types.indexOf(s);return f!==-1?(n(this,f),this._jsPlumb.types.splice(f,1),!0):!1}).bind(this);if(I!=null){for(var _=0,S=I.length;_<S;_++)R=L(I[_])||R;R&&M(this,e,T)}},clearTypes:function(d,e){for(var T=this._jsPlumb.types.length,I=0;I<T;I++)n(this,0),this._jsPlumb.types.splice(0,1);M(this,d,e)},toggleType:function(d,e,T){var I=Q(d);if(I!=null){for(var R=0,L=I.length;R<L;R++){var _=this._jsPlumb.types.indexOf(I[R]);_!==-1?(n(this,_),this._jsPlumb.types.splice(_,1)):this._jsPlumb.types.push(I[R])}M(this,e,T)}},applyType:function(d,e){if(this.setPaintStyle(d.paintStyle,e),this.setHoverPaintStyle(d.hoverPaintStyle,e),d.parameters)for(var T in d.parameters)this.setParameter(T,d.parameters[T]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(d,e){this._jsPlumb.paintStyle=d,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,V(this),e||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(d,e){this._jsPlumb.hoverPaintStyle=d,V(this),e||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(d){(d||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(d,e,T){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=d;var I=d?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[I](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[I](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=d?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(T=T||jsPlumbUtil.uuid(),this.repaint({timestamp:T,recalc:!1}))),this.getAttachedElements&&!e&&$(this,d,jsPlumbUtil.uuid(),this)}}});var m=0,E=function(){var d=m+1;return m++,d},D=q.jsPlumbInstance=function(d){this.version="2.15.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},ListStyle:{},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},d&&C.extend(this.Defaults,d),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},u.EventGenerator.apply(this);var e=this,T=E(),I=e.bind,R={},L=1,_=function(r){if(r==null)return null;if(r.nodeType===3||r.nodeType===8)return{el:r,text:!0};var A=e.getElement(r);return{el:A,id:u.isString(r)&&A==null?r:lt(A)}};this.getInstanceIndex=function(){return T},this.setZoom=function(r,A){return L=r,e.fire("zoom",L),A&&e.repaintEverything(),!0},this.getZoom=function(){return L};for(var S in this.Defaults)R[S]=this.Defaults[S];var s,f=[];this.unbindContainer=function(){if(s!=null&&f.length>0)for(var r=0;r<f.length;r++)e.off(s,f[r][0],f[r][1])},this.setContainer=function(r){this.unbindContainer(),r=this.getElement(r),this.select().each(function(ft){ft.moveParent(r)}),this.selectEndpoints().each(function(ft){ft.moveParent(r)});var A=s;s=r,f.length=0;for(var b={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},O=function(ft,ct,St){var bt=ct.srcElement||ct.target,xt=(bt&&bt.parentNode?bt.parentNode._jsPlumb:null)||(bt?bt._jsPlumb:null)||(bt&&bt.parentNode&&bt.parentNode.parentNode?bt.parentNode.parentNode._jsPlumb:null);if(xt){xt.fire(ft,xt,ct);var jt=St&&b[St+ft]||ft;e.fire(jt,xt.component||xt,ct)}},H=function(ft,ct,St){f.push([ft,St]),e.on(s,ft,ct,St)},z=function(ft){H(ft,".jtk-connector",function(ct){O(ft,ct)}),H(ft,".jtk-endpoint",function(ct){O(ft,ct,"endpoint")}),H(ft,".jtk-overlay",function(ct){O(ft,ct)})},nt=0;nt<J.length;nt++)z(J[nt]);for(var dt in v){var ot=v[dt].el;ot.parentNode===A&&(A.removeChild(ot),s.appendChild(ot))}},this.getContainer=function(){return s},this.bind=function(r,A){r==="ready"&&P?A():I.apply(e,[r,A])},e.importDefaults=function(r){for(var A in r)e.Defaults[A]=r[A];return r.Container&&e.setContainer(r.Container),e},e.restoreDefaults=function(){return e.Defaults=C.extend({},R),e};var a=null,P=!1,k=[],c={},j={},v={},w={},p={},x=!1,U=[],B=!1,Y=null,i=this.Defaults.Scope,l=1,t=function(){return""+l++},g=(function(r,A){s?s.appendChild(r):A?this.getElement(A).appendChild(r):this.appendToRoot(r)}).bind(this),y=function(r,A,b,O){var H={c:[],e:[]};if(!B&&(r=e.getElement(r),r!=null)){var z=lt(r),nt=r.querySelectorAll(".jtk-managed");b==null&&(b=jsPlumbUtil.uuid()),Tt({elId:z,offset:A,recalc:!1,timestamp:b});for(var dt=0;dt<nt.length;dt++)Tt({elId:nt[dt].getAttribute("id"),recalc:!0,timestamp:b});var ot=e.router.redraw(z,A,b,null,O);if(Array.prototype.push.apply(H.c,ot.c),Array.prototype.push.apply(H.e,ot.e),nt)for(var ft=0;ft<nt.length;ft++)ot=e.router.redraw(nt[ft].getAttribute("id"),null,b,null,O,!0),Array.prototype.push.apply(H.c,ot.c),Array.prototype.push.apply(H.e,ot.e)}return H},N=function(r){return j[r]},F=function(r,A){for(var b=r.scope.split(/\s/),O=A.scope.split(/\s/),H=0;H<b.length;H++)for(var z=0;z<O.length;z++)if(O[z]===b[H])return!0;return!1},X=function(r,A){var b=C.extend({},r);for(var O in A)A[O]&&(b[O]=A[O]);return b},G=(function(r,A){var b=C.extend({},r);if(A&&C.extend(b,A),b.source&&(b.source.endpoint?b.sourceEndpoint=b.source:b.source=e.getElement(b.source)),b.target&&(b.target.endpoint?b.targetEndpoint=b.target:b.target=e.getElement(b.target)),r.uuids&&(b.sourceEndpoint=N(r.uuids[0]),b.targetEndpoint=N(r.uuids[1])),b.sourceEndpoint&&b.sourceEndpoint.isFull()){u.log(e,"could not add connection; source endpoint is full");return}if(b.targetEndpoint&&b.targetEndpoint.isFull()){u.log(e,"could not add connection; target endpoint is full");return}if(!b.type&&b.sourceEndpoint&&(b.type=b.sourceEndpoint.connectionType),b.sourceEndpoint&&b.sourceEndpoint.connectorOverlays){b.overlays=b.overlays||[];for(var O=0,H=b.sourceEndpoint.connectorOverlays.length;O<H;O++)b.overlays.push(b.sourceEndpoint.connectorOverlays[O])}b.sourceEndpoint&&b.sourceEndpoint.scope&&(b.scope=b.sourceEndpoint.scope),!b["pointer-events"]&&b.sourceEndpoint&&b.sourceEndpoint.connectorPointerEvents&&(b["pointer-events"]=b.sourceEndpoint.connectorPointerEvents);var z=function(dt,ot,ft){var ct=X(ot,{anchor:b.anchors?b.anchors[ft]:b.anchor,endpoint:b.endpoints?b.endpoints[ft]:b.endpoint,paintStyle:b.endpointStyles?b.endpointStyles[ft]:b.endpointStyle,hoverPaintStyle:b.endpointHoverStyles?b.endpointHoverStyles[ft]:b.endpointHoverStyle});return e.addEndpoint(dt,ct)},nt=function(dt,ot,ft,ct){if(b[dt]&&!b[dt].endpoint&&!b[dt+"Endpoint"]&&!b.newConnection){var St=lt(b[dt]),bt=ft[St];if(bt=bt?bt[ct]:null,bt){if(!bt.enabled)return!1;var xt=C.extend({},bt.def);delete xt.label;var jt=bt.endpoint!=null&&bt.endpoint._jsPlumb?bt.endpoint:z(b[dt],xt,ot);if(jt.isFull())return!1;b[dt+"Endpoint"]=jt,!b.scope&&xt.scope&&(b.scope=xt.scope),bt.uniqueEndpoint?bt.endpoint?jt.finalEndpoint=bt.endpoint:(bt.endpoint=jt,jt.setDeleteOnEmpty(!1)):jt.setDeleteOnEmpty(!0),ot===0&&bt.def.connectorOverlays&&(b.overlays=b.overlays||[],Array.prototype.push.apply(b.overlays,bt.def.connectorOverlays))}}};if(nt("source",0,this.sourceEndpointDefinitions,b.type||"default")!==!1&&nt("target",1,this.targetEndpointDefinitions,b.type||"default")!==!1)return b.sourceEndpoint&&b.targetEndpoint&&(F(b.sourceEndpoint,b.targetEndpoint)||(b=null)),b}).bind(e),W=function(r){var A=e.Defaults.ConnectionType||e.getDefaultConnectionType();r._jsPlumb=e,r.newConnection=W,r.newEndpoint=st,r.endpointsByUUID=j,r.endpointsByElement=c,r.finaliseConnection=at,r.id="con_"+t();var b=new A(r);return b.isDetachable()&&(b.endpoints[0].initDraggable("_jsPlumbSource"),b.endpoints[1].initDraggable("_jsPlumbTarget")),b},at=e.finaliseConnection=function(r,A,b,O){if(A=A||{},r.suspendedEndpoint||k.push(r),r.pending=null,r.endpoints[0].isTemporarySource=!1,O!==!1&&e.router.newConnection(r),y(r.source),!A.doNotFireConnectionEvent&&A.fireEvent!==!1){var H={connection:r,source:r.source,target:r.target,sourceId:r.sourceId,targetId:r.targetId,sourceEndpoint:r.endpoints[0],targetEndpoint:r.endpoints[1]};e.fire("connection",H,b)}},st=function(r,A){var b=e.Defaults.EndpointType||C.Endpoint,O=C.extend({},r);O._jsPlumb=e,O.newConnection=W,O.newEndpoint=st,O.endpointsByUUID=j,O.endpointsByElement=c,O.fireDetachEvent=Z,O.elementId=A||lt(O.source);var H=new b(O);return H.id="ep_"+t(),he(O.elementId,O.source),C.headless||e.getDragManager().endpointAdded(O.source,A),H},it=function(r,A,b){var O=c[r];if(O&&O.length)for(var H=0,z=O.length;H<z;H++){for(var nt=0,dt=O[H].connections.length;nt<dt;nt++){var ot=A(O[H].connections[nt]);if(ot)return}b&&b(O[H])}},rt=function(r,A,b){A=A==="block";var O=null;b&&(O=function(z){z.setVisible(A,!0,!0)});var H=_(r);it(H.id,function(z){if(A&&b){var nt=z.sourceId===H.id?1:0;z.endpoints[nt].isVisible()&&z.setVisible(!0)}else z.setVisible(A)},O)},gt=function(r,A){var b=null;A&&(b=function(O){var H=O.isVisible();O.setVisible(!H)}),it(r,function(O){var H=O.isVisible();O.setVisible(!H)},b)},pt=function(r){var A=w[r];return A?{o:A,s:U[r]}:Tt({elId:r})},lt=function(r,A,b){if(u.isString(r))return r;if(r==null)return null;var O=e.getAttribute(r,"id");return(!O||O==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?O=A:(arguments.length===1||arguments.length===3&&!arguments[2])&&(O="jsPlumb_"+T+"_"+t()),b||e.setAttribute(r,"id",O)),O};this.setConnectionBeingDragged=function(r){x=r},this.isConnectionBeingDragged=function(){return x},this.getManagedElements=function(){return v},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(r,A,b){b=b||{};var O=C.extend({},b);C.extend(O,A),O.endpoint=O.endpoint||e.Defaults.Endpoint,O.paintStyle=O.paintStyle||e.Defaults.EndpointStyle;for(var H=[],z=u.isArray(r)||r.length!=null&&!u.isString(r)?r:[r],nt=0,dt=z.length;nt<dt;nt++){O.source=e.getElement(z[nt]),oe(O.source);var ot=lt(O.source),ft=st(O,ot),ct=he(ot,O.source,null,!B).info.o;u.addToList(c,ot,ft),B||ft.paint({anchorLoc:ft.anchor.compute({xy:[ct.left,ct.top],wh:U[ot],element:ft,timestamp:Y,rotation:this.getRotation(ot)}),timestamp:Y}),H.push(ft)}return H.length===1?H[0]:H},this.addEndpoints=function(r,A,b){for(var O=[],H=0,z=A.length;H<z;H++){var nt=e.addEndpoint(r,A[H],b);u.isArray(nt)?Array.prototype.push.apply(O,nt):O.push(nt)}return O},this.animate=function(r,A,b){if(!this.animationSupported)return!1;b=b||{};var O=e.getElement(r),H=lt(O),z=C.animEvents.step,nt=C.animEvents.complete;b[z]=u.wrap(b[z],function(){e.revalidate(H)}),b[nt]=u.wrap(b[nt],function(){e.revalidate(H)}),e.doAnimate(O,A,b)},this.checkCondition=function(r,A){var b=e.getListener(r),O=!0;if(b&&b.length>0){var H=Array.prototype.slice.call(arguments,1);try{for(var z=0,nt=b.length;z<nt;z++)O=O&&b[z].apply(b[z],H)}catch(dt){u.log(e,"cannot check condition ["+r+"]"+dt)}}return O},this.connect=function(r,A){var b=G(r,A),O;if(b){if(b.source==null&&b.sourceEndpoint==null){u.log("Cannot establish connection - source does not exist");return}if(b.target==null&&b.targetEndpoint==null){u.log("Cannot establish connection - target does not exist");return}oe(b.source),O=W(b),at(O,b)}return O};var _t=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],vt=(function(r,A,b,O){var H,z=_t[b],nt=r[z.elId];r[z.el];var dt,ot,ft=r.endpoints[b],ct={index:b,originalSourceId:b===0?nt:r.sourceId,newSourceId:r.sourceId,originalTargetId:b===1?nt:r.targetId,newTargetId:r.targetId,connection:r};if(A.constructor===C.Endpoint)H=A,H.addConnection(r),A=H.element;else if(dt=lt(A),ot=this[z.epDefs][dt],dt===r[z.elId])H=null;else if(ot)for(var St in ot){if(!ot[St].enabled)return;H=ot[St].endpoint!=null&&ot[St].endpoint._jsPlumb?ot[St].endpoint:this.addEndpoint(A,ot[St].def),ot[St].uniqueEndpoint&&(ot[St].endpoint=H),H.addConnection(r)}else H=r.makeEndpoint(b===0,A,dt);return H!=null&&(ft.detachFromConnection(r),r.endpoints[b]=H,r[z.el]=H.element,r[z.elId]=H.elementId,ct[b===0?"newSourceId":"newTargetId"]=H.elementId,K(ct),O||r.repaint()),ct.element=A,ct}).bind(this);this.setSource=function(r,A,b){var O=vt(r,A,0,b);this.router.sourceOrTargetChanged(O.originalSourceId,O.newSourceId,r,O.el,0)},this.setTarget=function(r,A,b){var O=vt(r,A,1,b);this.router.sourceOrTargetChanged(O.originalTargetId,O.newTargetId,r,O.el,1)},this.deleteEndpoint=function(r,A,b){var O=typeof r=="string"?j[r]:r;return O&&e.deleteObject({endpoint:O,dontUpdateHover:A,deleteAttachedObjects:b}),e},this.deleteEveryEndpoint=function(){var r=e.setSuspendDrawing(!0);for(var A in c){var b=c[A];if(b&&b.length)for(var O=0,H=b.length;O<H;O++)e.deleteEndpoint(b[O],!0)}c={},v={},j={},w={},p={},e.router.reset();var z=e.getDragManager();return z&&z.reset(),r||e.setSuspendDrawing(!1),e};var Z=function(r,A,b){var O=e.Defaults.ConnectionType||e.getDefaultConnectionType(),H=r.constructor===O,z=H?{connection:r,source:r.source,target:r.target,sourceId:r.sourceId,targetId:r.targetId,sourceEndpoint:r.endpoints[0],targetEndpoint:r.endpoints[1]}:r;A&&e.fire("connectionDetached",z,b),e.fire("internal.connectionDetached",z,b),e.router.connectionDetached(z)},K=e.fireMoveEvent=function(r,A){e.fire("connectionMoved",r,A)};this.unregisterEndpoint=function(r){r._jsPlumb.uuid&&(j[r._jsPlumb.uuid]=null),e.router.deleteEndpoint(r);for(var A in c){var b=c[A];if(b){for(var O=[],H=0,z=b.length;H<z;H++)b[H]!==r&&O.push(b[H]);c[A]=O}c[A].length<1&&delete c[A]}};var tt="isDetachAllowed",ht="beforeDetach",mt="checkCondition";this.deleteConnection=function(r,A){return r!=null&&(A=A||{},A.force||u.functionChain(!0,!1,[[r.endpoints[0],tt,[r]],[r.endpoints[1],tt,[r]],[r,tt,[r]],[e,mt,[ht,r]]]))?(r.setHover(!1),Z(r,!r.pending&&A.fireEvent!==!1,A.originalEvent),r.endpoints[0].detachFromConnection(r),r.endpoints[1].detachFromConnection(r),u.removeWithFunction(k,function(b){return r.id===b.id}),r.cleanup(),r.destroy(),!0):!1},this.deleteEveryConnection=function(r){r=r||{};var A=k.length,b=0;return e.batch(function(){for(var O=0;O<A;O++)b+=e.deleteConnection(k[0],r)?1:0}),b},this.deleteConnectionsForElement=function(r,A){A=A||{},r=e.getElement(r);var b=lt(r),O=c[b];if(O&&O.length)for(var H=0,z=O.length;H<z;H++)O[H].deleteEveryConnection(A);return e},this.deleteObject=function(r){var A={endpoints:{},connections:{},endpointCount:0,connectionCount:0},b=r.deleteAttachedObjects!==!1,O=function(ct){ct!=null&&A.connections[ct.id]==null&&(!r.dontUpdateHover&&ct._jsPlumb!=null&&ct.setHover(!1),A.connections[ct.id]=ct,A.connectionCount++)},H=function(ct){if(ct!=null&&A.endpoints[ct.id]==null&&(!r.dontUpdateHover&&ct._jsPlumb!=null&&ct.setHover(!1),A.endpoints[ct.id]=ct,A.endpointCount++,b))for(var St=0;St<ct.connections.length;St++){var bt=ct.connections[St];O(bt)}};r.connection?O(r.connection):H(r.endpoint);for(var z in A.connections){var nt=A.connections[z];if(nt._jsPlumb){u.removeWithFunction(k,function(ct){return nt.id===ct.id}),Z(nt,r.fireEvent===!1?!1:!nt.pending,r.originalEvent);var dt=r.deleteAttachedObjects==null?null:!r.deleteAttachedObjects;nt.endpoints[0].detachFromConnection(nt,null,dt),nt.endpoints[1].detachFromConnection(nt,null,dt),nt.cleanup(!0),nt.destroy(!0)}}for(var ot in A.endpoints){var ft=A.endpoints[ot];ft._jsPlumb&&(e.unregisterEndpoint(ft),ft.cleanup(!0),ft.destroy(!0))}return A};var wt=function(r,A,b,O){for(var H=0,z=r.length;H<z;H++)r[H][A].apply(r[H],b);return O(r)},Mt=function(r,A,b){for(var O=[],H=0,z=r.length;H<z;H++)O.push([r[H][A].apply(r[H],b),r[H]]);return O},Ht=function(r,A,b){return function(){return wt(r,A,arguments,b)}},Bt=function(r,A){return function(){return Mt(r,A,arguments)}},Xt=function(r,A){var b=[];if(r)if(typeof r=="string"){if(r==="*")return r;b.push(r)}else if(A)b=r;else if(r.length)for(var O=0,H=r.length;O<H;O++)b.push(_(r[O]).id);else b.push(_(r).id);return b},Wt=function(r,A,b){return r==="*"?!0:r.length>0?r.indexOf(A)!==-1:!b};this.getConnections=function(r,A){r?r.constructor===String&&(r={scope:r}):r={};for(var b=r.scope||e.getDefaultScope(),O=Xt(b,!0),H=Xt(r.source),z=Xt(r.target),nt=!A&&O.length>1?{}:[],dt=function(xt,jt){if(!A&&O.length>1){var Lt=nt[xt];Lt==null&&(Lt=nt[xt]=[]),Lt.push(jt)}else nt.push(jt)},ot=0,ft=k.length;ot<ft;ot++){var ct=k[ot],St=ct.proxies&&ct.proxies[0]?ct.proxies[0].originalEp.elementId:ct.sourceId,bt=ct.proxies&&ct.proxies[1]?ct.proxies[1].originalEp.elementId:ct.targetId;Wt(O,ct.scope)&&Wt(H,St)&&Wt(z,bt)&&dt(ct.scope,ct)}return nt};var ge=function(r,A){return function(b){for(var O=0,H=r.length;O<H;O++)b(r[O]);return A(r)}},ve=function(r){return function(A){return r[A]}},me=function(r,A){var b={length:r.length,each:ge(r,A),get:ve(r)},O=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],H=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],z,nt;for(z=0,nt=O.length;z<nt;z++)b[O[z]]=Ht(r,O[z],A);for(z=0,nt=H.length;z<nt;z++)b[H[z]]=Bt(r,H[z]);return b},zt=function(r){var A=me(r,zt);return C.extend(A,{setDetachable:Ht(r,"setDetachable",zt),setReattach:Ht(r,"setReattach",zt),setConnector:Ht(r,"setConnector",zt),delete:function(){for(var b=0,O=r.length;b<O;b++)e.deleteConnection(r[b])},isDetachable:Bt(r,"isDetachable"),isReattach:Bt(r,"isReattach")})},re=function(r){var A=me(r,re);return C.extend(A,{setEnabled:Ht(r,"setEnabled",re),setAnchor:Ht(r,"setAnchor",re),isEnabled:Bt(r,"isEnabled"),deleteEveryConnection:function(){for(var b=0,O=r.length;b<O;b++)r[b].deleteEveryConnection()},delete:function(){for(var b=0,O=r.length;b<O;b++)e.deleteEndpoint(r[b])}})};this.select=function(r){return r=r||{},r.scope=r.scope||"*",zt(r.connections||e.getConnections(r,!0))},this.selectEndpoints=function(r){r=r||{},r.scope=r.scope||"*";var A=!r.element&&!r.source&&!r.target,b=A?"*":Xt(r.element),O=A?"*":Xt(r.source),H=A?"*":Xt(r.target),z=Xt(r.scope,!0),nt=[];for(var dt in c){var ot=Wt(b,dt,!0),ft=Wt(O,dt,!0),ct=O!=="*",St=Wt(H,dt,!0),bt=H!=="*";if(ot||ft||St)t:for(var xt=0,jt=c[dt].length;xt<jt;xt++){var Lt=c[dt][xt];if(Wt(z,Lt.scope,!0)){var ye=ct&&O.length>0&&!Lt.isSource,be=bt&&H.length>0&&!Lt.isTarget;if(ye||be)continue t;nt.push(Lt)}}}return re(nt)},this.getAllConnections=function(){return k},this.getDefaultScope=function(){return i},this.getEndpoint=N,this.getEndpoints=function(r){return c[_(r).id]||[]},this.getDefaultEndpointType=function(){return C.Endpoint},this.getDefaultConnectionType=function(){return C.Connection},this.getId=lt,this.draw=y,this.info=_,this.appendElement=g;var qt=!1;this.isHoverSuspended=function(){return qt},this.setHoverSuspended=function(r){qt=r},this.hide=function(r,A){return rt(r,"none",A),e},this.idstamp=t;var oe=function(r){if(!s&&r){var A=e.getElement(r);A.offsetParent&&e.setContainer(A.offsetParent)}},ue=function(){e.Defaults.Container&&e.setContainer(e.Defaults.Container)},he=e.manage=function(r,A,b,O){return v[r]?O&&(v[r].info=Tt({elId:r,timestamp:Y,recalc:!0})):(v[r]={el:A,endpoints:[],connections:[],rotation:0},v[r].info=Tt({elId:r,timestamp:Y}),e.addClass(A,"jtk-managed"),b||e.fire("manageElement",{id:r,info:v[r].info,el:A})),v[r]};this.unmanage=function(r){if(v[r]){var A=v[r].el;e.removeClass(A,"jtk-managed"),delete v[r],e.fire("unmanageElement",{id:r,el:A})}},this.rotate=function(r,A,b){return v[r]&&(v[r].rotation=A,v[r].el.style.transform="rotate("+A+"deg)",v[r].el.style.transformOrigin="center center",b!==!0)?this.revalidate(r):{c:[],e:[]}},this.getRotation=function(r){return v[r]&&v[r].rotation||0};var Tt=function(r){var A=r.timestamp,b=r.recalc,O=r.offset,H=r.elId,z;return B&&!A&&(A=Y),!b&&A&&A===p[H]?{o:r.offset||w[H],s:U[H]}:(b||!O&&w[H]==null?(z=v[H]?v[H].el:null,z!=null&&(U[H]=e.getSize(z),w[H]=e.getOffset(z),p[H]=A)):(w[H]=O||w[H],U[H]==null&&(z=v[H].el,z!=null&&(U[H]=e.getSize(z))),p[H]=A),w[H]&&!w[H].right&&(w[H].right=w[H].left+U[H][0],w[H].bottom=w[H].top+U[H][1],w[H].width=U[H][0],w[H].height=U[H][1],w[H].centerx=w[H].left+w[H].width/2,w[H].centery=w[H].top+w[H].height/2),{o:w[H],s:U[H]})};this.updateOffset=Tt,this.init=(function(){P||(ue(),e.router=new q.jsPlumb.DefaultRouter(e),e.anchorManager=e.router.anchorManager,P=!0,e.fire("ready",e))}).bind(this),this.log=a,this.jsPlumbUIComponent=o,this.makeAnchor=function(){var r,A=function(nt,dt){if(q.jsPlumb.Anchors[nt])return new q.jsPlumb.Anchors[nt](dt);if(!e.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+nt+"'"}};if(arguments.length===0)return null;var b=arguments[0],O=arguments[1],H=null;if(b.compute&&b.getOrientation)return b;if(typeof b=="string")H=A(arguments[0],{elementId:O,jsPlumbInstance:e});else if(u.isArray(b))if(u.isArray(b[0])||u.isString(b[0]))b.length===2&&u.isObject(b[1])?u.isString(b[0])?(r=q.jsPlumb.extend({elementId:O,jsPlumbInstance:e},b[1]),H=A(b[0],r)):(r=q.jsPlumb.extend({elementId:O,jsPlumbInstance:e,anchors:b[0]},b[1]),H=new q.jsPlumb.DynamicAnchor(r)):H=new C.DynamicAnchor({anchors:b,selector:null,elementId:O,jsPlumbInstance:e});else{var z={x:b[0],y:b[1],orientation:b.length>=4?[b[2],b[3]]:[0,0],offsets:b.length>=6?[b[4],b[5]]:[0,0],elementId:O,jsPlumbInstance:e,cssClass:b.length===7?b[6]:null};H=new q.jsPlumb.Anchor(z),H.clone=function(){return new q.jsPlumb.Anchor(z)}}return H.id||(H.id="anchor_"+t()),H},this.makeAnchors=function(r,A,b){for(var O=[],H=0,z=r.length;H<z;H++)typeof r[H]=="string"?O.push(q.jsPlumb.Anchors[r[H]]({elementId:A,jsPlumbInstance:b})):u.isArray(r[H])&&O.push(e.makeAnchor(r[H],A,b));return O},this.makeDynamicAnchor=function(r,A){return new q.jsPlumb.DynamicAnchor({anchors:r,selector:A,elementId:null,jsPlumbInstance:e})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var $t=function(r,A,b,O,H){for(var z=r.target||r.srcElement,nt=!1,dt=O.getSelector(A,b),ot=0;ot<dt.length;ot++)if(dt[ot]===z){nt=!0;break}return H?!nt:nt},It=function(r,A,b,O,H){var z=new o(A),nt=A._jsPlumb.EndpointDropHandler({jsPlumb:e,enabled:function(){return r.def.enabled},isFull:function(){var ot=e.select({target:r.id}).length;return r.def.maxConnections>0&&ot>=r.def.maxConnections},element:r.el,elementId:r.id,isSource:O,isTarget:H,addClass:function(ot){e.addClass(r.el,ot)},removeClass:function(ot){e.removeClass(r.el,ot)},onDrop:function(ot){var ft=ot.endpoints[0];ft.anchor.locked=!1},isDropAllowed:function(){return z.isDropAllowed.apply(z,arguments)},isRedrop:function(ot){return ot.suspendedElement!=null&&ot.suspendedEndpoint!=null&&ot.suspendedEndpoint.element===r.el},getEndpoint:function(ot){var ft=r.def.endpoint;if(ft==null||ft._jsPlumb==null){var ct=e.deriveEndpointAndAnchorSpec(ot.getType().join(" "),!0),St=ct.endpoints?q.jsPlumb.extend(A,{endpoint:r.def.def.endpoint||ct.endpoints[1]}):A;ct.anchors&&(St=q.jsPlumb.extend(St,{anchor:r.def.def.anchor||ct.anchors[1]})),ft=e.addEndpoint(r.el,St),ft._mtNew=!0}if(A.uniqueEndpoint&&(r.def.endpoint=ft),ft.setDeleteOnEmpty(!0),ot.isDetachable()&&ft.initDraggable(),ft.anchor.positionFinder!=null){var bt=e.getUIPosition(arguments,e.getZoom()),xt=e.getOffset(r.el),jt=e.getSize(r.el),Lt=bt==null?[0,0]:ft.anchor.positionFinder(bt,xt,jt,ft.anchor.constructorParams);ft.anchor.x=Lt[0],ft.anchor.y=Lt[1]}return ft},maybeCleanup:function(ot){ot._mtNew&&ot.connections.length===0?e.deleteObject({endpoint:ot}):delete ot._mtNew}}),dt=q.jsPlumb.dragEvents.drop;return b.scope=b.scope||A.scope||e.Defaults.Scope,b[dt]=u.wrap(b[dt],nt,!0),b.rank=A.rank||0,H&&(b[q.jsPlumb.dragEvents.over]=function(){return!0}),A.allowLoopback===!1&&(b.canDrop=function(ot){var ft=ot.getDragElement()._jsPlumbRelatedElement;return ft!==r.el}),e.initDroppable(r.el,b,"internal"),nt};this.makeTarget=function(r,A,b){var O=q.jsPlumb.extend({_jsPlumb:this},b);q.jsPlumb.extend(O,A);for(var H=O.maxConnections||-1,z=(function(ft){var ct=_(ft),St=ct.id,bt=q.jsPlumb.extend({},O.dropOptions||{}),xt=O.connectionType||"default";this.targetEndpointDefinitions[St]=this.targetEndpointDefinitions[St]||{},oe(St),ct.el._isJsPlumbGroup&&bt.rank==null&&(bt.rank=-1);var jt={def:q.jsPlumb.extend({},O),uniqueEndpoint:O.uniqueEndpoint,maxConnections:H,enabled:!0};O.createEndpoint&&(jt.uniqueEndpoint=!0,jt.endpoint=e.addEndpoint(ft,jt.def),jt.endpoint.setDeleteOnEmpty(!1)),ct.def=jt,this.targetEndpointDefinitions[St][xt]=jt,It(ct,O,bt,O.isSource===!0,!0),ct.el._katavorioDrop[ct.el._katavorioDrop.length-1].targetDef=jt}).bind(this),nt=r.length&&r.constructor!==String?r:[r],dt=0,ot=nt.length;dt<ot;dt++)z(nt[dt]);return this},this.unmakeTarget=function(r,A){var b=_(r);return e.destroyDroppable(b.el,"internal"),A||delete this.targetEndpointDefinitions[b.id],this},this.makeSource=function(r,A,b){var O=q.jsPlumb.extend({_jsPlumb:this},b);q.jsPlumb.extend(O,A);var H=O.connectionType||"default",z=e.deriveEndpointAndAnchorSpec(H);O.endpoint=O.endpoint||z.endpoints[0],O.anchor=O.anchor||z.anchors[0];for(var nt=O.maxConnections||-1,dt=O.onMaxConnections,ot=(function(bt){var xt=bt.id,jt=this.getElement(bt.el);this.sourceEndpointDefinitions[xt]=this.sourceEndpointDefinitions[xt]||{},oe(xt);var Lt={def:q.jsPlumb.extend({},O),uniqueEndpoint:O.uniqueEndpoint,maxConnections:nt,enabled:!0};O.createEndpoint&&(Lt.uniqueEndpoint=!0,Lt.endpoint=e.addEndpoint(r,Lt.def),Lt.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[xt][H]=Lt,bt.def=Lt;var ye=q.jsPlumb.dragEvents.stop,be=q.jsPlumb.dragEvents.drag,Jt=q.jsPlumb.extend({},O.dragOptions||{}),je=Jt.drag,Te=Jt.stop,Ft=null,_e=!1;Jt.scope=Jt.scope||O.scope,Jt[be]=u.wrap(Jt[be],function(){je&&je.apply(this,arguments),_e=!1}),Jt[ye]=u.wrap(Jt[ye],(function(){if(Te&&Te.apply(this,arguments),this.currentlyDragging=!1,Ft._jsPlumb!=null){var Vt=O.anchor||this.Defaults.Anchor,Nt=Ft.anchor,Pe=Ft.connections[0],ne=this.makeAnchor(Vt,xt,this),ce=Ft.element;if(ne.positionFinder!=null){var Zt=e.getOffset(ce),ie=this.getSize(ce),Ce={left:Zt.left+Nt.x*ie[0],top:Zt.top+Nt.y*ie[1]},fe=ne.positionFinder(Ce,Zt,ie,ne.constructorParams);ne.x=fe[0],ne.y=fe[1]}Ft.setAnchor(ne,!0),Ft.repaint(),this.repaint(Ft.elementId),Pe!=null&&this.repaint(Pe.targetId)}}).bind(this));var Oe=(function(Vt){if(!(Vt.which===3||Vt.button===2)){xt=this.getId(this.getElement(bt.el));var Nt=this.sourceEndpointDefinitions[xt][H];if(Nt.enabled){if(O.filter){var Pe=u.isString(O.filter)?$t(Vt,bt.el,O.filter,this,O.filterExclude):O.filter(Vt,bt.el);if(Pe===!1)return}var ne=this.select({source:xt}).length;if(Nt.maxConnections>=0&&ne>=Nt.maxConnections)return dt&&dt({element:bt.el,maxConnections:nt},Vt),!1;var ce=q.jsPlumb.getPositionOnElement(Vt,jt,L),Zt={};q.jsPlumb.extend(Zt,Nt.def),Zt.isTemporarySource=!0,Zt.anchor=[ce[0],ce[1],0,0],Zt.dragOptions=Jt,Nt.def.scope&&(Zt.scope=Nt.def.scope),Ft=this.addEndpoint(xt,Zt),_e=!0,Ft.setDeleteOnEmpty(!0),Nt.uniqueEndpoint&&(Nt.endpoint?Ft.finalEndpoint=Nt.endpoint:(Nt.endpoint=Ft,Ft.setDeleteOnEmpty(!1)));var ie=function(){e.off(Ft.canvas,"mouseup",ie),e.off(bt.el,"mouseup",ie),_e&&(_e=!1,e.deleteEndpoint(Ft))};e.on(Ft.canvas,"mouseup",ie),e.on(bt.el,"mouseup",ie);var Ce={};if(Nt.def.extract)for(var fe in Nt.def.extract){var Me=(Vt.srcElement||Vt.target).getAttribute(fe);Me&&(Ce[Nt.def.extract[fe]]=Me)}e.trigger(Ft.canvas,"mousedown",Vt,Ce),u.consume(Vt)}}}).bind(this);this.on(bt.el,"mousedown",Oe),Lt.trigger=Oe,O.filter&&(u.isString(O.filter)||u.isFunction(O.filter))&&e.setDragFilter(bt.el,O.filter);var Ie=q.jsPlumb.extend({},O.dropOptions||{});It(bt,O,Ie,!0,O.isTarget===!0)}).bind(this),ft=r.length&&r.constructor!==String?r:[r],ct=0,St=ft.length;ct<St;ct++)ot(_(ft[ct]));return this},this.unmakeSource=function(r,A,b){var O=_(r);e.destroyDroppable(O.el,"internal");var H=this.sourceEndpointDefinitions[O.id];if(H){for(var z in H)if(A==null||A===z){var nt=H[z].trigger;nt&&e.off(O.el,"mousedown",nt),b||delete this.sourceEndpointDefinitions[O.id][z]}}return this},this.unmakeEverySource=function(){for(var r in this.sourceEndpointDefinitions)e.unmakeSource(r,null,!0);return this.sourceEndpointDefinitions={},this};var Kt=(function(r,A,b){A=u.isArray(A)?A:[A];var O=lt(r);b=b||"default";for(var H=0;H<A.length;H++){var z=this[A[H]][O];if(z&&z[b])return z[b].def.scope||this.Defaults.Scope}}).bind(this),ee=(function(r,A,b,O){b=u.isArray(b)?b:[b];var H=lt(r);O=O||"default";for(var z=0;z<b.length;z++){var nt=this[b[z]][H];nt&&nt[O]&&(nt[O].def.scope=A)}}).bind(this);this.getScope=function(r,A){return Kt(r,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(r){return Kt(r,"sourceEndpointDefinitions")},this.getTargetScope=function(r){return Kt(r,"targetEndpointDefinitions")},this.setScope=function(r,A,b){this.setSourceScope(r,A,b),this.setTargetScope(r,A,b)},this.setSourceScope=function(r,A,b){ee(r,A,"sourceEndpointDefinitions",b),this.setDragScope(r,A)},this.setTargetScope=function(r,A,b){ee(r,A,"targetEndpointDefinitions",b),this.setDropScope(r,A)},this.unmakeEveryTarget=function(){for(var r in this.targetEndpointDefinitions)e.unmakeTarget(r,!0);return this.targetEndpointDefinitions={},this};var et=(function(r,A,b,O,H){var z=r==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,nt,dt,ot;if(H=H||"default",A.length&&!u.isString(A)){nt=[];for(var ft=0,ct=A.length;ft<ct;ft++)dt=_(A[ft]),z[dt.id]&&z[dt.id][H]&&(nt[ft]=z[dt.id][H].enabled,ot=O?!nt[ft]:b,z[dt.id][H].enabled=ot,e[ot?"removeClass":"addClass"](dt.el,"jtk-"+r+"-disabled"))}else{dt=_(A);var St=dt.id;z[St]&&z[St][H]&&(nt=z[St][H].enabled,ot=O?!nt:b,z[St][H].enabled=ot,e[ot?"removeClass":"addClass"](dt.el,"jtk-"+r+"-disabled"))}return nt}).bind(this),Ct=(function(r,A){if(r!=null){if(u.isString(r)||!r.length)return A.apply(this,[r]);if(r.length)return A.apply(this,[r[0]])}}).bind(this);this.toggleSourceEnabled=function(r,A){return et("source",r,null,!0,A),this.isSourceEnabled(r,A)},this.setSourceEnabled=function(r,A,b){return et("source",r,A,null,b)},this.isSource=function(r,A){return A=A||"default",Ct(r,(function(b){var O=this.sourceEndpointDefinitions[_(b).id];return O!=null&&O[A]!=null}).bind(this))},this.isSourceEnabled=function(r,A){return A=A||"default",Ct(r,(function(b){var O=this.sourceEndpointDefinitions[_(b).id];return O&&O[A]&&O[A].enabled===!0}).bind(this))},this.toggleTargetEnabled=function(r,A){return et("target",r,null,!0,A),this.isTargetEnabled(r,A)},this.isTarget=function(r,A){return A=A||"default",Ct(r,(function(b){var O=this.targetEndpointDefinitions[_(b).id];return O!=null&&O[A]!=null}).bind(this))},this.isTargetEnabled=function(r,A){return A=A||"default",Ct(r,(function(b){var O=this.targetEndpointDefinitions[_(b).id];return O&&O[A]&&O[A].enabled===!0}).bind(this))},this.setTargetEnabled=function(r,A,b){return et("target",r,A,null,b)},this.ready=function(r){e.bind("ready",r)};var Et=function(r,A){if(typeof r=="object"&&r.length)for(var b=0,O=r.length;b<O;b++)A(r[b]);else A(r);return e};this.repaint=function(r,A,b){return Et(r,function(O){y(O,A,b)})},this.revalidate=function(r,A,b){var O=b?r:e.getId(r);e.updateOffset({elId:O,recalc:!0,timestamp:A});var H=e.getDragManager();return H&&H.updateOffsets(O),y(r,null,A)},this.repaintEverything=function(){var r=jsPlumbUtil.uuid(),A;for(A in c)e.updateOffset({elId:A,recalc:!0,timestamp:r});for(A in c)y(A,null,r);return this},this.removeAllEndpoints=function(r,A,b){b=b||[];var O=function(H){var z=_(H),nt=c[z.id],dt,ot;if(nt)for(b.push(z),dt=0,ot=nt.length;dt<ot;dt++)e.deleteEndpoint(nt[dt],!1);if(delete c[z.id],A&&z.el&&z.el.nodeType!==3&&z.el.nodeType!==8)for(dt=0,ot=z.el.childNodes.length;dt<ot;dt++)O(z.el.childNodes[dt])};return O(r),this};var Pt=function(r,A){e.removeAllEndpoints(r.id,!0,A);for(var b=e.getDragManager(),O=function(z){b&&b.elementRemoved(z.id),e.router.elementRemoved(z.id),e.isSource(z.el)&&e.unmakeSource(z.el),e.isTarget(z.el)&&e.unmakeTarget(z.el),e.destroyDraggable(z.el),e.destroyDroppable(z.el),delete e.floatingConnections[z.id],delete v[z.id],delete w[z.id],z.el&&(e.removeElement(z.el),z.el._jsPlumb=null)},H=1;H<A.length;H++)O(A[H]);O(r)};this.remove=function(r,A){var b=_(r),O=[];return b.text&&b.el.parentNode?b.el.parentNode.removeChild(b.el):b.id&&e.batch(function(){Pt(b,O)},A===!0),e},this.empty=function(r,A){var b=[],O=function(H,z){var nt=_(H);if(nt.text)nt.el.parentNode.removeChild(nt.el);else if(nt.el){for(;nt.el.childNodes.length>0;)O(nt.el.childNodes[0]);z||Pt(nt,b)}};return e.batch(function(){O(r,!0)},A===!1),e},this.reset=function(r){e.silently((function(){qt=!1,e.removeAllGroups(),e.removeGroupManager(),e.deleteEveryEndpoint(),r||e.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},k.length=0,this.doReset&&this.doReset()}).bind(this))},this.destroy=function(){this.reset(),s=null,f=null};var Dt=function(r){r.canvas&&r.canvas.parentNode&&r.canvas.parentNode.removeChild(r.canvas),r.cleanup(),r.destroy()};this.clear=function(){e.select().each(Dt),e.selectEndpoints().each(Dt),c={},j={}},this.setDefaultScope=function(r){return i=r,e},this.deriveEndpointAndAnchorSpec=function(r,A){for(var b=((A?"":"default ")+r).split(/[\s]/),O=null,H=null,z=null,nt=null,dt=0;dt<b.length;dt++){var ot=e.getType(b[dt],"connection");ot&&(ot.endpoints&&(O=ot.endpoints),ot.endpoint&&(H=ot.endpoint),ot.anchors&&(nt=ot.anchors),ot.anchor&&(z=ot.anchor))}return{endpoints:O||[H,H],anchors:nt||[z,z]}},this.setId=function(r,A,b){var O;u.isString(r)?O=r:(r=this.getElement(r),O=this.getId(r));var H=this.getConnections({source:O,scope:"*"},!0),z=this.getConnections({target:O,scope:"*"},!0);A=""+A,b?r=this.getElement(A):(r=this.getElement(O),this.setAttribute(r,"id",A)),c[A]=c[O]||[];for(var nt=0,dt=c[A].length;nt<dt;nt++)c[A][nt].setElementId(A),c[A][nt].setReferenceElement(r);delete c[O],this.sourceEndpointDefinitions[A]=this.sourceEndpointDefinitions[O],delete this.sourceEndpointDefinitions[O],this.targetEndpointDefinitions[A]=this.targetEndpointDefinitions[O],delete this.targetEndpointDefinitions[O],this.router.changeId(O,A);var ot=this.getDragManager();ot&&ot.changeId(O,A),v[A]=v[O],delete v[O];var ft=function(ct,St,bt){for(var xt=0,jt=ct.length;xt<jt;xt++)ct[xt].endpoints[St].setElementId(A),ct[xt].endpoints[St].setReferenceElement(r),ct[xt][bt+"Id"]=A,ct[xt][bt]=r};ft(H,0,"source"),ft(z,1,"target"),this.repaint(A)},this.setDebugLog=function(r){a=r},this.setSuspendDrawing=function(r,A){var b=B;return B=r,r?Y=new Date().getTime():Y=null,A&&this.repaintEverything(),b},this.isSuspendDrawing=function(){return B},this.getSuspendedAt=function(){return Y},this.batch=function(r,A){var b=this.isSuspendDrawing();b||this.setSuspendDrawing(!0);try{r()}catch(O){u.log("Function run while suspended failed",O)}b||this.setSuspendDrawing(!1,!A)},this.doWhileSuspended=this.batch,this.getCachedData=pt,this.show=function(r,A){return rt(r,"block",A),e},this.toggleVisible=gt,this.addListener=this.bind;var kt=[];this.registerFloatingConnection=function(r,A,b){kt[r.id]=A,u.addToList(c,r.id,b)},this.getFloatingConnectionFor=function(r){return kt[r]},this.listManager=new q.jsPlumbListManager(this,this.Defaults.ListStyle)};u.extend(q.jsPlumbInstance,u.EventGenerator,{setAttribute:function(d,e,T){this.setAttribute(d,e,T)},getAttribute:function(d,e){return this.getAttribute(q.jsPlumb.getElement(d),e)},convertToFullOverlaySpec:function(d){return u.isString(d)&&(d=[d,{}]),d[1].id=d[1].id||u.uuid(),d},registerConnectionType:function(d,e){if(this._connectionTypes[d]=q.jsPlumb.extend({},e),e.overlays){for(var T={},I=0;I<e.overlays.length;I++){var R=this.convertToFullOverlaySpec(e.overlays[I]);T[R[1].id]=R}this._connectionTypes[d].overlays=T}},registerConnectionTypes:function(d){for(var e in d)this.registerConnectionType(e,d[e])},registerEndpointType:function(d,e){if(this._endpointTypes[d]=q.jsPlumb.extend({},e),e.overlays){for(var T={},I=0;I<e.overlays.length;I++){var R=this.convertToFullOverlaySpec(e.overlays[I]);T[R[1].id]=R}this._endpointTypes[d].overlays=T}},registerEndpointTypes:function(d){for(var e in d)this.registerEndpointType(e,d[e])},getType:function(d,e){return e==="connection"?this._connectionTypes[d]:this._endpointTypes[d]},setIdChanged:function(d,e){this.setId(d,e,!0)},setParent:function(d,e){var T=this.getElement(d),I=this.getId(T),R=this.getElement(e),L=this.getId(R),_=this.getDragManager();T.parentNode.removeChild(T),R.appendChild(T),_&&_.setParent(T,I,R,L)},extend:function(d,e,T){var I;if(T)for(I=0;I<T.length;I++)d[T[I]]=e[T[I]];else for(I in e)d[I]=e[I];return d},floatingConnections:{},getFloatingAnchorIndex:function(d){return d.endpoints[0].isFloating()?0:d.endpoints[1].isFloating()?1:-1},proxyConnection:function(d,e,T,I,R,L){var _,S=d.endpoints[e].elementId,s=d.endpoints[e];d.proxies=d.proxies||[],d.proxies[e]?_=d.proxies[e].ep:_=this.addEndpoint(T,{endpoint:R(d,e),anchor:L(d,e),parameters:{isProxyEndpoint:!0}}),_.setDeleteOnEmpty(!0),d.proxies[e]={ep:_,originalEp:s},e===0?this.router.sourceOrTargetChanged(S,I,d,T,0):this.router.sourceOrTargetChanged(S,I,d,T,1),s.detachFromConnection(d,null,!0),_.connections=[d],d.endpoints[e]=_,s.setVisible(!1),d.setVisible(!0),this.revalidate(T)},unproxyConnection:function(d,e,T){if(!(d._jsPlumb==null||d.proxies==null||d.proxies[e]==null)){var I=d.proxies[e].originalEp.element,R=d.proxies[e].originalEp.elementId;d.endpoints[e]=d.proxies[e].originalEp,e===0?this.router.sourceOrTargetChanged(T,R,d,I,0):this.router.sourceOrTargetChanged(T,R,d,I,1),d.proxies[e].ep.detachFromConnection(d,null),d.proxies[e].originalEp.addConnection(d),d.isVisible()&&d.proxies[e].originalEp.setVisible(!0),delete d.proxies[e]}}});var C=new D;q.jsPlumb=C,C.getInstance=function(d,e){var T=new D(d);if(e)for(var I in e)T[I]=e[I];return T.init(),T},C.each=function(d,e){if(d!=null)if(typeof d=="string")e(C.getElement(d));else if(d.length!=null)for(var T=0;T<d.length;T++)e(C.getElement(d[T]));else e(d)},Rt.jsPlumb=C}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J="__label",$=function(h,M){var o={cssClass:M.cssClass,labelStyle:h.labelStyle,id:J,component:h,_jsPlumb:h._jsPlumb.instance},n=u.extend(o,M);return new u.Overlays[h._jsPlumb.instance.getRenderMode()].Label(n)},Q=function(h,M){var o=null;if(V.isArray(M)){var n=M[0],m=u.extend({component:h,_jsPlumb:h._jsPlumb.instance},M[1]);M.length===3&&u.extend(m,M[2]),o=new u.Overlays[h._jsPlumb.instance.getRenderMode()][n](m)}else M.constructor===String?o=new u.Overlays[h._jsPlumb.instance.getRenderMode()][M]({component:h,_jsPlumb:h._jsPlumb.instance}):o=M;return o.id=o.id||V.uuid(),h.cacheTypeItem("overlay",o,o.id),h._jsPlumb.overlays[o.id]=o,o};u.OverlayCapableJsPlumbUIComponent=function(h){q.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},h.label&&(this.getDefaultType().overlays[J]=["Label",{label:h.label,location:h.labelLocation||this.defaultLabelLocation||.5,labelStyle:h.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:J}]),this.setListenerComponent=function(M){if(this._jsPlumb)for(var o in this._jsPlumb.overlays)this._jsPlumb.overlays[o].setListenerComponent(M)}},u.OverlayCapableJsPlumbUIComponent.applyType=function(h,M){if(M.overlays){var o={},n;for(n in M.overlays){var m=h._jsPlumb.overlays[M.overlays[n][1].id];if(m)m.updateFrom(M.overlays[n][1]),o[M.overlays[n][1].id]=!0,m.reattach(h._jsPlumb.instance,h);else{var E=h.getCachedTypeItem("overlay",M.overlays[n][1].id);E!=null?(E.reattach(h._jsPlumb.instance,h),E.setVisible(!0),E.updateFrom(M.overlays[n][1]),h._jsPlumb.overlays[E.id]=E):E=h.addOverlay(M.overlays[n],!0),o[E.id]=!0}}for(n in h._jsPlumb.overlays)o[h._jsPlumb.overlays[n].id]==null&&h.removeOverlay(h._jsPlumb.overlays[n].id,!0)}},V.extend(u.OverlayCapableJsPlumbUIComponent,q.jsPlumbUIComponent,{setHover:function(h,M){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var o in this._jsPlumb.overlays)this._jsPlumb.overlays[o][h?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(h,M){var o=Q(this,h);if(this.getData&&o.type==="Label"&&V.isArray(h)){var n=this.getData(),m=h[1];if(n){var E=m.labelLocationAttribute||"labelLocation",D=n?n[E]:null;D&&(o.loc=D)}}return M||this.repaint(),o},getOverlay:function(h){return this._jsPlumb.overlays[h]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(h){var M=this.getOverlay(h);M&&M.hide()},hideOverlays:function(){for(var h in this._jsPlumb.overlays)this._jsPlumb.overlays[h].hide()},showOverlay:function(h){var M=this.getOverlay(h);M&&M.show()},showOverlays:function(){for(var h in this._jsPlumb.overlays)this._jsPlumb.overlays[h].show()},removeAllOverlays:function(h){for(var M in this._jsPlumb.overlays)this._jsPlumb.overlays[M].cleanup&&this._jsPlumb.overlays[M].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},h||this.repaint()},removeOverlay:function(h,M){var o=this._jsPlumb.overlays[h];o&&(o.setVisible(!1),!M&&o.cleanup&&o.cleanup(),delete this._jsPlumb.overlays[h],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[h],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[h])},removeOverlays:function(){for(var h=0,M=arguments.length;h<M;h++)this.removeOverlay(arguments[h])},moveParent:function(h){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),h.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),h.appendChild(this.canvas);for(var M in this._jsPlumb.overlays)if(this._jsPlumb.overlays[M].isAppendedAtTopLevel){var o=this._jsPlumb.overlays[M].getElement();o.parentNode.removeChild(o),h.appendChild(o)}}},getLabel:function(){var h=this.getOverlay(J);return h!=null?h.getLabel():null},getLabelOverlay:function(){return this.getOverlay(J)},setLabel:function(h){var M=this.getOverlay(J);if(M)h.constructor===String||h.constructor===Function?M.setLabel(h):(h.label&&M.setLabel(h.label),h.location&&M.setLocation(h.location));else{var o=h.constructor===String||h.constructor===Function?{label:h}:h;M=$(this,o),this._jsPlumb.overlays[J]=M}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(h){for(var M in this._jsPlumb.overlays)this._jsPlumb.overlays[M].cleanup(h),this._jsPlumb.overlays[M].destroy(h);h&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(h){this[h?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(h,M){this._jsPlumb.overlayPositions[h.id]=M},getAbsoluteOverlayPosition:function(h){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[h.id]:null},_clazzManip:function(h,M,o){if(!o)for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n][h+"Class"](M)},addClass:function(h,M){this._clazzManip("add",h,M)},removeClass:function(h,M){this._clazzManip("remove",h,M)}})}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J=function(o,n,m){var E=!1;return{drag:function(){if(E)return E=!1,!0;if(n.element){var D=m.getUIPosition(arguments,m.getZoom());D!=null&&m.setPosition(n.element,D),m.repaint(n.element,D),o.paint({anchorPoint:o.anchor.getCurrentLocation({element:o})})}},stopDrag:function(){E=!0}}},$=function(o,n,m,E){var D=n.createElement("div",{position:"absolute"});n.appendElement(D);var C=n.getId(D);n.setPosition(D,m),D.style.width=E[0]+"px",D.style.height=E[1]+"px",n.manage(C,D,!0),o.id=C,o.element=D},Q=function(o,n,m,E,D,C,d,e){var T=new u.FloatingAnchor({reference:n,referenceCanvas:E,jsPlumbInstance:C});return d({paintStyle:o,endpoint:m,anchor:T,source:D,scope:e})},h=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],M=function(o,n){var m=0;if(n!=null){for(var E=0;E<o.connections.length;E++)if(o.connections[E].sourceId===n||o.connections[E].targetId===n){m=E;break}}return o.connections[m]};u.Endpoint=function(o){var n=o._jsPlumb,m=o.newConnection,E=o.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],u.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:o.connectionType,maxConnections:o.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:o.maxConnections,paintStyle:o.endpointStyle||o.paintStyle||o.style||this._jsPlumb.instance.Defaults.EndpointStyle||u.Defaults.EndpointStyle,hoverPaintStyle:o.endpointHoverStyle||o.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||u.Defaults.EndpointHoverStyle,connectorStyle:o.connectorStyle,connectorHoverStyle:o.connectorHoverStyle,connectorClass:o.connectorClass,connectorHoverClass:o.connectorHoverClass,connectorOverlays:o.connectorOverlays,connector:o.connector,connectorTooltip:o.connectorTooltip}),this._jsPlumb.enabled=o.enabled!==!1,this._jsPlumb.visible=!0,this.element=u.getElement(o.source),this._jsPlumb.uuid=o.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(o.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=o.elementId,this.dragProxy=o.dragProxy,this._jsPlumb.connectionCost=o.connectionCost,this._jsPlumb.connectionsDirected=o.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var D=o.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(_){D=_};var C=(function(){var _=n.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var S=n.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(_),this.addClass(S),u.updateClasses(this.element,S,_)}).bind(this);this.prepareAnchor=function(_){var S=this._jsPlumb.instance.makeAnchor(_,this.elementId,n);return S.bind("anchorChanged",(function(s){this.fire("anchorChanged",{endpoint:this,anchor:s}),C()}).bind(this)),S},this.setPreparedAnchor=function(_,S){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=_,C(),S||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(_,S){var s=this.prepareAnchor(_);return this.setPreparedAnchor(s,S),this};var d=(function(_){if(this.connections.length>0)for(var S=0;S<this.connections.length;S++)this.connections[S].setHover(_,!1);else this.setHover(_)}).bind(this);this.bind("mouseover",function(){d(!0)}),this.bind("mouseout",function(){d(!1)}),o._transient||this._jsPlumb.instance.router.addEndpoint(this,this.elementId),this.prepareEndpoint=function(_,S){var s=function(P,k){var c=n.getRenderMode();if(u.Endpoints[c][P])return new u.Endpoints[c][P](k);if(!n.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+P+"'"}},f={_jsPlumb:this._jsPlumb.instance,cssClass:o.cssClass,container:o.container,tooltip:o.tooltip,connectorTooltip:o.connectorTooltip,endpoint:this},a;return V.isString(_)?a=s(_,f):V.isArray(_)?(f=V.merge(_[1],f),a=s(_[0],f)):a=_.clone(),a.clone=(function(){if(V.isString(_))return s(_,f);if(V.isArray(_))return f=V.merge(_[1],f),s(_[0],f)}).bind(this),a.typeId=S,a},this.setEndpoint=function(_,S){var s=this.prepareEndpoint(_);this.setPreparedEndpoint(s,!0)},this.setPreparedEndpoint=function(_,S){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=_,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},u.extend(this,o,h),this.isSource=o.isSource||!1,this.isTemporarySource=o.isTemporarySource||!1,this.isTarget=o.isTarget||!1,this.connections=o.connections||[],this.connectorPointerEvents=o["connector-pointer-events"],this.scope=o.scope||n.getDefaultScope(),this.timestamp=null,this.reattachConnections=o.reattach||n.Defaults.ReattachConnections,this.connectionsDetachable=n.Defaults.ConnectionsDetachable,(o.connectionsDetachable===!1||o.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=o.dragAllowedWhenFull!==!1,o.onMaxConnections&&this.bind("maxConnections",o.onMaxConnections),this.addConnection=function(_){this.connections.push(_),this[(this.connections.length>0?"add":"remove")+"Class"](n.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](n.endpointFullClass)},this.detachFromConnection=function(_,S,s){S=S??this.connections.indexOf(_),S>=0&&(this.connections.splice(S,1),this[(this.connections.length>0?"add":"remove")+"Class"](n.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](n.endpointFullClass)),!s&&D&&this.connections.length===0&&n.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:s!==!0})},this.deleteEveryConnection=function(_){for(var S=this.connections.length,s=0;s<S;s++)n.deleteConnection(this.connections[0],_)},this.detachFrom=function(_,S,s){for(var f=[],a=0;a<this.connections.length;a++)(this.connections[a].endpoints[1]===_||this.connections[a].endpoints[0]===_)&&f.push(this.connections[a]);for(var P=0,k=f.length;P<k;P++)n.deleteConnection(f[0]);return this},this.getElement=function(){return this.element},this.setElement=function(_){var S=this._jsPlumb.instance.getId(_),s=this.elementId;return V.removeWithFunction(o.endpointsByElement[this.elementId],(function(f){return f.id===this.id}).bind(this)),this.element=u.getElement(_),this.elementId=n.getId(this.element),n.router.rehomeEndpoint(this,s,this.element),n.dragManager.endpointAdded(this.element),V.addToList(o.endpointsByElement,S,this),this},this.makeInPlaceCopy=function(){var _=this.anchor.getCurrentLocation({element:this}),S=this.anchor.getOrientation(this),s=this.anchor.getCssClass(),f={bind:function(){},compute:function(){return[_[0],_[1]]},getCurrentLocation:function(){return[_[0],_[1]]},getOrientation:function(){return S},getCssClass:function(){return s}};return E({dropOptions:o.dropOptions,anchor:f,source:this.element,paintStyle:this.getPaintStyle(),endpoint:o.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(_){_=_||{};var S=_.timestamp,s=_.recalc!==!1;if(!S||this.timestamp!==S){var f=n.updateOffset({elId:this.elementId,timestamp:S}),a=_.offset?_.offset.o:f.o;if(a!=null){var P=_.anchorPoint,k=_.connectorPaintStyle;if(P==null){var c=_.dimensions||f.s,j={xy:[a.left,a.top],wh:c,element:this,timestamp:S};if(s&&this.anchor.isDynamic&&this.connections.length>0){var v=M(this,_.elementWithPrecedence),w=v.endpoints[0]===this?1:0,p=w===0?v.sourceId:v.targetId,x=n.getCachedData(p),U=x.o,B=x.s;j.index=w===0?1:0,j.connection=v,j.txy=[U.left,U.top],j.twh=B,j.tElement=v.endpoints[w],j.tRotation=n.getRotation(p)}else this.connections.length>0&&(j.connection=this.connections[0]);j.rotation=n.getRotation(this.elementId),P=this.anchor.compute(j)}this.endpoint.compute(P,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,k||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=S;for(var Y in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(Y)){var i=this._jsPlumb.overlays[Y];i.isVisible()&&(this._jsPlumb.overlayPlacements[Y]=i.draw(this.endpoint,this._jsPlumb.paintStyleInUse),i.paint(this._jsPlumb.overlayPlacements[Y]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var e=!1;this.initDraggable=function(){if(!e&&u.isDragSupported(this.element)){var _={id:null,element:null},S=null,s=!1,f=null,a=J(this,_,n),P=o.dragOptions||{},k={},c=u.dragEvents.start,j=u.dragEvents.stop,v=u.dragEvents.drag,w=u.dragEvents.beforeStart,p,x=function(Y){p=Y.e.payload||{}},U=(function(Y){S=this.connectorSelector();var i=!0;this.isEnabled()||(i=!1),S==null&&!this.isSource&&!this.isTemporarySource&&(i=!1),this.isSource&&this.isFull()&&!(S!=null&&this.dragAllowedWhenFull)&&(i=!1),S!=null&&!S.isDetachable(this)&&(this.isFull()?i=!1:S=null);var l=n.checkCondition(S==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:S});if(l===!1?i=!1:typeof l=="object"?u.extend(l,p||{}):l=p||{},i===!1)return n.stopDrag&&n.stopDrag(this.canvas),a.stopDrag(),!1;for(var t=0;t<this.connections.length;t++)this.connections[t].setHover(!1);this.addClass("endpointDrag"),n.setConnectionBeingDragged(!0),S&&!this.isFull()&&this.isSource&&(S=null),n.updateOffset({elId:this.elementId});var g=this._jsPlumb.instance.getOffset(this.canvas),y=this.canvas,N=this._jsPlumb.instance.getSize(this.canvas);$(_,n,g,N),n.setAttributes(this.canvas,{dragId:_.id,elId:this.elementId});var F=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var X=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);X.endpoints[1]&&(F=X.endpoints[1])}var G=this._jsPlumb.instance.makeAnchor("Center");G.isFloating=!0,this._jsPlumb.floatingEndpoint=Q(this.getPaintStyle(),G,F,this.canvas,_.element,n,E,this.scope);var W=this._jsPlumb.floatingEndpoint.anchor;if(S==null)this.setHover(!1,!1),S=m({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:_.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:o.connectorStyle,hoverPaintStyle:o.connectorHoverStyle,connector:o.connector,overlays:o.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:o.scope,data:l}),S.pending=!0,S.addClass(n.draggingClass),this._jsPlumb.floatingEndpoint.addClass(n.draggingClass),this._jsPlumb.floatingEndpoint.anchor=W,n.fire("connectionDrag",S),n.router.newConnection(S);else{s=!0,S.setHover(!1);var at=S.endpoints[0].id===this.id?0:1;this.detachFromConnection(S,null,!0);var st=n.getDragScope(y);n.setAttribute(this.canvas,"originalScope",st),n.fire("connectionDrag",S),at===0?(f=[S.source,S.sourceId,y,st],n.router.sourceOrTargetChanged(S.endpoints[at].elementId,_.id,S,_.element,0)):(f=[S.target,S.targetId,y,st],n.router.sourceOrTargetChanged(S.endpoints[at].elementId,_.id,S,_.element,1)),S.suspendedEndpoint=S.endpoints[at],S.suspendedElement=S.endpoints[at].getElement(),S.suspendedElementId=S.endpoints[at].elementId,S.suspendedElementType=at===0?"source":"target",S.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=S.suspendedEndpoint,S.endpoints[at]=this._jsPlumb.floatingEndpoint,S.addClass(n.draggingClass),this._jsPlumb.floatingEndpoint.addClass(n.draggingClass)}n.registerFloatingConnection(_,S,this._jsPlumb.floatingEndpoint),n.currentlyDragging=!0}).bind(this),B=(function(){if(n.setConnectionBeingDragged(!1),S&&S.endpoints!=null){var Y=n.getDropEvent(arguments),i=n.getFloatingAnchorIndex(S);if(S.endpoints[i===0?1:0].anchor.locked=!1,S.removeClass(n.draggingClass),this._jsPlumb&&(S.deleteConnectionNow||S.endpoints[i]===this._jsPlumb.floatingEndpoint)&&s&&S.suspendedEndpoint){i===0?(S.floatingElement=S.source,S.floatingId=S.sourceId,S.floatingEndpoint=S.endpoints[0],S.floatingIndex=0,S.source=f[0],S.sourceId=f[1]):(S.floatingElement=S.target,S.floatingId=S.targetId,S.floatingEndpoint=S.endpoints[1],S.floatingIndex=1,S.target=f[0],S.targetId=f[1]);var l=this._jsPlumb.floatingEndpoint;n.setDragScope(f[2],f[3]),S.endpoints[i]=S.suspendedEndpoint,S.isReattach()||S._forceReattach||S._forceDetach||!n.deleteConnection(S,{originalEvent:Y})?(S.setHover(!1),S._forceDetach=null,S._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(S),S.suspendedEndpoint.addConnection(S),i===1?n.router.sourceOrTargetChanged(S.floatingId,S.targetId,S,S.target,i):n.router.sourceOrTargetChanged(S.floatingId,S.sourceId,S,S.source,i),n.repaint(f[1])):n.deleteObject({endpoint:l})}this.deleteAfterDragStop?n.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),n.fire("connectionDragStop",S,Y),S.pending&&n.fire("connectionAborted",S,Y),n.currentlyDragging=!1,S.suspendedElement=null,S.suspendedEndpoint=null,S=null}_&&_.element&&n.remove(_.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}).bind(this);P=u.extend(k,P),P.scope=this.scope||P.scope,P[w]=V.wrap(P[w],x,!1),P[c]=V.wrap(P[c],U,!1),P[v]=V.wrap(P[v],a.drag),P[j]=V.wrap(P[j],B),P.multipleDrop=!1,P.canDrag=(function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}).bind(this),n.initDraggable(this.canvas,P,"internal"),this.canvas._jsPlumbRelatedElement=this.element,e=!0}};var T=o.endpoint||this._jsPlumb.instance.Defaults.Endpoint||u.Defaults.Endpoint;this.setEndpoint(T,!0);var I=o.anchor?o.anchor:o.anchors?o.anchors:n.Defaults.Anchor||"Top";this.setAnchor(I,!0);var R=["default",o.type||""].join(" ");this.addType(R,o.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var L=(function(_,S,s,f){if(u.isDropSupported(this.element)){var a=o.dropOptions||n.Defaults.DropOptions||u.Defaults.DropOptions;a=u.extend({},a),a.scope=a.scope||this.scope;var P=u.dragEvents.drop,k=u.dragEvents.over,c=u.dragEvents.out,j=this,v=n.EndpointDropHandler({getEndpoint:function(){return j},jsPlumb:n,enabled:function(){return s!=null?s.isEnabled():!0},isFull:function(){return s.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(w){j.addClass(w)},removeClass:function(w){j.removeClass(w)},isDropAllowed:function(){return j.isDropAllowed.apply(j,arguments)},reference:f,isRedrop:function(w,p){return w.suspendedEndpoint&&p.reference&&w.suspendedEndpoint.id===p.reference.id}});a[P]=V.wrap(a[P],v,!0),a[k]=V.wrap(a[k],(function(){var w=u.getDragObject(arguments),p=n.getAttribute(u.getElement(w),"dragId"),x=n.getFloatingConnectionFor(p);if(x!=null){var U=n.getFloatingAnchorIndex(x),B=this.isTarget&&U!==0||x.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===x.suspendedEndpoint.id;if(B){var Y=n.checkCondition("checkDropAllowed",{sourceEndpoint:x.endpoints[U],targetEndpoint:this,connection:x});this[(Y?"add":"remove")+"Class"](n.endpointDropAllowedClass),this[(Y?"remove":"add")+"Class"](n.endpointDropForbiddenClass),x.endpoints[U].anchor.over(this.anchor,this)}}}).bind(this)),a[c]=V.wrap(a[c],(function(){var w=u.getDragObject(arguments),p=w==null?null:n.getAttribute(u.getElement(w),"dragId"),x=p?n.getFloatingConnectionFor(p):null;if(x!=null){var U=n.getFloatingAnchorIndex(x),B=this.isTarget&&U!==0||x.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===x.suspendedEndpoint.id;B&&(this.removeClass(n.endpointDropAllowedClass),this.removeClass(n.endpointDropForbiddenClass),x.endpoints[U].anchor.out())}}).bind(this)),n.initDroppable(_,a,"internal",S)}}).bind(this);return this.anchor.isFloating||L(this.canvas,!(o._transient||this.anchor.isFloating),this,o.reference),this},V.extend(u.Endpoint,u.OverlayCapableJsPlumbUIComponent,{setVisible:function(o,n,m){if(this._jsPlumb.visible=o,this.canvas&&(this.canvas.style.display=o?"block":"none"),this[o?"showOverlays":"hideOverlays"](),!n){for(var E=0;E<this.connections.length;E++)if(this.connections[E].setVisible(o),!m){var D=this===this.connections[E].endpoints[0]?1:0;this.connections[E].endpoints[D].connections.length===1&&this.connections[E].endpoints[D].setVisible(o,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(o,n){this.setPaintStyle(o.endpointStyle||o.paintStyle,n),this.setHoverPaintStyle(o.endpointHoverStyle||o.hoverPaintStyle,n),o.maxConnections!=null&&(this._jsPlumb.maxConnections=o.maxConnections),o.scope&&(this.scope=o.scope),u.extend(this,o,h),o.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,o.cssClass),u.OverlayCapableJsPlumbUIComponent.applyType(this,o)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(o){this._jsPlumb.enabled=o},cleanup:function(){var o=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");u.removeClass(this.element,o),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(o){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(o)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(o){var n=!1;if(o){for(var m=0;m<this.connections.length;m++)if(this.connections[m].endpoints[1]===o||this.connections[m].endpoints[0]===o){n=!0;break}}return n},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(o){this._jsPlumb.connectionCost=o},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(o){this._jsPlumb.connectionsDirected=o},setElementId:function(o){this.elementId=o,this.anchor.elementId=o},setReferenceElement:function(o){this.element=u.getElement(o)},setDragAllowedWhenFull:function(o){this.dragAllowedWhenFull=o},equals:function(o){return this.anchor.equals(o.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(o){return this.anchor.compute(o)}}),q.jsPlumbInstance.prototype.EndpointDropHandler=function(o){return function(n){var m=o.jsPlumb;o.removeClass(m.endpointDropAllowedClass),o.removeClass(m.endpointDropForbiddenClass);var E=m.getDropEvent(arguments),D=m.getDragObject(arguments),C=m.getAttribute(D,"dragId");m.getAttribute(D,"elId");var d=m.getAttribute(D,"originalScope"),e=m.getFloatingConnectionFor(C);if(e!=null){var T=e.suspendedEndpoint!=null;if(!(T&&e.suspendedEndpoint._jsPlumb==null)){var I=o.getEndpoint(e);if(I!=null){if(o.isRedrop(e,o)){e._forceReattach=!0,e.setHover(!1),o.maybeCleanup&&o.maybeCleanup(I);return}var R=m.getFloatingAnchorIndex(e);if(R===0&&!o.isSource||R===1&&!o.isTarget){o.maybeCleanup&&o.maybeCleanup(I);return}o.onDrop&&o.onDrop(e),d&&m.setDragScope(D,d);var L=o.isFull(n);if(L&&I.fire("maxConnections",{endpoint:this,connection:e,maxConnections:I._jsPlumb.maxConnections},E),!L&&o.enabled()){var _=!0;R===0?(e.floatingElement=e.source,e.floatingId=e.sourceId,e.floatingEndpoint=e.endpoints[0],e.floatingIndex=0,e.source=o.element,e.sourceId=m.getId(o.element)):(e.floatingElement=e.target,e.floatingId=e.targetId,e.floatingEndpoint=e.endpoints[1],e.floatingIndex=1,e.target=o.element,e.targetId=m.getId(o.element)),T&&e.suspendedEndpoint.id!==I.id&&(!e.isDetachAllowed(e)||!e.endpoints[R].isDetachAllowed(e)||!e.suspendedEndpoint.isDetachAllowed(e)||!m.checkCondition("beforeDetach",e))&&(_=!1);var S=(function(f){e.endpoints[R].detachFromConnection(e),e.suspendedEndpoint&&e.suspendedEndpoint.detachFromConnection(e),e.endpoints[R]=I,I.addConnection(e);var a=I.getParameters();for(var P in a)e.setParameter(P,a[P]);if(!T)a.draggable&&m.initDraggable(this.element,o.dragOptions,"internal",m);else{var k=e.suspendedEndpoint.elementId;m.fireMoveEvent({index:R,originalSourceId:R===0?k:e.sourceId,newSourceId:R===0?I.elementId:e.sourceId,originalTargetId:R===1?k:e.targetId,newTargetId:R===1?I.elementId:e.targetId,originalSourceEndpoint:R===0?e.suspendedEndpoint:e.endpoints[0],newSourceEndpoint:R===0?I:e.endpoints[0],originalTargetEndpoint:R===1?e.suspendedEndpoint:e.endpoints[1],newTargetEndpoint:R===1?I:e.endpoints[1],connection:e},E)}if(R===1?m.router.sourceOrTargetChanged(e.floatingId,e.targetId,e,e.target,1):m.router.sourceOrTargetChanged(e.floatingId,e.sourceId,e,e.source,0),e.endpoints[0].finalEndpoint){var c=e.endpoints[0];c.detachFromConnection(e),e.endpoints[0]=e.endpoints[0].finalEndpoint,e.endpoints[0].addConnection(e)}V.isObject(f)&&e.mergeData(f),m.finaliseConnection(e,null,E,!1),e.setHover(!1),m.revalidate(e.endpoints[0].element)}).bind(this),s=function(){e.suspendedEndpoint&&(e.endpoints[R]=e.suspendedEndpoint,e.setHover(!1),e._forceDetach=!0,R===0?(e.source=e.suspendedEndpoint.element,e.sourceId=e.suspendedEndpoint.elementId):(e.target=e.suspendedEndpoint.element,e.targetId=e.suspendedEndpoint.elementId),e.suspendedEndpoint.addConnection(e),R===1?m.router.sourceOrTargetChanged(e.floatingId,e.targetId,e,e.target,1):m.router.sourceOrTargetChanged(e.floatingId,e.sourceId,e,e.source,0),m.repaint(e.sourceId),e._forceDetach=!1)};if(_=_&&o.isDropAllowed(e.sourceId,e.targetId,e.scope,e,I),_)return S(_),!0;s()}o.maybeCleanup&&o.maybeCleanup(I),m.currentlyDragging=!1}}}}}}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J=function(h,M,o,n,m){if(u.Connectors[M]=u.Connectors[M]||{},u.Connectors[M][o]==null){if(u.Connectors[o]==null){if(h.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+o+"'")}u.Connectors[M][o]=function(){u.Connectors[o].apply(this,arguments),u.ConnectorRenderers[M].apply(this,arguments)},V.extend(u.Connectors[M][o],[u.Connectors[o],u.ConnectorRenderers[M]])}return new u.Connectors[M][o](n,m)},$=function(h,M,o){return h?o.makeAnchor(h,M,o):null},Q=function(h,M,o,n){M!=null&&(M._jsPlumbConnections=M._jsPlumbConnections||{},n?delete M._jsPlumbConnections[h.id]:M._jsPlumbConnections[h.id]=!0,V.isEmpty(M._jsPlumbConnections)?o.removeClass(M,o.connectedClass):o.addClass(M,o.connectedClass))};u.Connection=function(h){var M=h.newEndpoint;this.id=h.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=h.previousConnection,this.source=u.getElement(h.source),this.target=u.getElement(h.target),u.OverlayCapableJsPlumbUIComponent.apply(this,arguments),h.sourceEndpoint?(this.source=h.sourceEndpoint.getElement(),this.sourceId=h.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),h.targetEndpoint?(this.target=h.targetEndpoint.getElement(),this.targetId=h.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=h.scope,this.endpoints=[],this.endpointStyles=[];var o=this._jsPlumb.instance;o.manage(this.sourceId,this.source),o.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:h.cssClass,container:h.container,"pointer-events":h["pointer-events"],editorParams:h.editorParams,overlays:h.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",(function(){this.setHover(!0)}).bind(this)),this.bind("mouseout",(function(){this.setHover(!1)}).bind(this)),this.makeEndpoint=function(P,k,c,j,v){return c=c||this._jsPlumb.instance.getId(k),this.prepareEndpoint(o,M,this,j,P?0:1,h,k,c,v)},h.type&&(h.endpoints=h.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(h.type).endpoints);var n=this.makeEndpoint(!0,this.source,this.sourceId,h.sourceEndpoint),m=this.makeEndpoint(!1,this.target,this.targetId,h.targetEndpoint);n&&V.addToList(h.endpointsByElement,this.sourceId,n),m&&V.addToList(h.endpointsByElement,this.targetId,m),this.scope||(this.scope=this.endpoints[0].scope),h.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(h.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(h.deleteEndpointsOnEmpty));var E=o.Defaults.ConnectionsDetachable;h.detachable===!1&&(E=!1),this.endpoints[0].connectionsDetachable===!1&&(E=!1),this.endpoints[1].connectionsDetachable===!1&&(E=!1);var D=h.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||o.Defaults.ReattachConnections;this.appendToDefaultType({detachable:E,reattach:D,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||h.paintStyle||o.Defaults.PaintStyle||u.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||h.hoverPaintStyle||o.Defaults.HoverPaintStyle||u.Defaults.HoverPaintStyle});var C=o.getSuspendedAt();if(!o.isSuspendDrawing()){var d=o.getCachedData(this.sourceId),e=d.o,T=d.s,I=o.getCachedData(this.targetId),R=I.o,L=I.s,_=C||jsPlumbUtil.uuid(),S=this.endpoints[0].anchor.compute({xy:[e.left,e.top],wh:T,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[R.left,R.top],twh:L,tElement:this.endpoints[1],timestamp:_,rotation:o.getRotation(this.endpoints[0].elementId)});this.endpoints[0].paint({anchorLoc:S,timestamp:_}),S=this.endpoints[1].anchor.compute({xy:[R.left,R.top],wh:L,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[e.left,e.top],twh:T,tElement:this.endpoints[0],timestamp:_,rotation:o.getRotation(this.endpoints[1].elementId)}),this.endpoints[1].paint({anchorLoc:S,timestamp:_})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(P){return this._jsPlumb.detachable===!1?!1:P!=null?P.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(P){this._jsPlumb.detachable=P===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(P){this._jsPlumb.reattach=P===!0},this._jsPlumb.cost=h.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=h.directed,h.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var s=u.extend({},this.endpoints[1].getParameters());u.extend(s,this.endpoints[0].getParameters()),u.extend(s,this.getParameters()),this.setParameters(s),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||h.connector||o.Defaults.Connector||u.Defaults.Connector,!0);var f=h.data==null||!V.isObject(h.data)?{}:h.data;this.getData=function(){return f},this.setData=function(P){f=P||{}},this.mergeData=function(P){f=u.extend(f,P)};var a=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,h.type].join(" ");/[^\s]/.test(a)&&this.addType(a,h.data,!0),this.updateConnectedClass()},V.extend(u.Connection,u.OverlayCapableJsPlumbUIComponent,{applyType:function(h,M,o){var n=null;h.connector!=null&&(n=this.getCachedTypeItem("connector",o.connector),n==null&&(n=this.prepareConnector(h.connector,o.connector),this.cacheTypeItem("connector",n,o.connector)),this.setPreparedConnector(n)),h.detachable!=null&&this.setDetachable(h.detachable),h.reattach!=null&&this.setReattach(h.reattach),h.scope&&(this.scope=h.scope),h.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,h.cssClass);var m=null;h.anchor?(m=this.getCachedTypeItem("anchors",o.anchor),m==null&&(m=[this._jsPlumb.instance.makeAnchor(h.anchor),this._jsPlumb.instance.makeAnchor(h.anchor)],this.cacheTypeItem("anchors",m,o.anchor))):h.anchors&&(m=this.getCachedTypeItem("anchors",o.anchors),m==null&&(m=[this._jsPlumb.instance.makeAnchor(h.anchors[0]),this._jsPlumb.instance.makeAnchor(h.anchors[1])],this.cacheTypeItem("anchors",m,o.anchors))),m!=null&&(this.endpoints[0].anchor=m[0],this.endpoints[1].anchor=m[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),u.OverlayCapableJsPlumbUIComponent.applyType(this,h)},addClass:function(h,M){M&&(this.endpoints[0].addClass(h),this.endpoints[1].addClass(h),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(h)),this.connector&&this.connector.addClass(h)},removeClass:function(h,M){M&&(this.endpoints[0].removeClass(h),this.endpoints[1].removeClass(h),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(h)),this.connector&&this.connector.removeClass(h)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(h){this._jsPlumb.visible=h,this.connector&&this.connector.setVisible(h),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(h){this._jsPlumb&&(Q(this,this.source,this._jsPlumb.instance,h),Q(this,this.target,this._jsPlumb.instance,h))},setHover:function(h){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(h),q.jsPlumb[h?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),q.jsPlumb[h?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(h){this._jsPlumb.cost=h},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(h,M){var o={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},n=this._jsPlumb.instance.getRenderMode(),m;return V.isString(h)?m=J(this._jsPlumb.instance,n,h,o,this):V.isArray(h)&&(h.length===1?m=J(this._jsPlumb.instance,n,h[0],o,this):m=J(this._jsPlumb.instance,n,h[0],V.merge(h[1],o),this)),M!=null&&(m.typeId=M),m},setPreparedConnector:function(h,M,o,n){if(this.connector!==h){var m,E="";if(this.connector!=null&&(m=this.connector,E=m.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=h,n&&this.cacheTypeItem("connector",h,n),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(E),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),m!=null)for(var D=this.getOverlays(),C=0;C<D.length;C++)D[C].transfer&&D[C].transfer(this.connector);o||this.setListenerComponent(this.connector),M||this.repaint()}},setConnector:function(h,M,o,n){var m=this.prepareConnector(h,n);this.setPreparedConnector(m,M,o,n)},paint:function(h){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){h=h||{};var M=h.timestamp,o=!1,n=o?this.sourceId:this.targetId,m=o?this.targetId:this.sourceId,E=o?0:1,D=o?1:0;if(M==null||M!==this._jsPlumb.lastPaintedAt){var C=this._jsPlumb.instance.updateOffset({elId:m}).o,d=this._jsPlumb.instance.updateOffset({elId:n}).o,e=this.endpoints[D],T=this.endpoints[E],I=e.anchor.getCurrentLocation({xy:[C.left,C.top],wh:[C.width,C.height],element:e,timestamp:M,rotation:this._jsPlumb.instance.getRotation(this.sourceId)}),R=T.anchor.getCurrentLocation({xy:[d.left,d.top],wh:[d.width,d.height],element:T,timestamp:M,rotation:this._jsPlumb.instance.getRotation(this.targetId)});this.connector.resetBounds(),this.connector.compute({sourcePos:I,targetPos:R,sourceOrientation:e.anchor.getOrientation(e),targetOrientation:T.anchor.getOrientation(T),sourceEndpoint:this.endpoints[D],targetEndpoint:this.endpoints[E],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:C,targetInfo:d});var L={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var _ in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(_)){var S=this._jsPlumb.overlays[_];S.isVisible()&&(this._jsPlumb.overlayPlacements[_]=S.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(S)),L.minX=Math.min(L.minX,this._jsPlumb.overlayPlacements[_].minX),L.maxX=Math.max(L.maxX,this._jsPlumb.overlayPlacements[_].maxX),L.minY=Math.min(L.minY,this._jsPlumb.overlayPlacements[_].minY),L.maxY=Math.max(L.maxY,this._jsPlumb.overlayPlacements[_].maxY))}var s=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,f=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),a={xmin:Math.min(this.connector.bounds.minX-(s+f),L.minX),ymin:Math.min(this.connector.bounds.minY-(s+f),L.minY),xmax:Math.max(this.connector.bounds.maxX+(s+f),L.maxX),ymax:Math.max(this.connector.bounds.maxY+(s+f),L.maxY)};this.connector.paintExtents=a,this.connector.paint(this._jsPlumb.paintStyleInUse,null,a);for(var P in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(P)){var k=this._jsPlumb.overlays[P];k.isVisible()&&k.paint(this._jsPlumb.overlayPlacements[P],a)}}this._jsPlumb.lastPaintedAt=M}},repaint:function(h){var M=jsPlumb.extend(h||{},{});M.elId=this.sourceId,this.paint(M)},prepareEndpoint:function(h,M,o,n,m,E,D,C,d){var e;if(n)o.endpoints[m]=n,n.addConnection(o);else{E.endpoints||(E.endpoints=[null,null]);var T=d||E.endpoints[m]||E.endpoint||h.Defaults.Endpoints[m]||u.Defaults.Endpoints[m]||h.Defaults.Endpoint||u.Defaults.Endpoint;E.endpointStyles||(E.endpointStyles=[null,null]),E.endpointHoverStyles||(E.endpointHoverStyles=[null,null]);var I=E.endpointStyles[m]||E.endpointStyle||h.Defaults.EndpointStyles[m]||u.Defaults.EndpointStyles[m]||h.Defaults.EndpointStyle||u.Defaults.EndpointStyle;I.fill==null&&E.paintStyle!=null&&(I.fill=E.paintStyle.stroke),I.outlineStroke==null&&E.paintStyle!=null&&(I.outlineStroke=E.paintStyle.outlineStroke),I.outlineWidth==null&&E.paintStyle!=null&&(I.outlineWidth=E.paintStyle.outlineWidth);var R=E.endpointHoverStyles[m]||E.endpointHoverStyle||h.Defaults.EndpointHoverStyles[m]||u.Defaults.EndpointHoverStyles[m]||h.Defaults.EndpointHoverStyle||u.Defaults.EndpointHoverStyle;E.hoverPaintStyle!=null&&(R==null&&(R={}),R.fill==null&&(R.fill=E.hoverPaintStyle.stroke));var L=E.anchors?E.anchors[m]:E.anchor?E.anchor:$(h.Defaults.Anchors[m],C,h)||$(u.Defaults.Anchors[m],C,h)||$(h.Defaults.Anchor,C,h)||$(u.Defaults.Anchor,C,h),_=E.uuids?E.uuids[m]:null;e=M({paintStyle:I,hoverPaintStyle:R,endpoint:T,connections:[o],uuid:_,anchor:L,source:D,scope:E.scope,reattach:E.reattach||h.Defaults.ReattachConnections,detachable:E.detachable||h.Defaults.ConnectionsDetachable}),n==null&&e.setDeleteOnEmpty(!0),o.endpoints[m]=e,E.drawEndpoints===!1&&e.setVisible(!1,!0,!0)}return e},replaceEndpoint:function(h,M){var o=this.endpoints[h],n=o.elementId,m=this._jsPlumb.instance.getEndpoints(n),E=m.indexOf(o),D=this.makeEndpoint(h===0,o.element,n,null,M);this.endpoints[h]=D,m.splice(E,1,D),this._jsPlumb.instance.deleteObject({endpoint:o,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:o,current:D}),this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId,this.endpoints[1].elementId,this,this.endpoints[1].element,1)}})}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumbUtil,V=q.jsPlumb;V.AnchorManager=function(h){var M={},o={},n={},m={},E=this,D={},C=h.jsPlumbInstance,d={},e=function(a,P,k,c,j,v,w,p){for(var x=[],U=P[j?0:1]/(c.length+1),B=0;B<c.length;B++){var Y=(B+1)*U,i=v*P[j?1:0];w&&(Y=P[j?0:1]-Y);var l=j?Y:i,t=k.left+l,g=l/P[0],y=j?i:Y,N=k.top+y,F=y/P[1];if(p!==0){var X=jsPlumbUtil.rotatePoint([t,N],[k.centerx,k.centery],p);t=X[0],N=X[1]}x.push([t,N,g,F,c[B][1],c[B][2]])}return x},T=function(a,P){return P[0][0]-a[0][0]},I=function(a,P){var k=a[0][0]<0?-Math.PI-a[0][0]:Math.PI-a[0][0],c=P[0][0]<0?-Math.PI-P[0][0]:Math.PI-P[0][0];return k-c},R={top:I,right:T,bottom:T,left:I},L=function(a,P){return a.sort(P)},_=function(a,P){var k=C.getCachedData(a),c=k.s,j=k.o,v=function(w,p,x,U,B,Y,i){if(U.length>0)for(var l=L(U,R[w]),t=w==="right"||w==="top",g=C.getRotation(a),y=e(w,p,x,l,B,Y,t,g),N=function(at,st){o[at.id]=[st[0],st[1],st[2],st[3]],n[at.id]=i},F=0;F<y.length;F++){var X=y[F][4],G=X.endpoints[0].elementId===a,W=X.endpoints[1].elementId===a;G&&N(X.endpoints[0],y[F]),W&&N(X.endpoints[1],y[F])}};v("bottom",c,j,P.bottom,!0,1,[0,1]),v("top",c,j,P.top,!0,0,[0,-1]),v("left",c,j,P.left,!1,0,[-1,0]),v("right",c,j,P.right,!1,1,[1,0])};this.reset=function(){M={},m={},D={}},this.addFloatingConnection=function(a,P){d[a]=P},this.newConnection=function(a){var P=a.sourceId,k=a.targetId,c=a.endpoints,j=!0,v=function(w,p,x,U,B){P===k&&x.isContinuous&&(a._jsPlumb.instance.removeElement(c[1].canvas),j=!1),u.addToList(m,U,[B,p,x.constructor===V.DynamicAnchor])};v(0,c[0],c[0].anchor,k,a),j&&v(1,c[1],c[1].anchor,P,a)};var S=function(a){(function(P,k){if(P){var c=function(j){return j[4]===k};u.removeWithFunction(P.top,c),u.removeWithFunction(P.left,c),u.removeWithFunction(P.bottom,c),u.removeWithFunction(P.right,c)}})(D[a.elementId],a.id)};this.connectionDetached=function(a,P){var k=a.connection||a,c=a.sourceId,j=a.targetId,v=k.endpoints,w=function(p,x,U,B,Y){u.removeWithFunction(m[B],function(i){return i[0].id===Y.id})};w(1,v[1],v[1].anchor,c,k),w(0,v[0],v[0].anchor,j,k),k.floatingId&&(w(k.floatingIndex,k.floatingEndpoint,k.floatingEndpoint.anchor,k.floatingId,k),S(k.floatingEndpoint)),S(k.endpoints[0]),S(k.endpoints[1]),P||(E.redraw(k.sourceId),k.targetId!==k.sourceId&&E.redraw(k.targetId))},this.addEndpoint=function(a,P){u.addToList(M,P,a)},this.changeId=function(a,P){m[P]=m[a],M[P]=M[a],delete m[a],delete M[a]},this.getConnectionsFor=function(a){return m[a]||[]},this.getEndpointsFor=function(a){return M[a]||[]},this.deleteEndpoint=function(a){u.removeWithFunction(M[a.elementId],function(P){return P.id===a.id}),S(a)},this.elementRemoved=function(a){delete d[a],delete M[a],M[a]=[]};var s=function(a,P,k,c,j,v,w,p,x,U,B,Y){var i=-1,l=c.endpoints[w],t=l.id,g=[1,0][w],y=[[P,k],c,j,v,t],N=a[x],F=l._continuousAnchorEdge?a[l._continuousAnchorEdge]:null,X,G;if(F){var W=u.findWithFunction(F,function(st){return st[4]===t});if(W!==-1)for(F.splice(W,1),X=0;X<F.length;X++)G=F[X][1],u.addWithFunction(B,G,function(st){return st.id===G.id}),u.addWithFunction(Y,F[X][1].endpoints[w],function(st){return st.id===G.endpoints[w].id}),u.addWithFunction(Y,F[X][1].endpoints[g],function(st){return st.id===G.endpoints[g].id})}for(X=0;X<N.length;X++)G=N[X][1],h.idx===1&&N[X][3]===v&&i===-1&&(i=X),u.addWithFunction(B,G,function(st){return st.id===G.id}),u.addWithFunction(Y,N[X][1].endpoints[w],function(st){return st.id===G.endpoints[w].id}),u.addWithFunction(Y,N[X][1].endpoints[g],function(st){return st.id===G.endpoints[g].id});{var at=p?i!==-1?i:0:N.length;N.splice(at,0,y)}l._continuousAnchorEdge=x};this.sourceOrTargetChanged=function(a,P,k,c,j){if(j===0){if(a!==P){k.sourceId=P,k.source=c,u.removeWithFunction(m[a],function(U){return U[0].id===k.id});var v=u.findWithFunction(m[k.targetId],function(U){return U[0].id===k.id});v>-1&&(m[k.targetId][v][0]=k,m[k.targetId][v][1]=k.endpoints[0],m[k.targetId][v][2]=k.endpoints[0].anchor.constructor===V.DynamicAnchor),u.addToList(m,P,[k,k.endpoints[1],k.endpoints[1].anchor.constructor===V.DynamicAnchor]),k.endpoints[1].anchor.isContinuous&&(k.source===k.target?k._jsPlumb.instance.removeElement(k.endpoints[1].canvas):k.endpoints[1].canvas.parentNode==null&&k._jsPlumb.instance.appendElement(k.endpoints[1].canvas)),k.updateConnectedClass()}}else if(j===1){var w=k.endpoints[0].elementId;k.target=c,k.targetId=P;var p=u.findWithFunction(m[w],function(U){return U[0].id===k.id}),x=u.findWithFunction(m[a],function(U){return U[0].id===k.id});p!==-1&&(m[w][p][0]=k,m[w][p][1]=k.endpoints[1],m[w][p][2]=k.endpoints[1].anchor.constructor===V.DynamicAnchor),x>-1&&(m[a].splice(x,1),u.addToList(m,P,[k,k.endpoints[0],k.endpoints[0].anchor.constructor===V.DynamicAnchor])),k.updateConnectedClass()}},this.rehomeEndpoint=function(a,P,k){var c=M[P]||[],j=C.getId(k);if(j!==P){var v=c.indexOf(a);if(v>-1){var w=c.splice(v,1)[0];E.add(w,j)}}for(var p=0;p<a.connections.length;p++)a.connections[p].sourceId===P?E.sourceOrTargetChanged(P,a.elementId,a.connections[p],a.element,0):a.connections[p].targetId===P&&E.sourceOrTargetChanged(P,a.elementId,a.connections[p],a.element,1)},this.redraw=function(a,P,k,c,j,v){var w=[],p=[],x=[];if(!C.isSuspendDrawing()){var U=M[a]||[],B=m[a]||[];k=k||jsPlumbUtil.uuid(),c=c||{left:0,top:0},P&&(P={left:P.left+c.left,top:P.top+c.top});for(var Y=C.updateOffset({elId:a,offset:P,recalc:!1,timestamp:k}),i={},l=0;l<B.length;l++){var t=B[l][0],g=t.sourceId,y=t.targetId,N=t.endpoints[0].anchor.isContinuous,F=t.endpoints[1].anchor.isContinuous;if(N||F){var X=g+"_"+y,G=i[X],W=t.sourceId===a?1:0,at=C.getRotation(y),st=C.getRotation(g);N&&!D[g]&&(D[g]={top:[],right:[],bottom:[],left:[]}),F&&!D[y]&&(D[y]={top:[],right:[],bottom:[],left:[]}),a!==y&&C.updateOffset({elId:y,timestamp:k}),a!==g&&C.updateOffset({elId:g,timestamp:k});var it=C.getCachedData(y),rt=C.getCachedData(g);y===g&&(N||F)?(s(D[g],-Math.PI/2,0,t,!1,y,0,!1,"top",g,w,p),s(D[y],-Math.PI/2,0,t,!1,g,1,!1,"top",y,w,p)):(G||(G=this.calculateOrientation(g,y,rt.o,it.o,t.endpoints[0].anchor,t.endpoints[1].anchor,t,st,at),i[X]=G),N&&s(D[g],G.theta,0,t,!1,y,0,!1,G.a[0],g,w,p),F&&s(D[y],G.theta2,-1,t,!0,g,1,!0,G.a[1],y,w,p)),N&&u.addWithFunction(x,g,function(vt){return vt===g}),F&&u.addWithFunction(x,y,function(vt){return vt===y}),u.addWithFunction(w,t,function(vt){return vt.id===t.id}),(N&&W===0||F&&W===1)&&u.addWithFunction(p,t.endpoints[W],function(vt){return vt.id===t.endpoints[W].id})}}for(l=0;l<U.length;l++)U[l].connections.length===0&&U[l].anchor.isContinuous&&(D[a]||(D[a]={top:[],right:[],bottom:[],left:[]}),s(D[a],-Math.PI/2,0,{endpoints:[U[l],U[l]],paint:function(){}},!1,a,0,!1,U[l].anchor.getDefaultFace(),a,w,p),u.addWithFunction(x,a,function(vt){return vt===a}));for(l=0;l<x.length;l++)_(x[l],D[x[l]]);for(l=0;l<U.length;l++)U[l].paint({timestamp:k,offset:Y,dimensions:Y.s,recalc:v!==!0});for(l=0;l<p.length;l++){var gt=C.getCachedData(p[l].elementId);p[l].paint({timestamp:null,offset:gt,dimensions:gt.s})}for(l=0;l<B.length;l++){var pt=B[l][1];if(pt.anchor.constructor===V.DynamicAnchor){pt.paint({elementWithPrecedence:a,timestamp:k}),u.addWithFunction(w,B[l][0],function(vt){return vt.id===B[l][0].id});for(var lt=0;lt<pt.connections.length;lt++)pt.connections[lt]!==B[l][0]&&u.addWithFunction(w,pt.connections[lt],function(vt){return vt.id===pt.connections[lt].id})}else u.addWithFunction(w,B[l][0],function(vt){return vt.id===B[l][0].id})}var _t=d[a];for(_t&&_t.paint({timestamp:k,recalc:!1,elId:a}),l=0;l<w.length;l++)w[l].paint({elId:a,timestamp:null,recalc:!1,clearEdits:j})}return{c:w,e:p}};var f=function(a){u.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var P=a.faces||["top","right","bottom","left"],k=a.clockwise!==!1,c={},j={top:"bottom",right:"left",left:"right",bottom:"top"},v={top:"right",right:"bottom",left:"top",bottom:"left"},w={top:"left",right:"top",left:"bottom",bottom:"right"},p=k?v:w,x=k?w:v,U=a.cssClass||"",B=null,Y=null,i=["left","right"],l=["top","bottom"],t=null,g=0;g<P.length;g++)c[P[g]]=!0;this.getDefaultFace=function(){return P.length===0?"top":P[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(y){return c[y]?y:c[j[y]]?j[y]:c[p[y]]?p[y]:c[x[y]]?x[y]:y},this.isEdgeSupported=function(y){return t==null?Y==null?c[y]===!0:Y===y:t.indexOf(y)!==-1},this.setCurrentFace=function(y,N){B=y,N&&Y!=null&&(Y=B)},this.getCurrentFace=function(){return B},this.getSupportedFaces=function(){var y=[];for(var N in c)c[N]&&y.push(N);return y},this.lock=function(){Y=B},this.unlock=function(){Y=null},this.isLocked=function(){return Y!=null},this.lockCurrentAxis=function(){B!=null&&(t=B==="left"||B==="right"?i:l)},this.unlockCurrentAxis=function(){t=null},this.compute=function(y){return o[y.element.id]||[0,0]},this.getCurrentLocation=function(y){return o[y.element.id]||[0,0]},this.getOrientation=function(y){return n[y.id]||[0,0]},this.getCssClass=function(){return U}};C.continuousAnchorFactory={get:function(a){return new f(a)},clear:function(a){delete o[a]}}},V.AnchorManager.prototype.calculateOrientation=function(h,M,o,n,m,E,D,C,d){var e={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},T=["left","top","right","bottom"];if(h===M)return{orientation:e.IDENTITY,a:["top","top"]};var I=Math.atan2(n.centery-o.centery,n.centerx-o.centerx),R=Math.atan2(o.centery-n.centery,o.centerx-n.centerx),L=[],_={};(function(k,c){for(var j=0;j<k.length;j++)if(_[k[j]]={left:[c[j][0].left,c[j][0].centery],right:[c[j][0].right,c[j][0].centery],top:[c[j][0].centerx,c[j][0].top],bottom:[c[j][0].centerx,c[j][0].bottom]},c[j][1]!==0)for(var v in _[k[j]])_[k[j]][v]=jsPlumbUtil.rotatePoint(_[k[j]][v],[c[j][0].centerx,c[j][0].centery],c[j][1])})(["source","target"],[[o,C],[n,d]]);for(var S=0;S<T.length;S++)for(var s=0;s<T.length;s++)L.push({source:T[S],target:T[s],dist:Biltong.lineLength(_.source[T[S]],_.target[T[s]])});L.sort(function(k,c){return k.dist<c.dist?-1:k.dist>c.dist?1:0});for(var f=L[0].source,a=L[0].target,P=0;P<L.length&&(m.isContinuous&&m.locked?f=m.getCurrentFace():!m.isContinuous||m.isEdgeSupported(L[P].source)?f=L[P].source:f=null,E.isContinuous&&E.locked?a=E.getCurrentFace():!E.isContinuous||E.isEdgeSupported(L[P].target)?a=L[P].target:a=null,!(f!=null&&a!=null));P++);return m.isContinuous&&m.setCurrentFace(f),E.isContinuous&&E.setCurrentFace(a),{a:[f,a],theta:I,theta2:R}},V.Anchor=function(h){this.x=h.x||0,this.y=h.y||0,this.elementId=h.elementId,this.cssClass=h.cssClass||"",this.orientation=h.orientation||[0,0],this.lastReturnValue=null,this.offsets=h.offsets||[0,0],this.timestamp=null,this._unrotatedOrientation=[this.orientation[0],this.orientation[1]],this.relocatable=h.relocatable!==!1,this.snapOnRelocate=h.snapOnRelocate!==!1,this.locked=!1,u.EventGenerator.apply(this),this.compute=function(M){var o=M.xy,n=M.wh,m=M.timestamp;if(m&&m===this.timestamp)return this.lastReturnValue;var E=[o[0]+this.x*n[0]+this.offsets[0],o[1]+this.y*n[1]+this.offsets[1],this.x,this.y],D=M.rotation;if(D!=null&&D!==0){var C=jsPlumbUtil.rotatePoint(E,[o[0]+n[0]/2,o[1]+n[1]/2],D);this.orientation[0]=Math.round(this._unrotatedOrientation[0]*C[2]-this._unrotatedOrientation[1]*C[3]),this.orientation[1]=Math.round(this._unrotatedOrientation[1]*C[2]+this._unrotatedOrientation[0]*C[3]),this.lastReturnValue=[C[0],C[1],this.x,this.y]}else this.orientation[0]=this._unrotatedOrientation[0],this.orientation[1]=this._unrotatedOrientation[1],this.lastReturnValue=E;return this.timestamp=m,this.lastReturnValue},this.getCurrentLocation=function(M){return M=M||{},this.lastReturnValue==null||M.timestamp!=null&&this.timestamp!==M.timestamp?this.compute(M):this.lastReturnValue},this.setPosition=function(M,o,n,m,E){(!this.locked||E)&&(this.x=M,this.y=o,this.orientation=[n,m],this.lastReturnValue=null)}},u.extend(V.Anchor,u.EventGenerator,{equals:function(h){if(!h)return!1;var M=h.getOrientation(),o=this.getOrientation();return this.x===h.x&&this.y===h.y&&this.offsets[0]===h.offsets[0]&&this.offsets[1]===h.offsets[1]&&o[0]===M[0]&&o[1]===M[1]},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),V.FloatingAnchor=function(h){V.Anchor.apply(this,arguments);var M=h.reference,o=h.referenceCanvas,n=V.getSize(o),m=0,E=0,D=null,C=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(d){var e=d.xy,T=[e[0]+n[0]/2,e[1]+n[1]/2];return C=T,T},this.getOrientation=function(d){if(D)return D;var e=M.getOrientation(d);return[Math.abs(e[0])*m*-1,Math.abs(e[1])*E*-1]},this.over=function(d,e){D=d.getOrientation(e)},this.out=function(){D=null},this.getCurrentLocation=function(d){return C??this.compute(d)}},u.extend(V.FloatingAnchor,V.Anchor);var J=function(h,M,o){return h.constructor===V.Anchor?h:M.makeAnchor(h,o,M)};V.DynamicAnchor=function(h){V.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=h.elementId,this.jsPlumbInstance=h.jsPlumbInstance;for(var M=0;M<h.anchors.length;M++)this.anchors[M]=J(h.anchors[M],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var o=this.anchors.length>0?this.anchors[0]:null,n=o,m=function(D,C,d,e,T,I,R){var L=e[0]+D.x*T[0],_=e[1]+D.y*T[1],S=e[0]+T[0]/2,s=e[1]+T[1]/2;if(I!=null&&I!==0){var f=jsPlumbUtil.rotatePoint([L,_],[S,s],I);L=f[0],_=f[1]}return Math.sqrt(Math.pow(C-L,2)+Math.pow(d-_,2))+Math.sqrt(Math.pow(S-L,2)+Math.pow(s-_,2))},E=h.selector||function(D,C,d,e,T,I,R){for(var L=d[0]+e[0]/2,_=d[1]+e[1]/2,S=-1,s=1/0,f=0;f<R.length;f++){var a=m(R[f],L,_,D,C,T);a<s&&(S=f+0,s=a)}return R[S]};this.compute=function(D){var C=D.xy,d=D.wh,e=D.txy,T=D.twh,I=D.rotation,R=D.tRotation;return this.timestamp=D.timestamp,this.locked||e==null||T==null?(this.lastReturnValue=o.compute(D),this.lastReturnValue):(D.timestamp=null,o=E(C,d,e,T,I,R,this.anchors),this.x=o.x,this.y=o.y,o!==n&&this.fire("anchorChanged",o),n=o,this.lastReturnValue=o.compute(D),this.lastReturnValue)},this.getCurrentLocation=function(D){return o!=null?o.getCurrentLocation(D):null},this.getOrientation=function(D){return o!=null?o.getOrientation(D):[0,0]},this.over=function(D,C){o!=null&&o.over(D,C)},this.out=function(){o!=null&&o.out()},this.setAnchor=function(D){o=D},this.getCssClass=function(){return o&&o.getCssClass()||""},this.setAnchorCoordinates=function(D){var C=jsPlumbUtil.findWithFunction(this.anchors,function(d){return d.x===D[0]&&d.y===D[1]});return C!==-1?(this.setAnchor(this.anchors[C]),!0):!1}},u.extend(V.DynamicAnchor,V.Anchor);var $=function(h,M,o,n,m,E){V.Anchors[m]=function(D){var C=D.jsPlumbInstance.makeAnchor([h,M,o,n,0,0],D.elementId,D.jsPlumbInstance);return C.type=m,E&&E(C,D),C}};$(.5,0,0,-1,"TopCenter"),$(.5,1,0,1,"BottomCenter"),$(0,.5,-1,0,"LeftMiddle"),$(1,.5,1,0,"RightMiddle"),$(.5,0,0,-1,"Top"),$(.5,1,0,1,"Bottom"),$(0,.5,-1,0,"Left"),$(1,.5,1,0,"Right"),$(.5,.5,0,0,"Center"),$(1,0,0,-1,"TopRight"),$(1,1,0,1,"BottomRight"),$(0,0,0,-1,"TopLeft"),$(0,1,0,1,"BottomLeft"),V.Defaults.DynamicAnchors=function(h){return h.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],h.elementId,h.jsPlumbInstance)},V.Anchors.AutoDefault=function(h){var M=h.jsPlumbInstance.makeDynamicAnchor(V.Defaults.DynamicAnchors(h));return M.type="AutoDefault",M};var Q=function(h,M){V.Anchors[h]=function(o){var n=o.jsPlumbInstance.makeAnchor(["Continuous",{faces:M}],o.elementId,o.jsPlumbInstance);return n.type=h,n}};V.Anchors.Continuous=function(h){return h.jsPlumbInstance.continuousAnchorFactory.get(h)},Q("ContinuousLeft",["left"]),Q("ContinuousTop",["top"]),Q("ContinuousBottom",["bottom"]),Q("ContinuousRight",["right"]),$(0,0,0,0,"Assign",function(h,M){var o=M.position||"Fixed";h.positionFinder=o.constructor===String?M.jsPlumbInstance.AnchorPositionFinders[o]:o,h.constructorParams=M}),q.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(h,M,o){return[(h.left-M.left)/o[0],(h.top-M.top)/o[1]]},Grid:function(h,M,o,n){var m=h.left-M.left,E=h.top-M.top,D=o[0]/n.grid[0],C=o[1]/n.grid[1],d=Math.floor(m/D),e=Math.floor(E/C);return[(d*D+D/2)/o[0],(e*C+C/2)/o[1]]}},V.Anchors.Perimeter=function(h){h=h||{};var M=h.anchorCount||60,o=h.shape;if(!o)throw new Error("no shape supplied to Perimeter Anchor type");var n=function(){for(var I=.5,R=Math.PI*2/M,L=0,_=[],S=0;S<M;S++){var s=I+I*Math.sin(L),f=I+I*Math.cos(L);_.push([s,f,0,0]),L+=R}return _},m=function(I){for(var R=M/I.length,L=[],_=function(s,f,a,P,k,c,j){R=M*k;for(var v=(a-s)/R,w=(P-f)/R,p=0;p<R;p++)L.push([s+v*p,f+w*p,c??0,j??0])},S=0;S<I.length;S++)_.apply(null,I[S]);return L},E=function(I){for(var R=[],L=0;L<I.length;L++)R.push([I[L][0],I[L][1],I[L][2],I[L][3],1/I.length,I[L][4],I[L][5]]);return m(R)},D=function(){return E([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},C={Circle:n,Ellipse:n,Diamond:function(){return E([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:D,Square:D,Triangle:function(){return E([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(I){for(var R=I.points,L=[],_=0,S=0;S<R.length-1;S++){var s=Math.sqrt(Math.pow(R[S][2]-R[S][0])+Math.pow(R[S][3]-R[S][1]));_+=s,L.push([R[S][0],R[S][1],R[S+1][0],R[S+1][1],s])}for(var f=0;f<L.length;f++)L[f][4]=L[f][4]/_;return m(L)}},d=function(I,R){for(var L=[],_=R/180*Math.PI,S=0;S<I.length;S++){var s=I[S][0]-.5,f=I[S][1]-.5;L.push([.5+(s*Math.cos(_)-f*Math.sin(_)),.5+(s*Math.sin(_)+f*Math.cos(_)),I[S][2],I[S][3]])}return L};if(!C[o])throw new Error("Shape ["+o+"] is unknown by Perimeter Anchor type");var e=C[o](h);h.rotation&&(e=d(e,h.rotation));var T=h.jsPlumbInstance.makeDynamicAnchor(e);return T.type="Perimeter",T}}).call(typeof window<"u"?window:Ot),(function(){var q=this;q.jsPlumbUtil;var u=q.jsPlumb;u.DefaultRouter=function(V){this.jsPlumbInstance=V,this.anchorManager=new u.AnchorManager({jsPlumbInstance:V}),this.sourceOrTargetChanged=function(J,$,Q,h,M){this.anchorManager.sourceOrTargetChanged(J,$,Q,h,M)},this.reset=function(){this.anchorManager.reset()},this.changeId=function(J,$){this.anchorManager.changeId(J,$)},this.elementRemoved=function(J){this.anchorManager.elementRemoved(J)},this.newConnection=function(J){this.anchorManager.newConnection(J)},this.connectionDetached=function(J,$){this.anchorManager.connectionDetached(J,$)},this.redraw=function(J,$,Q,h,M,o){return this.anchorManager.redraw(J,$,Q,h,M,o)},this.deleteEndpoint=function(J){this.anchorManager.deleteEndpoint(J)},this.rehomeEndpoint=function(J,$,Q){this.anchorManager.rehomeEndpoint(J,$,Q)},this.addEndpoint=function(J,$){this.anchorManager.addEndpoint(J,$)}}}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J=q.Biltong;u.Segments={AbstractSegment:function(n){this.params=n,this.findClosestPointOnPath=function(m,E){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(n.x1,n.x2),minY:Math.min(n.y1,n.y2),maxX:Math.max(n.x1,n.x2),maxY:Math.max(n.y1,n.y2)}},this.lineIntersection=function(m,E,D,C){return[]},this.boxIntersection=function(m,E,D,C){var d=[];return d.push.apply(d,this.lineIntersection(m,E,m+D,E)),d.push.apply(d,this.lineIntersection(m+D,E,m+D,E+C)),d.push.apply(d,this.lineIntersection(m+D,E+C,m,E+C)),d.push.apply(d,this.lineIntersection(m,E+C,m,E)),d},this.boundingBoxIntersection=function(m){return this.boxIntersection(m.x,m.y,m.w,m.y)}},Straight:function(n){u.Segments.AbstractSegment.apply(this,arguments);var m,E,D,C,d,e,T,I=function(){m=Math.sqrt(Math.pow(d-C,2)+Math.pow(T-e,2)),E=J.gradient({x:C,y:e},{x:d,y:T}),D=-1/E};this.type="Straight",this.getLength=function(){return m},this.getGradient=function(){return E},this.getCoordinates=function(){return{x1:C,y1:e,x2:d,y2:T}},this.setCoordinates=function(s){C=s.x1,e=s.y1,d=s.x2,T=s.y2,I()},this.setCoordinates({x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2}),this.getBounds=function(){return{minX:Math.min(C,d),minY:Math.min(e,T),maxX:Math.max(C,d),maxY:Math.max(e,T)}},this.pointOnPath=function(s,f){if(s===0&&!f)return{x:C,y:e};if(s===1&&!f)return{x:d,y:T};var a=f?s>0?s:m+s:s*m;return J.pointOnLine({x:C,y:e},{x:d,y:T},a)},this.gradientAtPoint=function(s){return E},this.pointAlongPathFrom=function(s,f,a){var P=this.pointOnPath(s,a),k=f<=0?{x:C,y:e}:{x:d,y:T};return f<=0&&Math.abs(f)>1&&(f*=-1),J.pointOnLine(P,k,f)};var R=function(s,f,a){return a>=Math.min(s,f)&&a<=Math.max(s,f)},L=function(s,f,a){return Math.abs(a-s)<Math.abs(a-f)?s:f};this.findClosestPointOnPath=function(s,f){var a={d:1/0,x:null,y:null,l:null,x1:C,x2:d,y1:e,y2:T};if(E===0)a.y=e,a.x=R(C,d,s)?s:L(C,d,s);else if(E===1/0||E===-1/0)a.x=C,a.y=R(e,T,f)?f:L(e,T,f);else{var P=e-E*C,k=f-D*s,c=(k-P)/(E-D),j=E*c+P;a.x=R(C,d,c)?c:L(C,d,c),a.y=R(e,T,j)?j:L(e,T,j)}var v=J.lineLength([a.x,a.y],[C,e]);return a.d=J.lineLength([s,f],[a.x,a.y]),a.l=v/m,a};var _=function(s,f,a){return a>f?f<=s&&s<=a:f>=s&&s>=a},S=_;this.lineIntersection=function(s,f,a,P){var k=Math.abs(J.gradient({x:s,y:f},{x:a,y:P})),c=Math.abs(E),j=c===1/0?C:e-c*C,v=[],w=k===1/0?s:f-k*s;if(k!==c)if(k===1/0&&c===0)S(s,C,d)&&S(e,f,P)&&(v=[s,e]);else if(k===0&&c===1/0)S(f,e,T)&&S(C,s,a)&&(v=[C,f]);else{var p,x;k===1/0?(p=s,S(p,C,d)&&(x=c*s+j,S(x,f,P)&&(v=[p,x]))):k===0?(x=f,S(x,e,T)&&(p=(f-j)/c,S(p,s,a)&&(v=[p,x]))):(p=(w-j)/(c-k),x=c*p+j,S(p,C,d)&&S(x,e,T)&&(v=[p,x]))}return v},this.boxIntersection=function(s,f,a,P){var k=[];return k.push.apply(k,this.lineIntersection(s,f,s+a,f)),k.push.apply(k,this.lineIntersection(s+a,f,s+a,f+P)),k.push.apply(k,this.lineIntersection(s+a,f+P,s,f+P)),k.push.apply(k,this.lineIntersection(s,f+P,s,f)),k},this.boundingBoxIntersection=function(s){return this.boxIntersection(s.x,s.y,s.w,s.h)}},Arc:function(n){u.Segments.AbstractSegment.apply(this,arguments);var m=function(L,_){return J.theta([n.cx,n.cy],[L,_])},E=function(L,_){if(L.anticlockwise){var S=L.startAngle<L.endAngle?L.startAngle+D:L.startAngle,s=Math.abs(S-L.endAngle);return S-s*_}else{var f=L.endAngle<L.startAngle?L.endAngle+D:L.endAngle,a=Math.abs(f-L.startAngle);return L.startAngle+a*_}},D=2*Math.PI;this.radius=n.r,this.anticlockwise=n.ac,this.type="Arc",n.startAngle&&n.endAngle?(this.startAngle=n.startAngle,this.endAngle=n.endAngle,this.x1=n.cx+this.radius*Math.cos(n.startAngle),this.y1=n.cy+this.radius*Math.sin(n.startAngle),this.x2=n.cx+this.radius*Math.cos(n.endAngle),this.y2=n.cy+this.radius*Math.sin(n.endAngle)):(this.startAngle=m(n.x1,n.y1),this.endAngle=m(n.x2,n.y2),this.x1=n.x1,this.y1=n.y1,this.x2=n.x2,this.y2=n.y2),this.endAngle<0&&(this.endAngle+=D),this.startAngle<0&&(this.startAngle+=D);var C=this.endAngle<this.startAngle?this.endAngle+D:this.endAngle;this.sweep=Math.abs(C-this.startAngle),this.anticlockwise&&(this.sweep=D-this.sweep);var d=2*Math.PI*this.radius,e=this.sweep/D,T=d*e;this.getLength=function(){return T},this.getBounds=function(){return{minX:n.cx-n.r,maxX:n.cx+n.r,minY:n.cy-n.r,maxY:n.cy+n.r}};var I=1e-10,R=function(L){var _=Math.floor(L),S=Math.ceil(L);return L-_<I?_:S-L<I?S:L};this.pointOnPath=function(L,_){if(L===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(L===1)return{x:this.x2,y:this.y2,theta:this.endAngle};_&&(L=L/T);var S=E(this,L),s=n.cx+n.r*Math.cos(S),f=n.cy+n.r*Math.sin(S);return{x:R(s),y:R(f),theta:S}},this.gradientAtPoint=function(L,_){var S=this.pointOnPath(L,_),s=J.normal([n.cx,n.cy],[S.x,S.y]);return!this.anticlockwise&&(s===1/0||s===-1/0)&&(s*=-1),s},this.pointAlongPathFrom=function(L,_,S){var s=this.pointOnPath(L,S),f=_/d*2*Math.PI,a=this.anticlockwise?-1:1,P=s.theta+a*f,k=n.cx+this.radius*Math.cos(P),c=n.cy+this.radius*Math.sin(P);return{x:k,y:c}}},Bezier:function(n){this.curve=[{x:n.x1,y:n.y1},{x:n.cp1x,y:n.cp1y},{x:n.cp2x,y:n.cp2y},{x:n.x2,y:n.y2}];var m=function(T){return T[0].x===T[1].x&&T[0].y===T[1].y},E=function(T,I){return Math.sqrt(Math.pow(T.x-I.x,2)+Math.pow(T.y-I.y,2))},D=(function(T){var I={x:0,y:0};if(T===0)return this.curve[0];var R=this.curve.length-1;if(T===1)return this.curve[R];var L=this.curve,_=1-T;if(R===0)return this.curve[0];if(R===1)return{x:_*L[0].x+T*L[1].x,y:_*L[0].y+T*L[1].y};if(R<4){var S=_*_,s=T*T,f=0,a,P,k;return R===2?(L=[L[0],L[1],L[2],I],a=S,P=2*(_*T),k=s):R===3&&(a=S*_,P=3*(S*T),k=3*(_*s),f=T*s),{x:a*L[0].x+P*L[1].x+k*L[2].x+f*L[3].x,y:a*L[0].y+P*L[1].y+k*L[2].y+f*L[3].y}}else return I}).bind(this),C=function(T){var I=[];T--;for(var R=0;R<=T;R++)I.push(D(R/T));return I},d=(function(){m(this.curve)&&(this.length=0);var T=16,I=C(T);this.length=0;for(var R=0;R<T-1;R++){var L=I[R],_=I[R+1];this.length+=E(L,_)}}).bind(this);u.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(n.x1,n.x2,n.cp1x,n.cp2x),minY:Math.min(n.y1,n.y2,n.cp1y,n.cp2y),maxX:Math.max(n.x1,n.x2,n.cp1x,n.cp2x),maxY:Math.max(n.y1,n.y2,n.cp1y,n.cp2y)},this.type="Bezier",d();var e=function(T,I,R){return R&&(I=q.jsBezier.locationAlongCurveFrom(T,I>0?0:1,I)),I};this.pointOnPath=function(T,I){return T=e(this.curve,T,I),q.jsBezier.pointOnCurve(this.curve,T)},this.gradientAtPoint=function(T,I){return T=e(this.curve,T,I),q.jsBezier.gradientAtPoint(this.curve,T)},this.pointAlongPathFrom=function(T,I,R){return T=e(this.curve,T,R),q.jsBezier.pointAlongCurveFrom(this.curve,T,I)},this.getLength=function(){return this.length},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(T,I){var R=q.jsBezier.nearestPointOnCurve({x:T,y:I},this.curve);return{d:Math.sqrt(Math.pow(R.point.x-T,2)+Math.pow(R.point.y-I,2)),x:R.point.x,y:R.point.y,l:1-R.location,s:this}},this.lineIntersection=function(T,I,R,L){return q.jsBezier.lineIntersection(T,I,R,L,this.curve)}}},u.SegmentRenderer={getPath:function(n,m){return{Straight:function(E){var D=n.getCoordinates();return(E?"M "+D.x1+" "+D.y1+" ":"")+"L "+D.x2+" "+D.y2},Bezier:function(E){var D=n.params;return(E?"M "+D.x2+" "+D.y2+" ":"")+"C "+D.cp2x+" "+D.cp2y+" "+D.cp1x+" "+D.cp1y+" "+D.x1+" "+D.y1},Arc:function(E){var D=n.params,C=n.sweep>Math.PI?1:0,d=n.anticlockwise?0:1;return(E?"M"+n.x1+" "+n.y1+" ":"")+"A "+n.radius+" "+D.r+" 0 "+C+","+d+" "+n.x2+" "+n.y2}}[n.type](m)}};var $=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};u.Connectors.AbstractConnector=function(n){$.apply(this,arguments);var m=[],E=0,D=[],C=[],d=n.stub||0,e=V.isArray(d)?d[0]:d,T=V.isArray(d)?d[1]:d,I=n.gap||0,R=V.isArray(I)?I[0]:I,L=V.isArray(I)?I[1]:I,_=null,S=null;this.getPathData=function(){for(var c="",j=0;j<m.length;j++)c+=u.SegmentRenderer.getPath(m[j],j===0),c+=" ";return c},this.findSegmentForPoint=function(c,j){for(var v={d:1/0,s:null,x:null,y:null,l:null},w=0;w<m.length;w++){var p=m[w].findClosestPointOnPath(c,j);p.d<v.d&&(v.d=p.d,v.l=p.l,v.x=p.x,v.y=p.y,v.s=m[w],v.x1=p.x1,v.x2=p.x2,v.y1=p.y1,v.y2=p.y2,v.index=w,v.connectorLocation=D[w][0]+p.l*(D[w][1]-D[w][0]))}return v},this.lineIntersection=function(c,j,v,w){for(var p=[],x=0;x<m.length;x++)p.push.apply(p,m[x].lineIntersection(c,j,v,w));return p},this.boxIntersection=function(c,j,v,w){for(var p=[],x=0;x<m.length;x++)p.push.apply(p,m[x].boxIntersection(c,j,v,w));return p},this.boundingBoxIntersection=function(c){for(var j=[],v=0;v<m.length;v++)j.push.apply(j,m[v].boundingBoxIntersection(c));return j};var s=function(){for(var c=0,j=0;j<m.length;j++){var v=m[j].getLength();C[j]=v/E,D[j]=[c,c+=v/E]}},f=function(c,j){var v,w,p;if(j&&(c=c>0?c/E:(E+c)/E),c===1)v=m.length-1,p=1;else if(c===0)p=0,v=0;else if(c>=.5){for(v=0,p=0,w=D.length-1;w>-1;w--)if(D[w][1]>=c&&D[w][0]<=c){v=w,p=(c-D[w][0])/C[w];break}}else for(v=D.length-1,p=1,w=0;w<D.length;w++)if(D[w][1]>=c){v=w,p=(c-D[w][0])/C[w];break}return{segment:m[v],proportion:p,index:v}},a=function(c,j,v){if(!(v.x1===v.x2&&v.y1===v.y2)){var w=new u.Segments[j](v);m.push(w),E+=w.getLength(),c.updateBounds(w)}},P=function(){E=m.length=D.length=C.length=0};this.setSegments=function(c){_=[],E=0;for(var j=0;j<c.length;j++)_.push(c[j]),E+=c[j].getLength()},this.getLength=function(){return E};var k=function(c){this.strokeWidth=c.strokeWidth;var j=J.quadrant(c.sourcePos,c.targetPos),v=c.targetPos[0]<c.sourcePos[0],w=c.targetPos[1]<c.sourcePos[1],p=c.strokeWidth||1,x=c.sourceEndpoint.anchor.getOrientation(c.sourceEndpoint),U=c.targetEndpoint.anchor.getOrientation(c.targetEndpoint),B=v?c.targetPos[0]:c.sourcePos[0],Y=w?c.targetPos[1]:c.sourcePos[1],i=Math.abs(c.targetPos[0]-c.sourcePos[0]),l=Math.abs(c.targetPos[1]-c.sourcePos[1]);if(x[0]===0&&x[1]===0||U[0]===0&&U[1]===0){var t=i>l?0:1,g=[1,0][t];x=[],U=[],x[t]=c.sourcePos[t]>c.targetPos[t]?-1:1,U[t]=c.sourcePos[t]>c.targetPos[t]?1:-1,x[g]=0,U[g]=0}var y=v?i+R*x[0]:R*x[0],N=w?l+R*x[1]:R*x[1],F=v?L*U[0]:i+L*U[0],X=w?L*U[1]:l+L*U[1],G=x[0]*U[0]+x[1]*U[1],W={sx:y,sy:N,tx:F,ty:X,lw:p,xSpan:Math.abs(F-y),ySpan:Math.abs(X-N),mx:(y+F)/2,my:(N+X)/2,so:x,to:U,x:B,y:Y,w:i,h:l,segment:j,startStubX:y+x[0]*e,startStubY:N+x[1]*e,endStubX:F+U[0]*T,endStubY:X+U[1]*T,isXGreaterThanStubTimes2:Math.abs(y-F)>e+T,isYGreaterThanStubTimes2:Math.abs(N-X)>e+T,opposite:G===-1,perpendicular:G===0,orthogonal:G===1,sourceAxis:x[0]===0?"y":"x",points:[B,Y,i,l,y,N,F,X],stubs:[e,T]};return W.anchorOrientation=W.opposite?"opposite":W.orthogonal?"orthogonal":"perpendicular",W};return this.getSegments=function(){return m},this.updateBounds=function(c){var j=c.getBounds();this.bounds.minX=Math.min(this.bounds.minX,j.minX),this.bounds.maxX=Math.max(this.bounds.maxX,j.maxX),this.bounds.minY=Math.min(this.bounds.minY,j.minY),this.bounds.maxY=Math.max(this.bounds.maxY,j.maxY)},this.pointOnPath=function(c,j){var v=f(c,j);return v.segment&&v.segment.pointOnPath(v.proportion,!1)||[0,0]},this.gradientAtPoint=function(c,j){var v=f(c,j);return v.segment&&v.segment.gradientAtPoint(v.proportion,!1)||0},this.pointAlongPathFrom=function(c,j,v){var w=f(c,v);return w.segment&&w.segment.pointAlongPathFrom(w.proportion,j,!1)||[0,0]},this.compute=function(c){S=k.call(this,c),P(),this._compute(S,c),this.x=S.points[0],this.y=S.points[1],this.w=S.points[2],this.h=S.points[3],this.segment=S.segment,s()},{addSegment:a,prepareCompute:k,sourceStub:e,targetStub:T,maxStub:Math.max(e,T),sourceGap:R,targetGap:L,maxGap:Math.max(R,L)}},V.extend(u.Connectors.AbstractConnector,$),u.Endpoints.AbstractEndpoint=function(n){$.apply(this,arguments);var m=this.compute=function(E,D,C,d){var e=this._compute.apply(this,arguments);return this.x=e[0],this.y=e[1],this.w=e[2],this.h=e[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,e};return{compute:m,cssClass:n.cssClass}},V.extend(u.Endpoints.AbstractEndpoint,$),u.Endpoints.Dot=function(n){this.type="Dot",u.Endpoints.AbstractEndpoint.apply(this,arguments),n=n||{},this.radius=n.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(m,E,D,C){this.radius=D.radius||this.radius;var d=m[0]-this.radius,e=m[1]-this.radius,T=this.radius*2,I=this.radius*2;if(D.stroke){var R=D.strokeWidth||1;d-=R,e-=R,T+=R*2,I+=R*2}return[d,e,T,I,this.radius]}},V.extend(u.Endpoints.Dot,u.Endpoints.AbstractEndpoint),u.Endpoints.Rectangle=function(n){this.type="Rectangle",u.Endpoints.AbstractEndpoint.apply(this,arguments),n=n||{},this.width=n.width||20,this.height=n.height||20,this._compute=function(m,E,D,C){var d=D.width||this.width,e=D.height||this.height,T=m[0]-d/2,I=m[1]-e/2;return[T,I,d,e]}},V.extend(u.Endpoints.Rectangle,u.Endpoints.AbstractEndpoint);var Q=function(n){u.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};V.extend(Q,u.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(n){this._jsPlumb.displayElements.push(n)}}),u.Endpoints.Image=function(n){this.type="Image",Q.apply(this,arguments),u.Endpoints.AbstractEndpoint.apply(this,arguments);var m=n.onload,E=n.src||n.url,D=n.cssClass?" "+n.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=n.width,this._jsPlumb.heightToUse=n.height,this._jsPlumb.endpoint=n.endpoint,this._jsPlumb.img.onload=(function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,m&&m(this))}).bind(this),this._jsPlumb.endpoint.setImage=(function(C,d){var e=C.constructor===String?C:C.src;m=d,this._jsPlumb.img.src=e,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}).bind(this),this._jsPlumb.endpoint.setImage(E,m),this._compute=function(C,d,e,T){return this.anchorPoint=C,this._jsPlumb.ready?[C[0]-this._jsPlumb.widthToUse/2,C[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=u.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+D),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(C,d,e){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var T=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,I=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;V.sizeElement(this.canvas,T,I,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(C,d){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(C,d):q.setTimeout((function(){this.paint(C,d)}).bind(this),200))}},V.extend(u.Endpoints.Image,[Q,u.Endpoints.AbstractEndpoint],{cleanup:function(n){n&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),u.Endpoints.Blank=function(n){u.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",Q.apply(this,arguments),this._compute=function(E,D,C,d){return[E[0],E[1],10,0]};var m=n.cssClass?" "+n.cssClass:"";this.canvas=u.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+m),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(E,D){V.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},V.extend(u.Endpoints.Blank,[u.Endpoints.AbstractEndpoint,Q],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),u.Endpoints.Triangle=function(n){this.type="Triangle",u.Endpoints.AbstractEndpoint.apply(this,arguments);var m=this;n=n||{},n.width=n.width||55,n.height=n.height||55,this.width=n.width,this.height=n.height,this._compute=function(E,D,C,d){var e=C.width||m.width,T=C.height||m.height,I=E[0]-e/2,R=E[1]-T/2;return[I,R,e,T]}};var h=u.Overlays.AbstractOverlay=function(n){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=n.component,this.loc=n.location==null?.5:n.location,this.endpointLoc=n.endpointLocation==null?[.5,.5]:n.endpointLocation,this.visible=n.visible!==!1};h.prototype={cleanup:function(n){n&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(n,m){},setVisible:function(n){this.visible=n,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(n){this.loc+=n,this.component.repaint()},setLocation:function(n){this.loc=n,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},u.Overlays.Arrow=function(n){this.type="Arrow",h.apply(this,arguments),this.isAppendedAtTopLevel=!1,n=n||{};var m=this;this.length=n.length||20,this.width=n.width||20,this.id=n.id,this.direction=(n.direction||1)<0?-1:1;var E=n.paintStyle||{"stroke-width":1},D=n.foldback||.623;this.computeMaxSize=function(){return m.width*1.5},this.elementCreated=function(C,d){if(this.path=C,n.events)for(var e in n.events)u.on(C,e,n.events[e])},this.draw=function(C,d){var e,T,I,R,L;if(C.pointAlongPathFrom){if(V.isString(this.loc)||this.loc>1||this.loc<0){var _=parseInt(this.loc,10),S=this.loc<0?1:0;e=C.pointAlongPathFrom(S,_,!1),T=C.pointAlongPathFrom(S,_-this.direction*this.length/2,!1),I=J.pointOnLine(e,T,this.length)}else if(this.loc===1){if(e=C.pointOnPath(this.loc),T=C.pointAlongPathFrom(this.loc,-this.length),I=J.pointOnLine(e,T,this.length),this.direction===-1){var s=I;I=e,e=s}}else if(this.loc===0){if(I=C.pointOnPath(this.loc),T=C.pointAlongPathFrom(this.loc,this.length),e=J.pointOnLine(I,T,this.length),this.direction===-1){var f=I;I=e,e=f}}else e=C.pointAlongPathFrom(this.loc,this.direction*this.length/2),T=C.pointOnPath(this.loc),I=J.pointOnLine(e,T,this.length);R=J.perpendicularLineTo(e,I,this.width),L=J.pointOnLine(e,I,D*this.length);var a={hxy:e,tail:R,cxy:L},P=E.stroke||d.stroke,k=E.fill||d.stroke,c=E.strokeWidth||d.strokeWidth;return{component:C,d:a,"stroke-width":c,stroke:P,fill:k,minX:Math.min(e.x,R[0].x,R[1].x),maxX:Math.max(e.x,R[0].x,R[1].x),minY:Math.min(e.y,R[0].y,R[1].y),maxY:Math.max(e.y,R[0].y,R[1].y)}}else return{component:C,minX:0,maxX:0,minY:0,maxY:0}}},V.extend(u.Overlays.Arrow,h,{updateFrom:function(n){this.length=n.length||this.length,this.width=n.width||this.width,this.direction=n.direction!=null?n.direction:this.direction,this.foldback=n.foldback||this.foldback},cleanup:function(){this.path&&this.path.parentNode&&this.path.parentNode.removeChild(this.path)}}),u.Overlays.PlainArrow=function(n){n=n||{};var m=u.extend(n,{foldback:1});u.Overlays.Arrow.call(this,m),this.type="PlainArrow"},V.extend(u.Overlays.PlainArrow,u.Overlays.Arrow),u.Overlays.Diamond=function(n){n=n||{};var m=n.length||40,E=u.extend(n,{length:m/2,foldback:2});u.Overlays.Arrow.call(this,E),this.type="Diamond"},V.extend(u.Overlays.Diamond,u.Overlays.Arrow);var M=function(n,m){return(n._jsPlumb.cachedDimensions==null||m)&&(n._jsPlumb.cachedDimensions=n.getDimensions()),n._jsPlumb.cachedDimensions},o=function(n){u.jsPlumbUIComponent.apply(this,arguments),h.apply(this,arguments);var m=this.fire;this.fire=function(){m.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=n.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=n.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=n.create,this._jsPlumb.initiallyInvisible=n.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){var E=this._jsPlumb.div=u.getElement(this._jsPlumb.create(this._jsPlumb.component));E.style.position="absolute",jsPlumb.addClass(E,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:n.cssClass?n.cssClass:"")),this._jsPlumb.instance.appendElement(E),this._jsPlumb.instance.getId(E),this.canvas=E;var D="translate(-50%, -50%)";E.style.webkitTransform=D,E.style.mozTransform=D,E.style.msTransform=D,E.style.oTransform=D,E.style.transform=D,E._jsPlumb=this,n.visible===!1&&(E.style.display="none")}return this._jsPlumb.div},this.draw=function(E,D,C){var d=M(this);if(d!=null&&d.length===2){var e={x:0,y:0};if(C)e={x:C[0],y:C[1]};else if(E.pointOnPath){var T=this.loc,I=!1;(V.isString(this.loc)||this.loc<0||this.loc>1)&&(T=parseInt(this.loc,10),I=!0),e=E.pointOnPath(T,I)}else{var R=this.loc.constructor===Array?this.loc:this.endpointLoc;e={x:R[0]*E.w,y:R[1]*E.h}}var L=e.x-d[0]/2,_=e.y-d[1]/2;return{component:E,d:{minx:L,miny:_,td:d,cxy:e},minX:L,maxX:L+d[0],minY:_,maxY:_+d[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};V.extend(o,[u.jsPlumbUIComponent,h],{getDimensions:function(){return[1,1]},setVisible:function(n){this._jsPlumb.div&&(this._jsPlumb.div.style.display=n?"block":"none",n&&this._jsPlumb.initiallyInvisible&&(M(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(n){n?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(n,m){this._jsPlumb.div!=null&&n.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var n=M(this);return Math.max(n[0],n[1])},paint:function(n,m){this._jsPlumb.initialised||(this.getElement(),n.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=n.component.x+n.d.minx+"px",this._jsPlumb.div.style.top=n.component.y+n.d.miny+"px"}}),u.Overlays.Custom=function(n){this.type="Custom",o.apply(this,arguments)},V.extend(u.Overlays.Custom,o),u.Overlays.GuideLines=function(){var n=this;n.length=50,n.strokeWidth=5,this.type="GuideLines",h.apply(this,arguments),u.jsPlumbUIComponent.apply(this,arguments),this.draw=function(m,E){var D=m.pointAlongPathFrom(n.loc,n.length/2),C=m.pointOnPath(n.loc),d=J.pointOnLine(D,C,n.length),e=J.perpendicularLineTo(D,d,40),T=J.perpendicularLineTo(d,D,20);return{connector:m,head:D,tail:d,headLine:T,tailLine:e,minX:Math.min(D.x,d.x,T[0].x,T[1].x),minY:Math.min(D.y,d.y,T[0].y,T[1].y),maxX:Math.max(D.x,d.x,T[0].x,T[1].x),maxY:Math.max(D.y,d.y,T[0].y,T[1].y)}}},u.Overlays.Label=function(n){this.labelStyle=n.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var m=u.extend({create:function(){return u.createElement("div")}},n);if(u.Overlays.Custom.call(this,m),this.type="Label",this.label=n.label||"",this.labelText=null,this.labelStyle){var E=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",E.style.font=this.labelStyle.font,E.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(E.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){var D=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";E.style.border=this.labelStyle.borderWidth+"px solid "+D}this.labelStyle.padding&&(E.style.padding=this.labelStyle.padding)}},V.extend(u.Overlays.Label,u.Overlays.Custom,{cleanup:function(n){n&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(n){this.label=n,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),o.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var n=this.label(this);this.getElement().innerHTML=n.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(n){n.label!=null&&this.setLabel(n.label)}})}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumbUtil,V=q.jsPlumbInstance,J="jtk-group-collapsed",$="jtk-group-expanded",Q="[jtk-group-content]",h="elementDraggable",M="stop",o="revert",n="_groupManager",m="_jsPlumbGroup",E="_jsPlumbGroupDrag",D="group:addMember",C="group:removeMember",d="group:add",e="group:remove",T="group:expand",I="group:collapse",R="groupDragStop",L="connectionMoved",_="internal.connectionDetached",S="removeAll",s="orphanAll",f="show",a="hide",P=function(c){var j={},v={},w={},p=this;function x(t,g){for(var y=c.getContainer(),N=!1;!N;){if(t==null||t===y)return!1;if(t===g)return!0;t=t.parentNode}}c.bind("connection",function(t){var g=c.getGroupFor(t.source),y=c.getGroupFor(t.target);g!=null&&y!=null&&g===y?(v[t.connection.id]=g,w[t.connection.id]=g):(g!=null&&(u.suggest(g.connections.source,t.connection),v[t.connection.id]=g),y!=null&&(u.suggest(y.connections.target,t.connection),w[t.connection.id]=y))});function U(t){delete t.proxies;var g=v[t.id],y;g!=null&&(y=function(N){return N.id===t.id},u.removeWithFunction(g.connections.source,y),u.removeWithFunction(g.connections.target,y),delete v[t.id]),g=w[t.id],g!=null&&(y=function(N){return N.id===t.id},u.removeWithFunction(g.connections.source,y),u.removeWithFunction(g.connections.target,y),delete w[t.id])}c.bind(_,function(t){U(t.connection)}),c.bind(L,function(t){var g=t.index===0?v:w,y=g[t.connection.id];if(y){var N=y.connections[t.index===0?"source":"target"],F=N.indexOf(t.connection);F!==-1&&N.splice(F,1)}}),this.addGroup=function(t){c.addClass(t.getEl(),$),j[t.id]=t,t.manager=this,l(t),c.fire(d,{group:t})},this.addToGroup=function(t,g,y){if(t=this.getGroup(t),t){var N=t.getEl();if(g._isJsPlumbGroup)return;var F=g._jsPlumbGroup;if(F!==t){c.removeFromDragSelection(g);var X=c.getOffset(g,!0),G=t.collapsed?c.getOffset(N,!0):c.getOffset(t.getDragArea(),!0);F!=null&&(F.remove(g,!1,y,!1,t),p.updateConnectionsForGroup(F)),t.add(g,y);var W=function(rt,gt){var pt=gt===0?1:0;rt.each(function(lt){lt.setVisible(!1),lt.endpoints[pt].element._jsPlumbGroup===t?(lt.endpoints[pt].setVisible(!1),i(lt,pt,t)):(lt.endpoints[gt].setVisible(!1),Y(lt,gt,t))})};t.collapsed&&(W(c.select({source:g}),0),W(c.select({target:g}),1));var at=c.getId(g);c.dragManager.setParent(g,at,N,c.getId(N),X);var st={left:X.left-G.left,top:X.top-G.top};if(c.setPosition(g,st),c.dragManager.revalidateParent(g,at,X),p.updateConnectionsForGroup(t),c.revalidate(at),!y){var it={group:t,el:g,pos:st};F&&(it.sourceGroup=F),c.fire(D,it)}}}},this.removeFromGroup=function(t,g,y){if(t=this.getGroup(t),t){if(t.collapsed){var N=function(F,X){for(var G=0;G<F.length;G++){var W=F[G];if(W.proxies){for(var at=0;at<W.proxies.length;at++)if(W.proxies[at]!=null){var st=W.proxies[at].originalEp.element;(st===g||x(st,g))&&i(W,X,t)}}}};N(t.connections.source.slice(),0),N(t.connections.target.slice(),1)}t.remove(g,null,y)}},this.getGroup=function(t){var g=t;if(u.isString(t)&&(g=j[t],g==null))throw new TypeError("No such group ["+t+"]");return g},this.getGroups=function(){var t=[];for(var g in j)t.push(j[g]);return t},this.removeGroup=function(t,g,y,N){t=this.getGroup(t),this.expandGroup(t,!0);var F=t[g?S:s](y,N);return c.remove(t.getEl()),delete j[t.id],delete c._groups[t.id],c.fire(e,{group:t}),F},this.removeAllGroups=function(t,g,y){for(var N in j)this.removeGroup(j[N],t,g,y)};function B(t,g){for(var y=t.getEl().querySelectorAll(".jtk-managed"),N=0;N<y.length;N++)c[g?f:a](y[N],!0)}var Y=function(t,g,y){var N=t.endpoints[g===0?1:0].element;if(!(N[m]&&!N[m].shouldProxy()&&N[m].collapsed)){var F=y.getEl(),X=c.getId(F);c.proxyConnection(t,g,F,X,function(G,W){return y.getEndpoint(G,W)},function(G,W){return y.getAnchor(G,W)})}};this.collapseGroup=function(t){if(t=this.getGroup(t),!(t==null||t.collapsed)){var g=t.getEl();if(B(t,!1),t.shouldProxy()){var y=function(N,F){for(var X=0;X<N.length;X++){var G=N[X];Y(G,F,t)}};y(t.connections.source,0),y(t.connections.target,1)}t.collapsed=!0,c.removeClass(g,$),c.addClass(g,J),c.revalidate(g),c.fire(I,{group:t})}};var i=function(t,g,y){c.unproxyConnection(t,g,c.getId(y.getEl()))};this.expandGroup=function(t,g){if(t=this.getGroup(t),!(t==null||!t.collapsed)){var y=t.getEl();if(B(t,!0),t.shouldProxy()){var N=function(F,X){for(var G=0;G<F.length;G++){var W=F[G];i(W,X,t)}};N(t.connections.source,0),N(t.connections.target,1)}t.collapsed=!1,c.addClass(y,$),c.removeClass(y,J),c.revalidate(y),this.repaintGroup(t),g||c.fire(T,{group:t})}},this.repaintGroup=function(t){t=this.getGroup(t);for(var g=t.getMembers(),y=0;y<g.length;y++)c.revalidate(g[y])};function l(t){for(var g=t.getMembers().slice(),y=[],N=0;N<g.length;N++)Array.prototype.push.apply(y,g[N].querySelectorAll(".jtk-managed"));Array.prototype.push.apply(g,y);var F=c.getConnections({source:g,scope:"*"},!0),X=c.getConnections({target:g,scope:"*"},!0),G={};t.connections.source.length=0,t.connections.target.length=0;var W=function(at){for(var st=0;st<at.length;st++)if(!G[at[st].id]){G[at[st].id]=!0;var it=c.getGroupFor(at[st].source),rt=c.getGroupFor(at[st].target);it===t?(rt!==t&&t.connections.source.push(at[st]),v[at[st].id]=t):rt===t&&(t.connections.target.push(at[st]),w[at[st].id]=t)}};W(F),W(X)}this.updateConnectionsForGroup=l,this.refreshAllGroups=function(){for(var t in j)l(j[t]),c.dragManager.updateOffsets(c.getId(j[t].getEl()))}},k=function(c,j){var v=this,w=j.el;this.getEl=function(){return w},this.id=j.id||u.uuid(),w._isJsPlumbGroup=!0;var p=this.getDragArea=function(){var rt=c.getSelector(w,Q);return rt&&rt.length>0?rt[0]:w},x=j.ghost===!0,U=x||j.constrain===!0,B=j.revert!==!1,Y=j.orphan===!0,i=j.prune===!0,l=j.dropOverride===!0,t=j.proxied!==!1,g=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(rt,gt){return j.anchor||"Continuous"},this.getEndpoint=function(rt,gt){return j.endpoint||["Dot",{radius:10}]},this.collapsed=!1,j.draggable!==!1){var y={drag:function(){for(var rt=0;rt<g.length;rt++)c.draw(g[rt])},stop:function(rt){c.fire(R,jsPlumb.extend(rt,{group:v}))},scope:E};j.dragOptions&&q.jsPlumb.extend(y,j.dragOptions),c.draggable(j.el,y)}j.droppable!==!1&&c.droppable(j.el,{drop:function(rt){var gt=rt.drag.el;if(!gt._isJsPlumbGroup){var pt=gt._jsPlumbGroup;if(pt!==v){if(pt!=null&&pt.overrideDrop(gt,v))return;c.getGroupManager().addToGroup(v,gt,!1)}}}});var N=function(rt,gt){for(var pt=rt.nodeType==null?rt:[rt],lt=0;lt<pt.length;lt++)gt(pt[lt])};this.overrideDrop=function(rt,gt){return l&&(B||i||Y)},this.add=function(rt,gt){var pt=p();N(rt,function(lt){if(lt._jsPlumbGroup!=null){if(lt._jsPlumbGroup===v)return;lt._jsPlumbGroup.remove(lt,!0,gt,!1)}lt._jsPlumbGroup=v,g.push(lt),c.isAlreadyDraggable(lt)&&it(lt),lt.parentNode!==pt&&pt.appendChild(lt)}),c.getGroupManager().updateConnectionsForGroup(v)},this.remove=function(rt,gt,pt,lt,_t){N(rt,function(vt){if(vt._jsPlumbGroup===v){if(delete vt._jsPlumbGroup,u.removeWithFunction(g,function(K){return K===vt}),gt)try{v.getDragArea().removeChild(vt)}catch(K){jsPlumbUtil.log("Could not remove element from Group "+K)}if(st(vt),!pt){var Z={group:v,el:vt};_t&&(Z.targetGroup=_t),c.fire(C,Z)}}}),lt||c.getGroupManager().updateConnectionsForGroup(v)},this.removeAll=function(rt,gt){for(var pt=0,lt=g.length;pt<lt;pt++){var _t=g[0];v.remove(_t,rt,gt,!0),c.remove(_t,!0)}g.length=0,c.getGroupManager().updateConnectionsForGroup(v)},this.orphanAll=function(){for(var rt={},gt=0;gt<g.length;gt++){var pt=G(g[gt]);rt[pt[0]]=pt[1]}return g.length=0,rt},this.getMembers=function(){return g},w[m]=this,c.bind(h,(function(rt){rt.el._jsPlumbGroup===this&&it(rt.el)}).bind(this));function F(rt){return rt.offsetParent}function X(rt,gt){var pt=F(rt),lt=c.getSize(pt),_t=c.getSize(rt),vt=gt[0],Z=vt+_t[0],K=gt[1],tt=K+_t[1];return Z>0&&vt<lt[0]&&tt>0&&K<lt[1]}function G(rt){var gt=c.getId(rt),pt=c.getOffset(rt);return rt.parentNode.removeChild(rt),c.getContainer().appendChild(rt),c.setPosition(rt,pt),st(rt),c.dragManager.clearParent(rt,gt),[gt,pt]}function W(rt){var gt=[];function pt(_t,vt,Z){var K=null;if(!X(_t,[vt,Z])){var tt=_t._jsPlumbGroup;i?c.remove(_t):K=G(_t),tt.remove(_t)}return K}for(var lt=0;lt<rt.selection.length;lt++)gt.push(pt(rt.selection[lt][0],rt.selection[lt][1].left,rt.selection[lt][1].top));return gt.length===1?gt[0]:gt}function at(rt){var gt=c.getId(rt);c.revalidate(rt),c.dragManager.revalidateParent(rt,gt)}function st(rt){rt._katavorioDrag&&((i||Y)&&rt._katavorioDrag.off(M,W),!i&&!Y&&B&&(rt._katavorioDrag.off(o,at),rt._katavorioDrag.setRevert(null)))}function it(rt){rt._katavorioDrag&&((i||Y)&&rt._katavorioDrag.on(M,W),U&&rt._katavorioDrag.setConstrain(!0),x&&rt._katavorioDrag.setUseGhostProxy(!0),!i&&!Y&&B&&(rt._katavorioDrag.on(o,at),rt._katavorioDrag.setRevert(function(gt,pt){return!X(gt,pt)})))}this.shouldProxy=function(){return t},c.getGroupManager().addGroup(this)};V.prototype.addGroup=function(c){var j=this;if(j._groups=j._groups||{},j._groups[c.id]!=null)throw new TypeError("cannot create Group ["+c.id+"]; a Group with that ID exists");if(c.el[m]!=null)throw new TypeError("cannot create Group ["+c.id+"]; the given element is already a Group");var v=new k(j,c);return j._groups[v.id]=v,c.collapsed&&this.collapseGroup(v),v},V.prototype.addToGroup=function(c,j,v){var w=(function(x){var U=this.getId(x);this.manage(U,x),this.getGroupManager().addToGroup(c,x,v)}).bind(this);if(Array.isArray(j))for(var p=0;p<j.length;p++)w(j[p]);else w(j)},V.prototype.removeFromGroup=function(c,j,v){this.getGroupManager().removeFromGroup(c,j,v),this.getContainer().appendChild(j)},V.prototype.removeGroup=function(c,j,v,w){return this.getGroupManager().removeGroup(c,j,v,w)},V.prototype.removeAllGroups=function(c,j,v){this.getGroupManager().removeAllGroups(c,j,v)},V.prototype.getGroup=function(c){return this.getGroupManager().getGroup(c)},V.prototype.getGroups=function(){return this.getGroupManager().getGroups()},V.prototype.expandGroup=function(c){this.getGroupManager().expandGroup(c)},V.prototype.collapseGroup=function(c){this.getGroupManager().collapseGroup(c)},V.prototype.repaintGroup=function(c){this.getGroupManager().repaintGroup(c)},V.prototype.toggleGroup=function(c){c=this.getGroupManager().getGroup(c),c!=null&&this.getGroupManager()[c.collapsed?"expandGroup":"collapseGroup"](c)},V.prototype.getGroupManager=function(){var c=this[n];return c==null&&(c=this[n]=new P(this)),c},V.prototype.removeGroupManager=function(){delete this[n]},V.prototype.getGroupFor=function(c){if(c=this.getElement(c),c){for(var j=this.getContainer(),v=!1,w=null;!v;)c==null||c===j?v=!0:c[m]?(w=c[m],v=!0):c=c.parentNode;return w}}}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J="Straight",$="Arc",Q=function(h){this.type="Flowchart",h=h||{},h.stub=h.stub==null?30:h.stub;var M,o=u.Connectors.AbstractConnector.apply(this,arguments),n=h.midpoint==null||isNaN(h.midpoint)?.5:h.midpoint,m=h.alwaysRespectStubs===!0,E=null,D=null,C=h.cornerRadius!=null?h.cornerRadius:0;h.loopbackRadius;var d=function(_){return _<0?-1:_===0?0:1},e=function(_){return[d(_[2]-_[0]),d(_[3]-_[1])]},T=function(_,S,s,f){if(!(E===S&&D===s)){var a=E??f.sx,P=D??f.sy,k=a===S?"v":"h";E=S,D=s,_.push([a,P,S,s,k])}},I=function(_){return Math.sqrt(Math.pow(_[0]-_[2],2)+Math.pow(_[1]-_[3],2))},R=function(_){var S=[];return S.push.apply(S,_),S},L=function(_,S,s){for(var f=null,a,P,k,c=0;c<S.length-1;c++){if(f=f||R(S[c]),a=R(S[c+1]),P=e(f),k=e(a),C>0&&f[4]!==a[4]){var j=Math.min(I(f),I(a)),v=Math.min(C,j/2);f[2]-=P[0]*v,f[3]-=P[1]*v,a[0]+=k[0]*v,a[1]+=k[1]*v;var w=P[1]===k[0]&&k[0]===1||P[1]===k[0]&&k[0]===0&&P[0]!==k[1]||P[1]===k[0]&&k[0]===-1,p=a[1]>f[3]?1:-1,x=a[0]>f[2]?1:-1,U=p===x,B=U&&w||!U&&!w?a[0]:f[2],Y=U&&w||!U&&!w?f[3]:a[1];o.addSegment(_,J,{x1:f[0],y1:f[1],x2:f[2],y2:f[3]}),o.addSegment(_,$,{r:v,x1:f[2],y1:f[3],x2:a[0],y2:a[1],cx:B,cy:Y,ac:w})}else{var i=f[2]===f[0]?0:f[2]>f[0]?s.lw/2:-(s.lw/2),l=f[3]===f[1]?0:f[3]>f[1]?s.lw/2:-(s.lw/2);o.addSegment(_,J,{x1:f[0]-i,y1:f[1]-l,x2:f[2]+i,y2:f[3]+l})}f=a}a!=null&&o.addSegment(_,J,{x1:a[0],y1:a[1],x2:a[2],y2:a[3]})};this.midpoint=n,this._compute=function(_,S){M=[],E=null,D=null;var s=function(){return[_.startStubX,_.startStubY,_.endStubX,_.endStubY]},f={perpendicular:s,orthogonal:s,opposite:function(l){var t=_,g=l==="x"?0:1,y={x:function(){return t.so[g]===1&&(t.startStubX>t.endStubX&&t.tx>t.startStubX||t.sx>t.endStubX&&t.tx>t.sx)||t.so[g]===-1&&(t.startStubX<t.endStubX&&t.tx<t.startStubX||t.sx<t.endStubX&&t.tx<t.sx)},y:function(){return t.so[g]===1&&(t.startStubY>t.endStubY&&t.ty>t.startStubY||t.sy>t.endStubY&&t.ty>t.sy)||t.so[g]===-1&&(t.startStubY<t.endStubY&&t.ty<t.startStubY||t.sy<t.endStubY&&t.ty<t.sy)}};return!m&&y[l]()?{x:[(_.sx+_.tx)/2,_.startStubY,(_.sx+_.tx)/2,_.endStubY],y:[_.startStubX,(_.sy+_.ty)/2,_.endStubX,(_.sy+_.ty)/2]}[l]:[_.startStubX,_.startStubY,_.endStubX,_.endStubY]}},a=f[_.anchorOrientation](_.sourceAxis),P=_.sourceAxis==="x"?0:1,k=_.sourceAxis==="x"?1:0,c=a[P],j=a[k],v=a[P+2],w=a[k+2];T(M,a[0],a[1],_);var p=_.startStubX+(_.endStubX-_.startStubX)*n,x=_.startStubY+(_.endStubY-_.startStubY)*n,U={x:[0,1],y:[1,0]},B={perpendicular:function(l){var t=_,g={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},y={x:[[t.startStubX,t.endStubX],null,[t.endStubX,t.startStubX]],y:[[t.startStubY,t.endStubY],null,[t.endStubY,t.startStubY]]},N={x:[[p,t.startStubY],[p,t.endStubY]],y:[[t.startStubX,x],[t.endStubX,x]]},F={x:[[t.endStubX,t.startStubY]],y:[[t.startStubX,t.endStubY]]},X={x:[[t.startStubX,t.endStubY],[t.endStubX,t.endStubY]],y:[[t.endStubX,t.startStubY],[t.endStubX,t.endStubY]]},G={x:[[t.startStubX,x],[t.endStubX,x],[t.endStubX,t.endStubY]],y:[[p,t.startStubY],[p,t.endStubY],[t.endStubX,t.endStubY]]},W={x:[t.startStubY,t.endStubY],y:[t.startStubX,t.endStubX]},at=U[l][0],st=U[l][1],it=t.so[at]+1,rt=t.to[st]+1,gt=t.to[st]===-1&&W[l][1]<W[l][0]||t.to[st]===1&&W[l][1]>W[l][0],pt=y[l][it][0],lt=y[l][it][1],_t=g[l][it][rt];if(t.segment===_t[3]||t.segment===_t[2]&&gt)return N[l];if(t.segment===_t[2]&&lt<pt)return F[l];if(t.segment===_t[2]&&lt>=pt||t.segment===_t[1]&&!gt)return G[l];if(t.segment===_t[0]||t.segment===_t[1]&&gt)return X[l]},orthogonal:function(l,t,g,y,N){var F=_,X={x:F.so[0]===-1?Math.min(t,y):Math.max(t,y),y:F.so[1]===-1?Math.min(t,y):Math.max(t,y)}[l];return{x:[[X,g],[X,N],[y,N]],y:[[g,X],[N,X],[N,y]]}[l]},opposite:function(l,t,g,y){var N=_,F={x:"y",y:"x"}[l],X={x:"height",y:"width"}[l],G=N["is"+l.toUpperCase()+"GreaterThanStubTimes2"];if(S.sourceEndpoint.elementId===S.targetEndpoint.elementId){var W=g+(1-S.sourceEndpoint.anchor[F])*S.sourceInfo[X]+o.maxStub;return{x:[[t,W],[y,W]],y:[[W,t],[W,y]]}[l]}else{if(!G||N.so[P]===1&&t>y||N.so[P]===-1&&t<y)return{x:[[t,x],[y,x]],y:[[p,t],[p,y]]}[l];if(N.so[P]===1&&t<y||N.so[P]===-1&&t>y)return{x:[[p,N.sy],[p,N.ty]],y:[[N.sx,x],[N.tx,x]]}[l]}}},Y=B[_.anchorOrientation](_.sourceAxis,c,j,v,w);if(Y)for(var i=0;i<Y.length;i++)T(M,Y[i][0],Y[i][1],_);T(M,a[2],a[3],_),T(M,_.tx,_.ty,_),L(this,M,_)}};u.Connectors.Flowchart=Q,V.extend(u.Connectors.Flowchart,u.Connectors.AbstractConnector)}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil;u.Connectors.AbstractBezierConnector=function($){$=$||{};var Q=$.showLoopback!==!1;$.curviness;var h=$.margin||5;$.proximityLimit;var M=$.orientation&&$.orientation==="clockwise",o=$.loopbackRadius||25,n;return this._compute=function(m,E){var D=E.sourcePos,C=E.targetPos,d=Math.abs(D[0]-C[0]),e=Math.abs(D[1]-C[1]);if(!Q||E.sourceEndpoint.elementId!==E.targetEndpoint.elementId)this._computeBezier(m,E,D,C,d,e);else{var T=E.sourcePos[0],I=E.sourcePos[1]-h,R=T,L=I-o,_=R-o,S=L-o;d=2*o,e=2*o,m.points[0]=_,m.points[1]=S,m.points[2]=d,m.points[3]=e,n.addSegment(this,"Arc",{loopback:!0,x1:T-_+4,y1:I-S,startAngle:0,endAngle:2*Math.PI,r:o,ac:!M,x2:T-_-4,y2:I-S,cx:R-_,cy:L-S})}},n=u.Connectors.AbstractConnector.apply(this,arguments),n},V.extend(u.Connectors.AbstractBezierConnector,u.Connectors.AbstractConnector);var J=function($){$=$||{},this.type="Bezier";var Q=u.Connectors.AbstractBezierConnector.apply(this,arguments),h=$.curviness||150,M=10;this.getCurviness=function(){return h},this._findControlPoint=function(o,n,m,E,D,C,d){var e=C[0]!==d[0]||C[1]===d[1],T=[];return e?(d[0]===0?T.push(m[0]<n[0]?o[0]+M:o[0]-M):T.push(o[0]+h*d[0]),d[1]===0?T.push(m[1]<n[1]?o[1]+M:o[1]-M):T.push(o[1]+h*C[1])):(C[0]===0?T.push(n[0]<m[0]?o[0]+M:o[0]-M):T.push(o[0]-h*C[0]),C[1]===0?T.push(n[1]<m[1]?o[1]+M:o[1]-M):T.push(o[1]+h*d[1])),T},this._computeBezier=function(o,n,m,E,D,C){var d,e,T=m[0]<E[0]?D:0,I=m[1]<E[1]?C:0,R=m[0]<E[0]?0:D,L=m[1]<E[1]?0:C;d=this._findControlPoint([T,I],m,E,n.sourceEndpoint,n.targetEndpoint,o.so,o.to),e=this._findControlPoint([R,L],E,m,n.targetEndpoint,n.sourceEndpoint,o.to,o.so),Q.addSegment(this,"Bezier",{x1:T,y1:I,x2:R,y2:L,cp1x:d[0],cp1y:d[1],cp2x:e[0],cp2y:e[1]})}};u.Connectors.Bezier=J,V.extend(J,u.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J=function(h,M,o,n){return h<=o&&n<=M?1:h<=o&&M<=n?2:o<=h&&n>=M?3:4},$=function(h,M,o,n,m,E,D,C,d){if(C<=d)return[h,M];if(o===1)return n[3]<=0&&m[3]>=1?[h+(n[2]<.5?-1*E:E),M]:n[2]>=1&&m[2]<=0?[h,M+(n[3]<.5?-1*D:D)]:[h+-1*E,M+-1*D];if(o===2)return n[3]>=1&&m[3]<=0?[h+(n[2]<.5?-1*E:E),M]:n[2]>=1&&m[2]<=0?[h,M+(n[3]<.5?-1*D:D)]:[h+E,M+-1*D];if(o===3)return n[3]>=1&&m[3]<=0?[h+(n[2]<.5?-1*E:E),M]:n[2]<=0&&m[2]>=1?[h,M+(n[3]<.5?-1*D:D)]:[h+-1*E,M+-1*D];if(o===4)return n[3]<=0&&m[3]>=1?[h+(n[2]<.5?-1*E:E),M]:n[2]<=0&&m[2]>=1?[h,M+(n[3]<.5?-1*D:D)]:[h+E,M+-1*D]},Q=function(h){h=h||{},this.type="StateMachine";var M=u.Connectors.AbstractBezierConnector.apply(this,arguments),o=h.curviness||10,n=h.margin||5,m=h.proximityLimit||80;h.orientation&&h.orientation;var E;this._computeBezier=function(D,C,d,e,T,I){var R=C.sourcePos[0]<C.targetPos[0]?0:T,L=C.sourcePos[1]<C.targetPos[1]?0:I,_=C.sourcePos[0]<C.targetPos[0]?T:0,S=C.sourcePos[1]<C.targetPos[1]?I:0;C.sourcePos[2]===0&&(R-=n),C.sourcePos[2]===1&&(R+=n),C.sourcePos[3]===0&&(L-=n),C.sourcePos[3]===1&&(L+=n),C.targetPos[2]===0&&(_-=n),C.targetPos[2]===1&&(_+=n),C.targetPos[3]===0&&(S-=n),C.targetPos[3]===1&&(S+=n);var s=(R+_)/2,f=(L+S)/2,a=J(R,L,_,S),P=Math.sqrt(Math.pow(_-R,2)+Math.pow(S-L,2)),k,c,j,v;E=$(s,f,a,C.sourcePos,C.targetPos,o,o,P,m),k=E[0],c=E[0],j=E[1],v=E[1],M.addSegment(this,"Bezier",{x1:_,y1:S,x2:R,y2:L,cp1x:k,cp1y:j,cp2x:c,cp2y:v})}};u.Connectors.StateMachine=Q,V.extend(Q,u.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J="Straight",$=function(Q){this.type=J;var h=u.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(M,o){h.addSegment(this,J,{x1:M.sx,y1:M.sy,x2:M.startStubX,y2:M.startStubY}),h.addSegment(this,J,{x1:M.startStubX,y1:M.startStubY,x2:M.endStubX,y2:M.endStubY}),h.addSegment(this,J,{x1:M.endStubX,y1:M.endStubY,x2:M.tx,y2:M.ty})}};u.Connectors.Straight=$,V.extend($,u.Connectors.AbstractConnector)}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},$="stroke-dasharray",Q="dashstyle",h="linearGradient",M="radialGradient",o="defs",n="fill",m="stop",E="stroke",D="stroke-width",C="style",d="none",e="jsplumb_gradient_",T="strokeWidth",I={svg:"http://www.w3.org/2000/svg"},R=function(v,w){for(var p in w)v.setAttribute(p,""+w[p])},L=function(v,w){return w=w||{},w.version="1.1",w.xmlns=I.svg,u.createElementNS(I.svg,v,null,null,w)},_=function(v){return"position:absolute;left:"+v[0]+"px;top:"+v[1]+"px"},S=function(v){for(var w=v.querySelectorAll(" defs,linearGradient,radialGradient"),p=0;p<w.length;p++)w[p].parentNode.removeChild(w[p])},s=function(v,w,p,x,U){var B=e+U._jsPlumb.instance.idstamp();S(v);var Y;p.gradient.offset?Y=L(M,{id:B}):Y=L(h,{id:B,gradientUnits:"userSpaceOnUse"});var i=L(o);v.appendChild(i),i.appendChild(Y);for(var l=0;l<p.gradient.stops.length;l++){var t=U.segment===1||U.segment===2?l:p.gradient.stops.length-1-l,g=p.gradient.stops[t][1],y=L(m,{offset:Math.floor(p.gradient.stops[l][0]*100)+"%","stop-color":g});Y.appendChild(y)}var N=p.stroke?E:n;w.setAttribute(N,"url(#"+B+")")},f=function(v,w,p,x,U){if(w.setAttribute(n,p.fill?p.fill:d),w.setAttribute(E,p.stroke?p.stroke:d),p.gradient?s(v,w,p,x,U):(S(v),w.setAttribute(C,"")),p.strokeWidth&&w.setAttribute(D,p.strokeWidth),p[Q]&&p[T]&&!p[$]){var B=p[Q].indexOf(",")===-1?" ":",",Y=p[Q].split(B),i="";Y.forEach(function(t){i+=Math.floor(t*p.strokeWidth)+B}),w.setAttribute($,i)}else p[$]&&w.setAttribute($,p[$]);for(var l in J)p[l]&&w.setAttribute(J[l],p[l])},a=function(v,w,p){v.childNodes.length>p?v.insertBefore(w,v.childNodes[p]):v.appendChild(w)};V.svg={node:L,attr:R,pos:_};var P=function(v){var w=v.pointerEventsSpec||"all",p={};u.jsPlumbUIComponent.apply(this,v.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var x=v.cssClass+" "+(v.originalArgs[0].cssClass||""),U={style:"",width:0,height:0,"pointer-events":w,position:"absolute"};this.svg=L("svg",U),v.useDivWrapper?(this.canvas=u.createElement("div",{position:"absolute"}),V.sizeElement(this.canvas,0,0,1,1),this.canvas.className=x):(R(this.svg,{class:x}),this.canvas=this.svg),v._jsPlumb.appendElement(this.canvas,v.originalArgs[0].parent),v.useDivWrapper&&this.canvas.appendChild(this.svg);var B=[this.canvas];return this.getDisplayElements=function(){return B},this.appendDisplayElement=function(Y){B.push(Y)},this.paint=function(Y,i,l){if(Y!=null){var t=[this.x,this.y],g=[this.w,this.h],y;l!=null&&(l.xmin<0&&(t[0]+=l.xmin),l.ymin<0&&(t[1]+=l.ymin),g[0]=l.xmax+(l.xmin<0?-l.xmin:0),g[1]=l.ymax+(l.ymin<0?-l.ymin:0)),v.useDivWrapper?(V.sizeElement(this.canvas,t[0],t[1],g[0]>0?g[0]:1,g[1]>0?g[1]:1),t[0]=0,t[1]=0,y=_([0,0])):y=_([t[0],t[1]]),p.paint.apply(this,arguments),R(this.svg,{style:y,width:g[0]||1,height:g[1]||1})}},{renderer:p}};V.extend(P,u.jsPlumbUIComponent,{cleanup:function(v){v||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null,this._jsPlumb=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(v){var w=v.getContainer();this.canvas&&this.canvas.parentNode==null&&w.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&w.appendChild(this.bgCanvas)},setVisible:function(v){this.canvas&&(this.canvas.style.display=v?"block":"none")}}),u.ConnectorRenderers.svg=function(v){var w=this,p=P.apply(this,[{cssClass:v._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:v._jsPlumb}]);p.renderer.paint=function(x,U,B){var Y=w.getSegments(),i="",l=[0,0];if(B.xmin<0&&(l[0]=-B.xmin),B.ymin<0&&(l[1]=-B.ymin),Y.length>0){i=w.getPathData();var t={d:i,transform:"translate("+l[0]+","+l[1]+")","pointer-events":v["pointer-events"]||"visibleStroke"},g=null,y=[w.x,w.y,w.w,w.h];if(x.outlineStroke){var N=x.outlineWidth||1,F=x.strokeWidth+2*N;g=u.extend({},x),delete g.gradient,g.stroke=x.outlineStroke,g.strokeWidth=F,w.bgPath==null?(w.bgPath=L("path",t),u.addClass(w.bgPath,u.connectorOutlineClass),a(w.svg,w.bgPath,0)):R(w.bgPath,t),f(w.svg,w.bgPath,g,y,w)}w.path==null?(w.path=L("path",t),a(w.svg,w.path,x.outlineStroke?1:0)):R(w.path,t),f(w.svg,w.path,x,y,w)}}},V.extend(u.ConnectorRenderers.svg,P);var k=u.SvgEndpoint=function(v){var w=P.apply(this,[{cssClass:v._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:v._jsPlumb}]);w.renderer.paint=(function(p){var x=u.extend({},p);x.outlineStroke&&(x.stroke=x.outlineStroke),this.node==null?(this.node=this.makeNode(x),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),f(this.svg,this.node,x,[this.x,this.y,this.w,this.h],this),_(this.node,[this.x,this.y])}).bind(this)};V.extend(k,P),u.Endpoints.svg.Dot=function(){u.Endpoints.Dot.apply(this,arguments),k.apply(this,arguments),this.makeNode=function(v){return L("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(v){R(v,{cx:this.w/2,cy:this.h/2,r:this.radius})}},V.extend(u.Endpoints.svg.Dot,[u.Endpoints.Dot,k]),u.Endpoints.svg.Rectangle=function(){u.Endpoints.Rectangle.apply(this,arguments),k.apply(this,arguments),this.makeNode=function(v){return L("rect",{width:this.w,height:this.h})},this.updateNode=function(v){R(v,{width:this.w,height:this.h})}},V.extend(u.Endpoints.svg.Rectangle,[u.Endpoints.Rectangle,k]),u.Endpoints.svg.Image=u.Endpoints.Image,u.Endpoints.svg.Blank=u.Endpoints.Blank,u.Overlays.svg.Label=u.Overlays.Label,u.Overlays.svg.Custom=u.Overlays.Custom;var c=function(v,w){v.apply(this,w),u.jsPlumbUIComponent.apply(this,w),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(x,U){if(x.component.svg&&U){this.path==null&&(this.path=L("path",{"pointer-events":"all"}),x.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,x.component),this.canvas=x.component.svg);var B=w&&w.length===1&&w[0].cssClass||"",Y=[0,0];U.xmin<0&&(Y[0]=-U.xmin),U.ymin<0&&(Y[1]=-U.ymin),R(this.path,{d:p(x.d),class:B,stroke:x.stroke?x.stroke:null,fill:x.fill?x.fill:null,transform:"translate("+Y[0]+","+Y[1]+")"})}};var p=function(x){return isNaN(x.cxy.x)||isNaN(x.cxy.y)?"":"M"+x.hxy.x+","+x.hxy.y+" L"+x.tail[0].x+","+x.tail[0].y+" L"+x.cxy.x+","+x.cxy.y+" L"+x.tail[1].x+","+x.tail[1].y+" L"+x.hxy.x+","+x.hxy.y};this.transfer=function(x){x.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),x.canvas.appendChild(this.path))}},j={cleanup:function(v){this.path!=null&&(v?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(v,w){this.path&&w.canvas&&w.canvas.appendChild(this.path)},setVisible:function(v){this.path!=null&&(this.path.style.display=v?"block":"none")}};V.extend(c,[u.jsPlumbUIComponent,u.Overlays.AbstractOverlay]),u.Overlays.svg.Arrow=function(){c.apply(this,[u.Overlays.Arrow,arguments])},V.extend(u.Overlays.svg.Arrow,[u.Overlays.Arrow,c],j),u.Overlays.svg.PlainArrow=function(){c.apply(this,[u.Overlays.PlainArrow,arguments])},V.extend(u.Overlays.svg.PlainArrow,[u.Overlays.PlainArrow,c],j),u.Overlays.svg.Diamond=function(){c.apply(this,[u.Overlays.Diamond,arguments])},V.extend(u.Overlays.svg.Diamond,[u.Overlays.Diamond,c],j),u.Overlays.svg.GuideLines=function(){var v=null,w=this,p,x;u.Overlays.GuideLines.apply(this,arguments),this.paint=function(B,Y){v==null&&(v=L("path"),B.connector.svg.appendChild(v),w.attachListeners(v,B.connector),w.attachListeners(v,w),p=L("path"),B.connector.svg.appendChild(p),w.attachListeners(p,B.connector),w.attachListeners(p,w),x=L("path"),B.connector.svg.appendChild(x),w.attachListeners(x,B.connector),w.attachListeners(x,w));var i=[0,0];Y.xmin<0&&(i[0]=-Y.xmin),Y.ymin<0&&(i[1]=-Y.ymin),R(v,{d:U(B.head,B.tail),stroke:"red",fill:null,transform:"translate("+i[0]+","+i[1]+")"}),R(p,{d:U(B.tailLine[0],B.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+i[0]+","+i[1]+")"}),R(x,{d:U(B.headLine[0],B.headLine[1]),stroke:"green",fill:null,transform:"translate("+i[0]+","+i[1]+")"})};var U=function(B,Y){return"M "+B.x+","+B.y+" L"+Y.x+","+Y.y}},V.extend(u.Overlays.svg.GuideLines,u.Overlays.GuideLines)}).call(typeof window<"u"?window:Ot),(function(){var q=this,u=q.jsPlumb,V=q.jsPlumbUtil,J=q.Katavorio,$=q.Biltong,Q=function(s){var f=s._mottle;return f||(f=s._mottle=new q.Mottle),f},h=function(s,f){f=f||"main";var a="_katavorio_"+f,P=s[a],k=s.getEventManager();return P||(P=new J({bind:k.on,unbind:k.off,getSize:u.getSize,getConstrainingRectangle:function(c){return[c.parentNode.scrollWidth,c.parentNode.scrollHeight]},getPosition:function(c,j){var v=s.getOffset(c,j,c._katavorioDrag?c.offsetParent:null);return[v.left,v.top]},setPosition:function(c,j){c.style.left=j[0]+"px",c.style.top=j[1]+"px"},addClass:u.addClass,removeClass:u.removeClass,intersects:$.intersects,indexOf:function(c,j){return c.indexOf(j)},scope:s.getDefaultScope(),css:{noSelect:s.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),P.setZoom(s.getZoom()),s[a]=P,s.bind("zoom",P.setZoom)),P},M=function(s){var f=s.el._jsPlumbDragOptions,a=!0;return f.canDrag&&(a=f.canDrag()),a&&(this.setHoverSuspended(!0),this.select({source:s.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:s.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),a},o=function(s){var f=this.getUIPosition(arguments,this.getZoom());if(f!=null){var a=s.el._jsPlumbDragOptions;this.draw(s.el,f,null,!0),a._dragging&&this.addClass(s.el,"jtk-dragged"),a._dragging=!0}},n=function(s){for(var f=s.selection,a,P=(function(c){var j;c[1]!=null&&(a=this.getUIPosition([{el:c[2].el,pos:[c[1].left,c[1].top]}]),j=this.draw(c[2].el,a)),c[0]._jsPlumbDragOptions!=null&&delete c[0]._jsPlumbDragOptions._dragging,this.removeClass(c[0],"jtk-dragged"),this.select({source:c[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:c[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),s.e._drawResult=s.e._drawResult||{c:[],e:[],a:[]},Array.prototype.push.apply(s.e._drawResult.c,j.c),Array.prototype.push.apply(s.e._drawResult.e,j.e),Array.prototype.push.apply(s.e._drawResult.a,j.a),this.getDragManager().dragEnded(c[2].el)}).bind(this),k=0;k<f.length;k++)P(f[k]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},m=function(s,f){var a=function(P){if(f[P]!=null)if(V.isString(f[P])){var k=f[P].match(/-=/)?-1:1,c=f[P].substring(2);return s[P]+k*c}else return f[P];else return s[P]};return[a("left"),a("top")]},E=function(s,f){if(f==null)return[0,0];var a=T(f),P=e(a,0);return[P[s+"X"],P[s+"Y"]]},D=E.bind(this,"page"),C=E.bind(this,"screen"),d=E.bind(this,"client"),e=function(s,f){return s.item?s.item(f):s[f]},T=function(s){return s.touches&&s.touches.length>0?s.touches:s.changedTouches&&s.changedTouches.length>0?s.changedTouches:s.targetTouches&&s.targetTouches.length>0?s.targetTouches:[s]},I=function(s){var f={},a=[],P={},k={},c={};this.register=function(j){var v=s.getId(j),w;f[v]||(f[v]=j,a.push(j),P[v]={});var p=function(x){if(x){for(var U=0;U<x.childNodes.length;U++)if(x.childNodes[U].nodeType!==3&&x.childNodes[U].nodeType!==8){var B=jsPlumb.getElement(x.childNodes[U]),Y=s.getId(x.childNodes[U],null,!0);if(Y&&k[Y]&&k[Y]>0){w||(w=s.getOffset(j));var i=s.getOffset(B);P[v][Y]={id:Y,offset:{left:i.left-w.left,top:i.top-w.top}},c[Y]=v}p(x.childNodes[U])}}};p(j)},this.updateOffsets=function(j,v){if(j!=null){v=v||{};var w=jsPlumb.getElement(j),p=s.getId(w),x=P[p],U;if(x){for(var B in x)if(x.hasOwnProperty(B)){var Y=jsPlumb.getElement(B),i=v[B]||s.getOffset(Y);if(Y.offsetParent==null&&P[p][B]!=null)continue;U||(U=s.getOffset(w)),P[p][B]={id:B,offset:{left:i.left-U.left,top:i.top-U.top}},c[B]=p}}}},this.endpointAdded=function(j,v){v=v||s.getId(j);var w=document.body,p=j.parentNode;for(k[v]=k[v]?k[v]+1:1;p!=null&&p!==w;){var x=s.getId(p,null,!0);if(x&&f[x]){var U=s.getOffset(p);if(P[x][v]==null){var B=s.getOffset(j);P[x][v]={id:v,offset:{left:B.left-U.left,top:B.top-U.top}},c[v]=x}break}p=p.parentNode}},this.endpointDeleted=function(j){if(k[j.elementId]&&(k[j.elementId]--,k[j.elementId]<=0))for(var v in P)P.hasOwnProperty(v)&&P[v]&&(delete P[v][j.elementId],delete c[j.elementId])},this.changeId=function(j,v){P[v]=P[j],P[j]={},c[v]=c[j],c[j]=null},this.getElementsForDraggable=function(j){return P[j]},this.elementRemoved=function(j){var v=c[j];v&&(P[v]&&delete P[v][j],delete c[j])},this.reset=function(){f={},a=[],P={},k={}},this.dragEnded=function(j){if(j.offsetParent!=null){var v=s.getId(j),w=c[v];w&&this.updateOffsets(w)}},this.setParent=function(j,v,w,p,x){var U=c[v];P[p]||(P[p]={});var B=s.getOffset(w),Y=x||s.getOffset(j);U&&P[U]&&delete P[U][v],P[p][v]={id:v,offset:{left:Y.left-B.left,top:Y.top-B.top}},c[v]=p},this.clearParent=function(j,v){var w=c[v];w&&(delete P[w][v],delete c[v])},this.revalidateParent=function(j,v,w){var p=c[v];if(p){var x={};x[v]=w,this.updateOffsets(p,x),s.revalidate(p)}},this.getDragAncestor=function(j){var v=jsPlumb.getElement(j),w=s.getId(v),p=c[w];return p?jsPlumb.getElement(p):null}},R=function(s,f,a){f=V.fastTrim(f),typeof s.className.baseVal<"u"?s.className.baseVal=f:s.className=f;try{var P=s.classList;if(P!=null){for(;P.length>0;)P.remove(P.item(0));for(var k=0;k<a.length;k++)a[k]&&P.add(a[k])}}catch(c){V.log("JSPLUMB: cannot set class list",c)}},L=function(s){return typeof s.className.baseVal>"u"?s.className:s.className.baseVal},_=function(s,f,a){f=f==null?[]:V.isArray(f)?f:f.split(/\s+/),a=a==null?[]:V.isArray(a)?a:a.split(/\s+/);var P=L(s),k=P.split(/\s+/),c=function(j,v){for(var w=0;w<v.length;w++)if(j)k.indexOf(v[w])===-1&&k.push(v[w]);else{var p=k.indexOf(v[w]);p!==-1&&k.splice(p,1)}};c(!0,f),c(!1,a),R(s,k.join(" "),k)};q.jsPlumb.extend(q.jsPlumbInstance.prototype,{headless:!1,pageLocation:D,screenLocation:C,clientLocation:d,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new I(this)),this.dragManager},recalculateOffsets:function(s){this.getDragManager().updateOffsets(s)},createElement:function(s,f,a,P){return this.createElementNS(null,s,f,a,P)},createElementNS:function(s,f,a,P,k){var c=s==null?document.createElement(f):document.createElementNS(s,f),j;a=a||{};for(j in a)c.style[j]=a[j];P&&(c.className=P),k=k||{};for(j in k)c.setAttribute(j,""+k[j]);return c},getAttribute:function(s,f){return s.getAttribute!=null?s.getAttribute(f):null},setAttribute:function(s,f,a){s.setAttribute!=null&&s.setAttribute(f,a)},setAttributes:function(s,f){for(var a in f)f.hasOwnProperty(a)&&s.setAttribute(a,f[a])},appendToRoot:function(s){document.body.appendChild(s)},getRenderModes:function(){return["svg"]},getClass:L,addClass:function(s,f){jsPlumb.each(s,function(a){_(a,f)})},hasClass:function(s,f){return s=jsPlumb.getElement(s),s.classList?s.classList.contains(f):L(s).indexOf(f)!==-1},removeClass:function(s,f){jsPlumb.each(s,function(a){_(a,null,f)})},toggleClass:function(s,f){jsPlumb.hasClass(s,f)?jsPlumb.removeClass(s,f):jsPlumb.addClass(s,f)},updateClasses:function(s,f,a){jsPlumb.each(s,function(P){_(P,f,a)})},setClass:function(s,f){f!=null&&jsPlumb.each(s,function(a){R(a,f,f.split(/\s+/))})},setPosition:function(s,f){s.style.left=f.left+"px",s.style.top=f.top+"px"},getPosition:function(s){var f=function(a){var P=s.style[a];return P?P.substring(0,P.length-2):0};return{left:f("left"),top:f("top")}},getStyle:function(s,f){return typeof window.getComputedStyle<"u"?getComputedStyle(s,null).getPropertyValue(f):s.currentStyle[f]},getSelector:function(s,f){var a=null;return arguments.length===1?a=s.nodeType!=null?s:document.querySelectorAll(s):a=s.querySelectorAll(f),a},getOffset:function(s,f,a){s=jsPlumb.getElement(s),a=a||this.getContainer();for(var P={left:s.offsetLeft,top:s.offsetTop},k=f||a!=null&&s!==a&&s.offsetParent!==a?s.offsetParent:null,c=(function(w){w!=null&&w!==document.body&&(w.scrollTop>0||w.scrollLeft>0)&&(P.left-=w.scrollLeft,P.top-=w.scrollTop)}).bind(this);k!=null;)P.left+=k.offsetLeft,P.top+=k.offsetTop,c(k),k=f?k.offsetParent:k.offsetParent===a?null:k.offsetParent;if(a!=null&&!f&&(a.scrollTop>0||a.scrollLeft>0)){var j=s.offsetParent!=null?this.getStyle(s.offsetParent,"position"):"static",v=this.getStyle(s,"position");v!=="absolute"&&v!=="fixed"&&j!=="absolute"&&j!=="fixed"&&(P.left-=a.scrollLeft,P.top-=a.scrollTop)}return P},getPositionOnElement:function(s,f,a){var P=typeof f.getBoundingClientRect<"u"?f.getBoundingClientRect():{left:0,top:0,width:0,height:0},k=document.body,c=document.documentElement,j=window.pageYOffset||c.scrollTop||k.scrollTop,v=window.pageXOffset||c.scrollLeft||k.scrollLeft,w=c.clientTop||k.clientTop||0,p=c.clientLeft||k.clientLeft||0,x=0,U=0,B=P.top+j-w+x*a,Y=P.left+v-p+U*a,i=jsPlumb.pageLocation(s),l=P.width||f.offsetWidth*a,t=P.height||f.offsetHeight*a,g=(i[0]-Y)/l,y=(i[1]-B)/t;return[g,y]},getAbsolutePosition:function(s){var f=function(a){var P=s.style[a];if(P)return parseFloat(P.substring(0,P.length-2))};return[f("left"),f("top")]},setAbsolutePosition:function(s,f,a,P){a?this.animate(s,{left:"+="+(f[0]-a[0]),top:"+="+(f[1]-a[1])},P):(s.style.left=f[0]+"px",s.style.top=f[1]+"px")},getSize:function(s){return[s.offsetWidth,s.offsetHeight]},getWidth:function(s){return s.offsetWidth},getHeight:function(s){return s.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(s,f){var a;return s=V.isArray(s)||s.length!=null&&!V.isString(s)?s:[s],Array.prototype.slice.call(s).forEach((function(P){a=this.info(P),a.el&&this._initDraggableIfNecessary(a.el,!0,f,a.id,!0)}).bind(this)),this},snapToGrid:function(s,f,a){var P=[],k=(function(v){var w=this.info(v);if(w.el!=null&&w.el._katavorioDrag){var p=w.el._katavorioDrag.snap(f,a);this.revalidate(w.el),P.push([w.el,p])}}).bind(this);if(arguments.length===1||arguments.length===3)k(s,f,a);else{var c=this.getManagedElements();for(var j in c)k(j,arguments[0],arguments[1])}return P},initDraggable:function(s,f,a){h(this,a).draggable(s,f),s._jsPlumbDragOptions=f},destroyDraggable:function(s,f){h(this,f).destroyDraggable(s),s._jsPlumbDragOptions=null,s._jsPlumbRelatedElement=null},unbindDraggable:function(s,f,a,P){h(this,P).destroyDraggable(s,f,a)},setDraggable:function(s,f){return jsPlumb.each(s,(function(a){this.isDragSupported(a)&&(this._draggableStates[this.getAttribute(a,"id")]=f,this.setElementDraggable(a,f))}).bind(this))},_draggableStates:{},toggleDraggable:function(s){var f;return jsPlumb.each(s,(function(a){var P=this.getAttribute(a,"id");return f=this._draggableStates[P]==null?!1:this._draggableStates[P],f=!f,this._draggableStates[P]=f,this.setDraggable(a,f),f}).bind(this)),f},_initDraggableIfNecessary:function(s,f,a,P,k){if(!jsPlumb.headless){var c=f??!1;if(c&&jsPlumb.isDragSupported(s,this)){var j=a||this.Defaults.DragOptions;if(j=jsPlumb.extend({},j),jsPlumb.isAlreadyDraggable(s,this))a.force&&this.initDraggable(s,j);else{var v=jsPlumb.dragEvents.drag,w=jsPlumb.dragEvents.stop,p=jsPlumb.dragEvents.start;this.manage(P,s),j[p]=V.wrap(j[p],M.bind(this)),j[v]=V.wrap(j[v],o.bind(this)),j[w]=V.wrap(j[w],n.bind(this));var x=this.getId(s);this._draggableStates[x]=!0;var U=this._draggableStates[x];j.disabled=U==null?!1:!U,this.initDraggable(s,j),this.getDragManager().register(s),k&&this.fire("elementDraggable",{el:s,options:j})}}}},animationSupported:!0,getElement:function(s){return s==null?null:(s=typeof s=="string"?s:s.tagName==null&&s.length!=null&&s.enctype==null?s[0]:s,typeof s=="string"?document.getElementById(s):s)},removeElement:function(s){h(this).elementRemoved(s),this.getEventManager().remove(s)},doAnimate:function(s,f,a){a=a||{};var P=this.getOffset(s),k=m(P,f),c=k[0]-P.left,j=k[1]-P.top,v=a.duration||250,w=15,p=v/w,x=w/v*c,U=w/v*j,B=0,Y=setInterval(function(){u.setPosition(s,{left:P.left+x*(B+1),top:P.top+U*(B+1)}),a.step!=null&&a.step(B,Math.ceil(p)),B++,B>=p&&(window.clearInterval(Y),a.complete!=null&&a.complete())},w)},destroyDroppable:function(s,f){h(this,f).destroyDroppable(s)},unbindDroppable:function(s,f,a,P){h(this,P).destroyDroppable(s,f,a)},droppable:function(s,f){s=V.isArray(s)||s.length!=null&&!V.isString(s)?s:[s];var a;return f=f||{},f.allowLoopback=!1,Array.prototype.slice.call(s).forEach((function(P){a=this.info(P),a.el&&this.initDroppable(a.el,f)}).bind(this)),this},initDroppable:function(s,f,a){h(this,a).droppable(s,f)},isAlreadyDraggable:function(s){return s._katavorioDrag!=null},isDragSupported:function(s,f){return!0},isDropSupported:function(s,f){return!0},isElementDraggable:function(s){return s=u.getElement(s),s._katavorioDrag&&s._katavorioDrag.isEnabled()},getDragObject:function(s){return s[0].drag.getDragElement()},getDragScope:function(s){return s._katavorioDrag&&s._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(s){return s[0].e},getUIPosition:function(s,f){var a=s[0].el;if(a.offsetParent==null)return null;var P=s[0].finalPos||s[0].pos,k={left:P[0],top:P[1]};if(a._katavorioDrag&&a.offsetParent!==this.getContainer()){var c=this.getOffset(a.offsetParent);k.left+=c.left,k.top+=c.top}return k},setDragFilter:function(s,f,a){s._katavorioDrag&&s._katavorioDrag.setFilter(f,a)},setElementDraggable:function(s,f){s=u.getElement(s),s._katavorioDrag&&s._katavorioDrag.setEnabled(f)},setDragScope:function(s,f){s._katavorioDrag&&s._katavorioDrag.k.setDragScope(s,f)},setDropScope:function(s,f){s._katavorioDrop&&s._katavorioDrop.length>0&&s._katavorioDrop[0].k.setDropScope(s,f)},addToPosse:function(s,f){var a=Array.prototype.slice.call(arguments,1),P=h(this);u.each(s,function(k){k=[u.getElement(k)],k.push.apply(k,a),P.addToPosse.apply(P,k)})},setPosse:function(s,f){var a=Array.prototype.slice.call(arguments,1),P=h(this);u.each(s,function(k){k=[u.getElement(k)],k.push.apply(k,a),P.setPosse.apply(P,k)})},removeFromPosse:function(s,f){var a=Array.prototype.slice.call(arguments,1),P=h(this);u.each(s,function(k){k=[u.getElement(k)],k.push.apply(k,a),P.removeFromPosse.apply(P,k)})},removeFromAllPosses:function(s){var f=h(this);u.each(s,function(a){f.removeFromAllPosses(u.getElement(a))})},setPosseState:function(s,f,a){var P=h(this);u.each(s,function(k){P.setPosseState(u.getElement(k),f,a)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(s){s._katavorioDrag&&s._katavorioDrag.abort()},addToDragSelection:function(s){var f=this.getElement(s);f!=null&&(f._isJsPlumbGroup||f._jsPlumbGroup==null)&&h(this).select(s)},removeFromDragSelection:function(s){h(this).deselect(s)},getDragSelection:function(){return h(this).getSelection()},clearDragSelection:function(){h(this).deselectAll()},trigger:function(s,f,a,P){this.getEventManager().trigger(s,f,a,P)},doReset:function(){for(var s in this)s.indexOf("_katavorio_")===0&&this[s].reset()},getEventManager:function(){return Q(this)},on:function(s,f,a){return this.getEventManager().on.apply(this,arguments),this},off:function(s,f,a){return this.getEventManager().off.apply(this,arguments),this}});var S=function(s){var f=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?s():setTimeout(f,9)};f()};S(u.init)}).call(typeof window<"u"?window:Ot)})(Ae);const en={class:"line"},nn={id:"container",style:{display:"flex","justify-content":"space-between",position:"relative"}},sn={style:{position:"fixed",right:"40px",bottom:"30px","z-index":"2"}},rn=Se({__name:"Transform",props:{colObject:{type:Object,default:null}},emits:["sendData"],setup(Rt,{emit:q}){const u=Rt;Re(()=>{V.value=u.colObject.excelColList,J.value=u.colObject.dataColList}),Ge(()=>{$()});const V=se([]),J=se([]),$=()=>{console.log("初始化jsplumb"),Ae.jsPlumb.ready(function(){h(),M(),m()})};var Q=Qt(null);function h(){Q=Ae.jsPlumb.getInstance({Connector:"Straight",PaintStyle:{strokeWidth:3,stroke:"#dfbee7"},Endpoint:["Blank",{radius:1}],anchor:"Right",Overlays:[["Arrow",{width:12,length:12,location:1}]],HoverPaintStyle:{stroke:"#000000"},EndpointStyle:{fill:"#000000"},ConnectionsDetachable:!0,Container:"container",ListStyle:{endpoint:["Rectangle",{width:30,height:30}]}})}function M(){const R=document.querySelectorAll(".leftRow"),L=document.querySelectorAll(".rightRow");Q.batch(function(){[R,L].forEach((_,S)=>{_.forEach(s=>{const f=E(s.classList[2]);if(S===0){const a=V.value.find(P=>P.id==f);!(a!=null&&a.hasChild)&&Q.makeSource(s,{allowLoopback:!1,anchor:["Right"],maxConnections:1})}else{const a=J.value.find(P=>P.id==f);!(a!=null&&a.hasChild)&&Q.makeTarget(s,{anchor:["Left"],maxConnections:1})}})})})}var o=Qt([]);function n(R){setTimeout(()=>{R.forEach(function(L){Q.connect({source:document.querySelector(`.lId-${L.sourceId}`),target:document.querySelector(`.rId-${L.targetId}`)})})})}function m(){Q.bind("connection",function(R,L){console.log(R.source.classList[2],R.target.classList[2])}),Q.bind("click",function(R,L){console.log(R.source.classList[2],R.target.classList[2]),Q.deleteConnection(R)})}const E=R=>R.slice(R.indexOf("-")+1),D=()=>{e();let R=V.value.length>J.value.length?V.value.length:J.value.length,L=new Map,_=new Map,S=new Map;for(let s=0;s<R-1;s++){if(V.value.length-1>=s){let f=V.value[s];_.set(f.colName,s),L.has(f.colName)&&!S.has(s)&&S.set(s,L.get(f.colName))}if(J.value.length-1>=s){let f=J.value[s];L.set(f.columnName,s);let a=_.get(f.columnName);_.has(f.columnName)&&!S.has(s)&&S.set(a,s)}}console.log(S),S.forEach(function(s,f){o.push({sourceId:f,targetId:s})}),n(o)},C=()=>{e();let R=V.value.length>J.value.length?J.value.length:V.value.length;for(let L=0;L<R;L++)o.push({sourceId:L,targetId:L});n(o)},d=()=>{e();let R=V.value.length>J.value.length?V.value.length:J.value.length,L=new Map,_=new Map,S=new Map;for(let s=0;s<R-1;s++){if(V.value.length-1>=s){let f=V.value[s];_.set(f.colName,s),L.has(f.colName)&&!S.has(s)&&S.set(s,L.get(f.colName))}if(J.value.length-1>=s){let f=J.value[s];L.set(f.columnRemarks,s);let a=_.get(f.columnRemarks);_.has(f.columnRemarks)&&!S.has(s)&&S.set(a,s)}}S.forEach(function(s,f){o.push({sourceId:f,targetId:s})}),n(o)},e=()=>{Q.deleteEveryConnection(),o=Qt([]),console.log(o)},T=q,I=()=>{const R=Qt([]);Q.getAllConnections().forEach(function(L){console.log(L.source.classList[2],L.target.classList[2]),R.push({sourceId:E(L.source.classList[2]),targetId:E(L.target.classList[2])})}),T("sendData",R)};return(R,L)=>{const _=At("el-link"),S=At("el-table-column"),s=At("el-table"),f=At("el-button");return Gt(),ae(le,null,[Ut("div",en,[ut(_,{type:"primary",onclick:C},{default:yt(()=>L[1]||(L[1]=[Yt("同行映射")])),_:1}),ut(_,{type:"primary",onclick:D},{default:yt(()=>L[2]||(L[2]=[Yt("同名映射")])),_:1}),ut(_,{type:"primary",onclick:d},{default:yt(()=>L[3]||(L[3]=[Yt("备注映射")])),_:1}),ut(_,{type:"warning",onclick:e},{default:yt(()=>L[4]||(L[4]=[Yt("取消映射")])),_:1}),Ut("div",nn,[ut(s,{data:V.value,"row-class-name":({row:a,rowIndex:P})=>`leftRow lId-${P}`,style:{width:"40%","margin-bottom":"20px",display:"inline-block"}},{default:yt(()=>[ut(S,{label:"行号"},{default:yt(a=>[Ut("span",null,xe(a.$index),1)]),_:1}),ut(S,{prop:"colNum",label:"序号"}),ut(S,{prop:"colName",label:"列名称","min-width":"70px"})]),_:1},8,["data","row-class-name"]),ut(s,{data:J.value,"row-class-name":({row:a,rowIndex:P})=>`rightRow rId-${P}`,style:{width:"45%","margin-bottom":"20px"}},{default:yt(()=>[ut(S,{label:"行号"},{default:yt(a=>[Ut("span",null,xe(a.$index),1)]),_:1}),ut(S,{prop:"columnName",label:"名称","min-width":"100px"}),ut(S,{prop:"columnType",label:"类型","min-width":"90px"}),ut(S,{prop:"columnRemarks",label:"备注"})]),_:1},8,["data","row-class-name"])])]),Ut("div",sn,[ut(f,{type:"primary",onClick:L[0]||(L[0]=a=>I())},{default:yt(()=>L[5]||(L[5]=[Yt("下一步")])),_:1})])],64)}}}),on=De(rn,[["__scopeId","data-v-65fdc121"]]),an=Se({__name:"Add",setup(Rt){const q=Qt({fileName:"",tableName:"",sheetName:"",headerNum:"",startRowNum:"",totalRowNum:"",removeEndNum:"",storePath:"",list:[],dsId:"",taskId:""}),u=Qt({sourceColumn:"",sourceColumnNum:"",targetColumn:"",transformType:"",configValue:""}),V=Qt({excelColList:[],dataColList:[]});function J(o){q.sheetName=o.sheetName,q.fileName=o.fileName,q.storePath=o.storePath,q.startRowNum=o.startRowNum,q.totalRowNum=o.totalRowNum,q.headerNum=o.headerNum,q.removeEndNum=o.removeEndNum,V.excelColList=o.colList,console.log("excel返回数据"),M()}function $(o){V.dataColList=o.colList,q.dsId=o.dsId,q.tableName=o.tableName,console.log("数据源返回数据"),M()}function Q(o){console.log(o);for(let n=0;n<o.length;n++){let m=o[n].sourceId,E=o[n].targetId;u.sourceColumnNum=m,u.sourceColumn=V.excelColList[m].colName,u.transformType=V.excelColList[m].transformType,u.configValue=V.excelColList[m].configValue,u.targetColumn=V.dataColList[E].columnName,q.list.push({...u})}Ye(q).then(n=>{console.log(n),q.taskId=n.data,M()})}const h=se(0),M=()=>{h.value++>3&&(h.value=0)};return(o,n)=>{const m=At("el-step"),E=At("el-steps"),D=At("el-main"),C=At("el-container");return Gt(),te(C,{direction:"vertical",class:"container"},{default:yt(()=>[ut(D,null,{default:yt(()=>[ut(E,{active:h.value,"align-center":""},{default:yt(()=>[ut(m,{title:"上传"}),ut(m,{title:"数据源"}),ut(m,{title:"传输配置"}),ut(m,{title:"提交"})]),_:1},8,["active"]),de(Ut("div",null,[ut(Ze,{onSendData:J})],512),[[pe,h.value==0]]),de(Ut("div",null,[ut(tn,{onSendData:$})],512),[[pe,h.value==1]]),de(Ut("div",null,[h.value==2?(Gt(),te(on,{key:0,colObject:V,onSendData:Q},null,8,["colObject"])):we("",!0)],512),[[pe,h.value==2]]),de(Ut("div",null,[h.value==3?(Gt(),te(Be,{key:0,form:q},null,8,["form"])):we("",!0)],512),[[pe,h.value==3]])]),_:1})]),_:1})}}}),dn=De(an,[["__scopeId","data-v-604fdd95"]]);export{dn as default};
